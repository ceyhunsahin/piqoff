"use strict";(self.webpackChunkwww=self.webpackChunkwww||[]).push([[4991],{55585:(t,e,n)=>{n.d(e,{ZP:()=>p});var i=n(15671),r=n(43144),a=n(97326),s=n(60136),o=n(82963),l=n(61120),c=n(67294),u=n(60250),d=n.n(u);var p=function(t){(0,s.Z)(p,t);var e,n,u=(e=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=(0,l.Z)(e);if(n){var r=(0,l.Z)(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return(0,o.Z)(this,t)});function p(t){var e;return(0,i.Z)(this,p),(e=u.call(this,t)).state.value=void 0!==t.value&&t.value,e._onValueChanged=e._onValueChanged.bind((0,a.Z)(e)),e}return(0,r.Z)(p,[{key:"_onValueChanged",value:function(t){this.value=t.value,void 0!==this.props.onValueChanged&&this.props.onValueChanged(t)}},{key:"value",get:function(){return this.state.value},set:function(t){var e=this;if(void 0!==t){if(void 0!==this.props.dt&&void 0!==this.props.dt.data&&this.props.dt.data.length>0&&void 0!==this.props.dt.field)if(void 0===this.props.dt.filter)void 0!==this.props.dt.row&&void 0!==this.props.dt.data.find((function(t){return t===e.props.dt.row}))?this.props.dt.data.find((function(t){return t===e.props.dt.row}))[this.props.dt.field]=t:this.props.dt.data[this.props.dt.data.length-1][this.props.dt.field]=t;else{var n=this.props.dt.data.where(this.props.dt.filter);n.length>0&&(void 0!==this.props.dt.row&&void 0!==n.find((function(t){return t===e.props.dt.row}))?n.find((function(t){return t===e.props.dt.row}))[this.props.dt.field]=t:n[n.length-1][this.props.dt.field]=t)}this.setState({value:t})}}},{key:"render",value:function(){return c.createElement(d(),{id:this.props.id,defaultValue:this.props.defaultValue,value:this.state.value,text:this.props.text,onValueChanged:this._onValueChanged},this.props.children,this.validationView())}}]),p}(n(20819).ZP)},90428:(t,e,n)=>{n.d(e,{ZP:()=>m});var i=n(15671),r=n(43144),a=n(97326),s=n(60136),o=n(82963),l=n(61120),c=n(67294),u=n(14140),d=n.n(u),p=n(20819),h=n(30381),E=n.n(h);var m=function(t){(0,s.Z)(p,t);var e,n,u=(e=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=(0,l.Z)(e);if(n){var r=(0,l.Z)(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return(0,o.Z)(this,t)});function p(t){var e;return(0,i.Z)(this,p),(e=u.call(this,t)).state.value=void 0===t.param?new Date(0):new Date(t.param.getValue().toString()),e.state.title=void 0===t.title?"":t.title,e.state.titleAlign=void 0===t.titleAlign?"left":t.titleAlign,e.state.showClearButton=void 0!==t.showClearButton&&t.showClearButton,e.state.pickerType=void 0===t.pickerType?"calendar":t.pickerType,e.state.type=void 0===t.type?"date":t.type,e.state.editorOptions=void 0===t.editorOptions?void 0:t.editorOptions,e._onValueChanged=e._onValueChanged.bind((0,a.Z)(e)),e._onEnterKey=e._onEnterKey.bind((0,a.Z)(e)),e}return(0,r.Z)(p,[{key:"_onValueChanged",value:function(t){this.value=t.value,void 0!==this.props.onValueChanged&&this.props.onValueChanged()}},{key:"_onEnterKey",value:function(){void 0!==this.props.onEnterKey&&this.props.onEnterKey()}},{key:"_dateView",value:function(){return c.createElement(d(),{id:this.props.id,showClearButton:this.state.showClearButton,pickerType:this.state.pickerType,height:"fit-content",valueChangeEvent:"keyup",value:"1970-01-01"==E()(this.state.value).format("YYYY-MM-DD")?null:E()(this.state.value),disabled:this.state.editable,type:this.state.type,dateSerializationFormat:"yyyy-MM-dd HH:mm",editorOptions:this.state.editorOptions,onEnterKey:this._onEnterKey,onValueChanged:this._onValueChanged},this.props.children,this.validationView())}},{key:"value",get:function(){return null==this.state.value?new Date(0):this.state.value},set:function(t){var e=this;if(void 0!==t&&null!=t||(t="1970-01-01"),void 0!==this.props.dt&&void 0!==this.props.dt.data&&this.props.dt.data.length>0&&void 0!==this.props.dt.field)if(void 0===this.props.dt.filter)void 0!==this.props.dt.row&&void 0!==this.props.dt.data.find((function(t){return t===e.props.dt.row}))?this.props.dt.data.find((function(t){return t===e.props.dt.row}))[this.props.dt.field]=t:this.props.dt.data[this.props.dt.data.length-1][this.props.dt.field]=t;else{var n=this.props.dt.data.where(this.props.dt.filter);n.length>0&&(void 0!==this.props.dt.row&&void 0!==n.find((function(t){return t===e.props.dt.row}))?n.find((function(t){return t===e.props.dt.row}))[this.props.dt.field]=t:n[n.length-1][this.props.dt.field]=t)}this.setState({value:t})}},{key:"render",value:function(){return 0==this.state.visible?c.createElement("div",null):void 0!==this.props.simple&&this.props.simple?this._dateView():void 0===this.state.title?c.createElement("div",{className:"dx-field"},this._dateView()):void 0===this.state.titleAlign?c.createElement("div",{className:"dx-field"},c.createElement("div",{className:"dx-field-label",style:{textAlign:"right"}},this.state.title),this._dateView()):"top"==this.state.titleAlign?c.createElement("div",{className:"dx-field"},c.createElement("div",null,this.state.title),this._dateView()):"bottom"==this.state.titleAlign?c.createElement("div",{className:"dx-field"},this._dateView(),c.createElement("div",null,this.state.option.title)):"left"==this.state.titleAlign?c.createElement("div",{className:"dx-field"},c.createElement("div",{className:"dx-field-label",style:{textAlign:"right"}},this.state.title),this._dateView()):"right"==this.state.titleAlign?c.createElement("div",{className:"dx-field"},this._dateView(),c.createElement("div",{className:"dx-field-label",style:{float:"right",paddingLeft:"15px"}},this.state.title)):void 0}}]),p}(p.ZP)},71518:(t,e,n)=>{n.d(e,{Z:()=>I});var i=n(15861),r=n(15671),a=n(43144),s=n(97326),o=n(60136),l=n(82963),c=n(61120),u=n(64687),d=n.n(u),p=n(67294),h=n(20819),E=n(33522),m=n.n(E);var I=function(t){(0,o.Z)(E,t);var e,n,u,h=(n=E,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=(0,c.Z)(n);if(u){var i=(0,c.Z)(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return(0,l.Z)(this,t)});function E(t){var e;return(0,r.Z)(this,E),(e=h.call(this,t)).state.value=void 0===t.value?[]:t.value,e._onOptionChanged=e._onOptionChanged.bind((0,s.Z)(e)),e._onItemDeleting=e._onItemDeleting.bind((0,s.Z)(e)),e._onItemDeleted=e._onItemDeleted.bind((0,s.Z)(e)),e}return(0,a.Z)(E,[{key:"_onOptionChanged",value:function(t){"selectedItemKeys"==t.name&&(this.value=t.value),void 0!==this.props.onOptionChanged&&this.props.onOptionChanged(t)}},{key:"_onItemDeleting",value:function(t){void 0!==this.props.onItemDeleting&&this.props.onItemDeleting(t)}},{key:"_onItemDeleted",value:function(t){void 0!==this.props.onItemDeleted&&this.props.onItemDeleted(t)}},{key:"componentDidMount",value:(e=(0,i.Z)(d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===this.state.data){t.next=3;break}return t.next=3,this.dataRefresh(this.state.data);case 3:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"value",get:function(){return this.state.value},set:function(t){this.setState({value:t})}},{key:"render",value:function(){return p.createElement(m(),{dataSource:void 0===this.state.data?void 0:this.state.data.store,allowItemDeleting:this.props.allowItemDeleting,itemDeleteMode:this.props.itemDeleteMode,itemRender:this.props.itemRender,collapsibleGroups:this.props.collapsibleGroups,grouped:this.props.grouped,groupRender:this.props.groupRender,groupTemplate:this.props.groupTemplate,width:this.props.width,height:this.props.height,displayExpr:this.props.displayExpr,keyExpr:this.props.keyExpr,showSelectionControls:this.props.showSelectionControls,selectionMode:this.props.selectionMode,selectAllMode:this.props.selectAllMode,selectedItemKeys:this.state.value,onOptionChanged:this._onOptionChanged,onItemDeleting:this._onItemDeleting,onItemDeleted:this._onItemDeleted})}}]),E}(h.ZP)},5083:(t,e,n)=>{n.d(e,{ZP:()=>p});var i=n(15671),r=n(43144),a=n(97326),s=n(60136),o=n(82963),l=n(61120),c=n(67294),u=n(67497),d=n(20819);n(17276);var p=function(t){(0,s.Z)(p,t);var e,n,d=(e=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=(0,l.Z)(e);if(n){var r=(0,l.Z)(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return(0,o.Z)(this,t)});function p(t){var e;return(0,i.Z)(this,p),(e=d.call(this,t)).dev=null,e.state.value=void 0!==t.value?t.value:0,e.state.title=void 0===t.title?"":t.title,e.state.titleAlign=void 0===t.titleAlign?"left":t.titleAlign,e.state.showClearButton=void 0!==t.showClearButton&&t.showClearButton,e.state.readOnly=void 0!==t.readOnly&&t.readOnly,e._onInitialized=e._onInitialized.bind((0,a.Z)(e)),e._onValueChanged=e._onValueChanged.bind((0,a.Z)(e)),e._onEnterKey=e._onEnterKey.bind((0,a.Z)(e)),e._onFocusIn=e._onFocusIn.bind((0,a.Z)(e)),e._onFocusOut=e._onFocusOut.bind((0,a.Z)(e)),e._onChange=e._onChange.bind((0,a.Z)(e)),e}return(0,r.Z)(p,[{key:"_onInitialized",value:function(t){this.dev=t.component}},{key:"_onValueChanged",value:function(t){this.value=t.value,void 0!==this.props.onValueChanged&&this.props.onValueChanged(t)}},{key:"_onEnterKey",value:function(){void 0!==this.props.onEnterKey&&this.props.onEnterKey()}},{key:"_onFocusIn",value:function(t){void 0!==this.props.selectAll&&1!=this.props.selectAll||this.dev.element().getElementsByTagName("input")[1].select(),void 0!==this.props.onFocusIn&&this.props.onFocusIn(t)}},{key:"_onFocusOut",value:function(){void 0!==this.props.onFocusOut&&this.props.onFocusOut()}},{key:"_onChange",value:function(){void 0!==this.props.onChange&&this.props.onChange()}},{key:"_txtView",value:function(){return c.createElement(u.NumberBox,{showClearButton:this.state.showClearButton,height:"fit-content",elementAttr:this.props.elementAttr,style:this.props.style,valueChangeEvent:"keyup",onValueChanged:this._onValueChanged,onEnterKey:this._onEnterKey,onFocusIn:this._onFocusIn,onFocusOut:this._onFocusOut,onChange:this._onChange,value:this.state.value,readOnly:this.state.readOnly,onInitialized:this._onInitialized,disabled:void 0===this.props.editable?this.state.editable:this.props.editable,showSpinButtons:this.props.showSpinButtons,step:this.props.step,format:this.props.format},this.props.children,this.validationView())}},{key:"value",get:function(){return this.state.value},set:function(t){var e=this;if(void 0!==t){if(void 0!==this.props.dt&&void 0!==this.props.dt.data&&this.props.dt.data.length>0&&void 0!==this.props.dt.field)if(void 0===this.props.dt.filter)void 0!==this.props.dt.row&&void 0!==this.props.dt.data.find((function(t){return t===e.props.dt.row}))?this.props.dt.data.find((function(t){return t===e.props.dt.row}))[this.props.dt.field]=t:this.props.dt.data[this.props.dt.data.length-1][this.props.dt.field]=t;else{var n=this.props.dt.data.where(this.props.dt.filter);n.length>0&&(void 0!==this.props.dt.row&&void 0!==n.find((function(t){return t===e.props.dt.row}))?n.find((function(t){return t===e.props.dt.row}))[this.props.dt.field]=t:n[n.length-1][this.props.dt.field]=t)}this.setState({value:t})}}},{key:"readOnly",get:function(){return this.state.readOnly},set:function(t){this.setState({readOnly:t})}},{key:"focus",value:function(){this.dev.focus()}},{key:"render",value:function(){return 0==this.state.visible?c.createElement("div",null):void 0!==this.props.simple&&this.props.simple?this._txtView():""==this.state.title?c.createElement("div",{className:"dx-field"},this._txtView()):void 0===this.state.titleAlign?c.createElement("div",{className:"dx-field"},c.createElement("div",{className:"dx-field-label",style:{textAlign:"right"}},this.state.title),this._txtView()):"top"==this.state.titleAlign?c.createElement("div",{className:"dx-field"},c.createElement("div",null,this.state.title),this._txtView()):"bottom"==this.state.titleAlign?c.createElement("div",{className:"dx-field"},this._txtView(),c.createElement("div",null,this.state.option.title)):"left"==this.state.titleAlign?c.createElement("div",{className:"dx-field"},c.createElement("div",{className:"dx-field-label",style:{textAlign:"right"}},this.state.title),this._txtView()):"right"==this.state.titleAlign?c.createElement("div",{className:"dx-field"},this._txtView(),c.createElement("div",{className:"dx-field-label",style:{float:"right",paddingLeft:"15px"}},this.state.title)):void 0}}]),p}(d.ZP)},54991:(t,e,n)=>{n.r(e),n.d(e,{default:()=>G});var i=n(4942),r=n(15861),a=n(15671),s=n(43144),o=n(60136),l=n(82963),c=n(61120),u=n(64687),d=n.n(u),p=n(67294),h=n(73364),E=n(17276),m=n(30381),I=n.n(m);function T(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?T(Object(n),!0).forEach((function(e){(0,i.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f=function(){function t(){(0,a.Z)(this,t),this.core=E.vE.instance,this.ds=new E.gx,this.empty={GUID:"00000000-0000-0000-0000-000000000000",CDATE:I()(new Date).format("YYYY-MM-DD"),CUSER:this.core.auth.data.CODE,CUSER_NAME:"",LDATE:I()(new Date).format("YYYY-MM-DD"),LUSER:this.core.auth.data.CODE,LUSER_NAME:"",CODE:"",NAME:"",START_DATE:I()(new Date).format("YYYY-MM-DD"),FINISH_DATE:I()(new Date).format("YYYY-MM-DD"),CUSTOMER_GUID:"00000000-0000-0000-0000-000000000000",CUSTOMER_CODE:"",CUSTOMER_NAME:"",DEPOT_GUID:"00000000-0000-0000-0000-000000000000",DEPOT_CODE:"",DEPOT_NAME:"",STATUS:1},this.cond=new D,this.app=new O,this._initDs()}var e;return(0,s.Z)(t,[{key:"_initDs",value:function(){var t=new E.$A("PROMO");t.selectCmd={query:"SELECT * FROM [dbo].[PROMO_VW_01] WHERE ((GUID = @GUID) OR (@GUID = '00000000-0000-0000-0000-000000000000')) AND ((CODE = @CODE) OR (@CODE = '')) AND ((CUSTOMER_GUID = @CUSTOMER_GUID) OR (CUSTOMER_GUID = '00000000-0000-0000-0000-000000000000') OR (@CUSTOMER_GUID = '00000000-0000-0000-0000-000000000000')) AND ((DEPOT_GUID = @DEPOT_GUID) OR (@DEPOT_GUID = '00000000-0000-0000-0000-000000000000')) AND ((START_DATE <= @START_DATE) OR (@START_DATE = '19700101')) AND ((FINISH_DATE >= @FINISH_DATE) OR (@FINISH_DATE = '19700101')) AND STATUS = 1 ORDER BY TYPE ASC",param:["GUID:string|50","CODE:string|25","START_DATE:date","FINISH_DATE:date","CUSTOMER_GUID:string|50","DEPOT_GUID:string|50"]},t.insertCmd={query:"EXEC [dbo].[PRD_PROMO_INSERT] @GUID = @PGUID, @CUSER = @PCUSER, @CODE = @PCODE, @NAME = @PNAME, @START_DATE = @PSTART_DATE, @FINISH_DATE = @PFINISH_DATE, @CUSTOMER = @PCUSTOMER, @DEPOT = @PDEPOT, @STATUS = @PSTATUS ",param:["PGUID:string|50","PCUSER:string|25","PCODE:string|25","PNAME:string|250","PSTART_DATE:date","PFINISH_DATE:date","PCUSTOMER:string|50","PDEPOT:string|50","PSTATUS:bit"],dataprm:["GUID","CUSER","CODE","NAME","START_DATE","FINISH_DATE","CUSTOMER_GUID","DEPOT_GUID","STATUS"]},t.updateCmd={query:"EXEC [dbo].[PRD_PROMO_UPDATE] @GUID = @PGUID, @CUSER = @PCUSER, @CODE = @PCODE, @NAME = @PNAME, @START_DATE = @PSTART_DATE, @FINISH_DATE = @PFINISH_DATE, @CUSTOMER = @PCUSTOMER, @DEPOT = @PDEPOT, @STATUS = @PSTATUS ",param:["PGUID:string|50","PCUSER:string|25","PCODE:string|25","PNAME:string|250","PSTART_DATE:date","PFINISH_DATE:date","PCUSTOMER:string|50","PDEPOT:string|50","PSTATUS:bit"],dataprm:["GUID","CUSER","CODE","NAME","START_DATE","FINISH_DATE","CUSTOMER_GUID","DEPOT_GUID","STATUS"]},t.deleteCmd={query:"EXEC [dbo].[PRD_PROMO_DELETE] @CUSER = @PCUSER, @UPDATE = 1, @GUID = @PGUID, @CODE = @PCODE ",param:["PCUSER:string|25","PGUID:string|50","PCODE:string|25"],dataprm:["CUSER","GUID","CODE"]},this.ds.add(t),this.ds.add(this.cond.dt()),this.ds.add(this.app.dt())}},{key:"dt",value:function(){return arguments.length>0?this.ds.get(arguments[0]):this.ds.get(0)}},{key:"addEmpty",value:(e=(0,r.Z)(d().mark((function t(){var e,n=arguments;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.core.util.waitUntil(0);case 2:if(void 0!==this.dt("PROMO")){t.next=4;break}return t.abrupt("return");case 4:e={},(e=n.length>0?A({},n[0]):A({},this.empty)).GUID=E.$A.uuidv4(),this.dt("PROMO").push(e);case 8:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"clearAll",value:function(){for(var t=0;t<this.ds.length;t++)this.dt(t).clear()}},{key:"load",value:function(){var t=arguments,e=this;return new Promise(function(){var n=(0,r.Z)(d().mark((function n(i){var r,a,s;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={GUID:"00000000-0000-0000-0000-000000000000",CODE:"",START_DATE:"19700101",FINISH_DATE:"19700101",CUSTOMER_GUID:"00000000-0000-0000-0000-000000000000",DEPOT_GUID:"00000000-0000-0000-0000-000000000000"},t.length>0&&(r.GUID=void 0===t[0].GUID?"00000000-0000-0000-0000-000000000000":t[0].GUID,r.CODE=void 0===t[0].CODE?"":t[0].CODE,r.START_DATE=void 0===t[0].START_DATE?"19700101":t[0].START_DATE,r.FINISH_DATE=void 0===t[0].FINISH_DATE?"19700101":t[0].FINISH_DATE,r.CUSTOMER_GUID=void 0===t[0].CUSTOMER_GUID?"00000000-0000-0000-0000-000000000000":t[0].CUSTOMER_GUID,r.DEPOT_GUID=void 0===t[0].DEPOT_GUID?"00000000-0000-0000-0000-000000000000":t[0].DEPOT_GUID),e.ds.get("PROMO").selectCmd.value=Object.values(r),n.next=5,e.ds.get("PROMO").refresh();case 5:for(a="",s=0;s<e.ds.get("PROMO").length;s++)a=a+e.ds.get("PROMO")[s].GUID+",";return n.next=9,e.cond.load({PROMO:a.substring(0,a.length-1)});case 9:return n.next=11,e.app.load({PROMO:a.substring(0,a.length-1)});case 11:i(e.ds.get("PROMO"));case 12:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())}},{key:"save",value:function(){var t=this;return new Promise(function(){var e=(0,r.Z)(d().mark((function e(n){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.ds.delete(),e.t0=n,e.next=4,t.ds.update();case 4:e.t1=e.sent,(0,e.t0)(e.t1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}]),t}(),D=function(){function t(){(0,a.Z)(this,t),this.core=E.vE.instance,this.ds=new E.gx,this.empty={GUID:"00000000-0000-0000-0000-000000000000",PROMO:"00000000-0000-0000-0000-000000000000",TYPE:0,TYPE_NAME:"",ITEM_GUID:"00000000-0000-0000-0000-000000000000",ITEM_CODE:"",ITEM_NAME:"",QUANTITY:0,AMOUNT:0,WITHAL:0,SECTOR:"COND"},this._initDs()}var e;return(0,s.Z)(t,[{key:"_initDs",value:function(){var t=new E.$A("PROMO_CONDITION");t.selectCmd={query:"SELECT *,'COND' AS SECTOR FROM [dbo].[PROMO_CONDITION_VW_01] WHERE ((GUID = @GUID) OR (@GUID = '00000000-0000-0000-0000-000000000000')) AND ((PROMO IN (SELECT value FROM STRING_SPLIT(@PROMO,','))) OR (@PROMO = '')) ORDER BY WITHAL ASC",param:["GUID:string|50","PROMO:string|max"]},t.insertCmd={query:"EXEC [dbo].[PRD_PROMO_CONDITION_INSERT] @GUID = @PGUID, @CUSER = @PCUSER, @PROMO = @PPROMO, @TYPE = @PTYPE, @ITEM_CODE = @PITEM_CODE, @QUANTITY = @PQUANTITY, @AMOUNT = @PAMOUNT, @WITHAL = @PWITHAL ",param:["PGUID:string|50","PCUSER:string|25","PPROMO:string|50","PTYPE:int","PITEM_CODE:string|25","PQUANTITY:float","PAMOUNT:float","PWITHAL:int"],dataprm:["GUID","CUSER","PROMO","TYPE","ITEM_CODE","QUANTITY","AMOUNT","WITHAL"]},t.updateCmd={query:"EXEC [dbo].[PRD_PROMO_CONDITION_UPDATE] @GUID = @PGUID, @CUSER = @PCUSER, @PROMO = @PPROMO, @TYPE = @PTYPE, @ITEM_CODE = @PITEM_CODE, @QUANTITY = @PQUANTITY, @AMOUNT = @PAMOUNT, @WITHAL = @PWITHAL ",param:["PGUID:string|50","PCUSER:string|25","PPROMO:string|50","PTYPE:int","PITEM_CODE:string|25","PQUANTITY:float","PAMOUNT:float","PWITHAL:int"],dataprm:["GUID","CUSER","PROMO","TYPE","ITEM_CODE","QUANTITY","AMOUNT","WITHAL"]},t.deleteCmd={query:"EXEC [dbo].[PRD_PROMO_CONDITION_DELETE] @CUSER = @PCUSER, @UPDATE = 0, @PROMO = @PPROMO, @GUID = @PGUID ",param:["PCUSER:string|25","PPROMO:string|50","PGUID:string|50"],dataprm:["CUSER","PROMO","GUID"]},this.ds.add(t)}},{key:"dt",value:function(){return arguments.length>0?this.ds.get(arguments[0]):this.ds.get(0)}},{key:"addEmpty",value:(e=(0,r.Z)(d().mark((function t(){var e,n=arguments;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.core.util.waitUntil(0);case 2:if(void 0!==this.dt("PROMO_CONDITION")){t.next=4;break}return t.abrupt("return");case 4:e={},(e=n.length>0?A({},n[0]):A({},this.empty)).GUID=E.$A.uuidv4(),this.dt("PROMO_CONDITION").push(e);case 8:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"clearAll",value:function(){for(var t=0;t<this.ds.length;t++)this.dt(t).clear()}},{key:"load",value:function(){var t=arguments,e=this;return new Promise(function(){var n=(0,r.Z)(d().mark((function n(i){var r;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={GUID:"00000000-0000-0000-0000-000000000000",PROMO:"00000000-0000-0000-0000-000000000000"},t.length>0&&(r.GUID=void 0===t[0].GUID?"00000000-0000-0000-0000-000000000000":t[0].GUID,r.PROMO=void 0===t[0].PROMO?"":t[0].PROMO),e.ds.get("PROMO_CONDITION").selectCmd.value=Object.values(r),n.next=5,e.ds.get("PROMO_CONDITION").refresh();case 5:i(e.ds.get("PROMO_CONDITION"));case 6:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())}},{key:"save",value:function(){var t=this;return new Promise(function(){var e=(0,r.Z)(d().mark((function e(n){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.ds.delete(),e.t0=n,e.next=4,t.ds.update();case 4:e.t1=e.sent,(0,e.t0)(e.t1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}]),t}(),O=function(){function t(){(0,a.Z)(this,t),this.core=E.vE.instance,this.ds=new E.gx,this.empty={GUID:"00000000-0000-0000-0000-000000000000",PROMO:"00000000-0000-0000-0000-000000000000",TYPE:0,TYPE_NAME:"",ITEM_GUID:"00000000-0000-0000-0000-000000000000",ITEM_CODE:"",ITEM_NAME:"",QUANTITY:0,AMOUNT:0,WITHAL:0,SECTOR:"APP"},this._initDs()}var e;return(0,s.Z)(t,[{key:"_initDs",value:function(){var t=new E.$A("PROMO_APPLICATION");t.selectCmd={query:"SELECT *,'APP' AS SECTOR FROM [dbo].[PROMO_APPLICATION_VW_01] WHERE ((GUID = @GUID) OR (@GUID = '00000000-0000-0000-0000-000000000000')) AND ((PROMO IN (SELECT value FROM STRING_SPLIT(@PROMO,','))) OR (@PROMO = '')) ORDER BY WITHAL ASC",param:["GUID:string|50","PROMO:string|max"]},t.insertCmd={query:"EXEC [dbo].[PRD_PROMO_APPLICATION_INSERT] @GUID = @PGUID, @CUSER = @PCUSER, @PROMO = @PPROMO, @TYPE = @PTYPE, @ITEM_CODE = @PITEM_CODE, @QUANTITY = @PQUANTITY, @AMOUNT = @PAMOUNT, @WITHAL = @PWITHAL ",param:["PGUID:string|50","PCUSER:string|25","PPROMO:string|50","PTYPE:int","PITEM_CODE:string|25","PQUANTITY:float","PAMOUNT:float","PWITHAL:int"],dataprm:["GUID","CUSER","PROMO","TYPE","ITEM_CODE","QUANTITY","AMOUNT","WITHAL"]},t.updateCmd={query:"EXEC [dbo].[PRD_PROMO_APPLICATION_UPDATE] @GUID = @PGUID, @CUSER = @PCUSER, @PROMO = @PPROMO, @TYPE = @PTYPE, @ITEM_CODE = @PITEM_CODE, @QUANTITY = @PQUANTITY, @AMOUNT = @PAMOUNT, @WITHAL = @PWITHAL ",param:["PGUID:string|50","PCUSER:string|25","PPROMO:string|50","PTYPE:int","PITEM_CODE:string|25","PQUANTITY:float","PAMOUNT:float","PWITHAL:int"],dataprm:["GUID","CUSER","PROMO","TYPE","ITEM_CODE","QUANTITY","AMOUNT","WITHAL"]},t.deleteCmd={query:"EXEC [dbo].[PRD_PROMO_APPLICATION_DELETE] @CUSER = @PCUSER, @UPDATE = 0, @PROMO = @PPROMO, @GUID = @PGUID ",param:["PCUSER:string|25","PPROMO:string|50","PGUID:string|50"],dataprm:["CUSER","PROMO","GUID"]},this.ds.add(t)}},{key:"dt",value:function(){return arguments.length>0?this.ds.get(arguments[0]):this.ds.get(0)}},{key:"addEmpty",value:(e=(0,r.Z)(d().mark((function t(){var e,n=arguments;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.core.util.waitUntil(0);case 2:if(void 0!==this.dt("PROMO_APPLICATION")){t.next=4;break}return t.abrupt("return");case 4:e={},(e=n.length>0?A({},n[0]):A({},this.empty)).GUID=E.$A.uuidv4(),this.dt("PROMO_APPLICATION").push(e);case 8:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"clearAll",value:function(){for(var t=0;t<this.ds.length;t++)this.dt(t).clear()}},{key:"load",value:function(){var t=arguments,e=this;return new Promise(function(){var n=(0,r.Z)(d().mark((function n(i){var r;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={GUID:"00000000-0000-0000-0000-000000000000",PROMO:"00000000-0000-0000-0000-000000000000"},t.length>0&&(r.GUID=void 0===t[0].GUID?"00000000-0000-0000-0000-000000000000":t[0].GUID,r.PROMO=void 0===t[0].PROMO?"":t[0].PROMO),e.ds.get("PROMO_APPLICATION").selectCmd.value=Object.values(r),n.next=5,e.ds.get("PROMO_APPLICATION").refresh();case 5:i(e.ds.get("PROMO_APPLICATION"));case 6:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())}},{key:"save",value:function(){var t=this;return new Promise(function(){var e=(0,r.Z)(d().mark((function e(n){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.ds.delete(),e.t0=n,e.next=4,t.ds.update();case 4:e.t1=e.sent,(0,e.t0)(e.t1);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}]),t}(),P=n(42866),v=n.n(P),g=n(53221),C=n.n(g),M=n(25552),R=n.n(M),_=(n(30886),n(99846)),U=(n(5083),n(99077)),y=(n(55585),n(417)),N=n(32175),x=n(18405),w=n(73682),L=n(90428),S=n(60547),b=n(71518);function H(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function W(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?H(Object(n),!0).forEach((function(e){(0,i.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var G=function(t){(0,o.Z)(O,t);var e,n,u,m,I,T,A,D=(T=O,A=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=(0,c.Z)(T);if(A){var n=(0,c.Z)(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return(0,l.Z)(this,t)});function O(t){var e;return(0,a.Z)(this,O),(e=D.call(this,t)).state={discPrice:0},e.core=h.Z.instance.core,e.prmObj=e.param.filter({TYPE:1,USERS:e.user.CODE}),e.promo=new f,e.condDt=new E.$A,e.appDt=new E.$A,e.tabIndex=t.data.tabkey,Number.money=e.sysParam.filter({ID:"MoneySymbol",TYPE:0}).getValue(),e}return(0,s.Z)(O,[{key:"componentDidMount",value:(I=(0,r.Z)(d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.core.util.waitUntil(0);case 2:if(this.init(),void 0===this.pagePrm){t.next=7;break}return console.log(this.pagePrm.CODE),t.next=7,this.getPromotion(this.pagePrm.CODE);case 7:case"end":return t.stop()}}),t,this)}))),function(){return I.apply(this,arguments)})},{key:"init",value:(m=(0,r.Z)(d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.clearItemList(),this.condDt.clear(),this.appDt.clear(),this.promo.clearAll(),this.promo.addEmpty(),this.condDt.push(W({},this.promo.cond.empty)),this.appDt.push(W({},this.promo.app.empty)),t.next=9,this.lstPromo.dataRefresh({source:[{id:0,text:"Koşul",items:this.condDt},{id:1,text:"Uygulama",items:this.appDt}]});case 9:this.promo.ds.on("onRefresh",function(){var t=(0,r.Z)(d().mark((function t(e){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 10:case"end":return t.stop()}}),t,this)}))),function(){return m.apply(this,arguments)})},{key:"getPromotion",value:(u=(0,r.Z)(d().mark((function t(e){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.clearItemList(),this.condDt.clear(),this.appDt.clear(),this.promo.clearAll(),t.next=6,this.promo.load({CODE:e});case 6:return 0==this.promo.cond.dt().length&&this.promo.cond.addEmpty(),0==this.promo.app.dt().length&&this.promo.app.addEmpty(),this.condDt.import(this.promo.cond.dt().groupBy("WITHAL").toArray()),this.appDt.import(this.promo.app.dt().groupBy("WITHAL").toArray()),this.setState({discPrice:0}),t.next=13,this.core.util.waitUntil(0);case 13:return t.next=15,this.lstPromo.dataRefresh();case 15:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"clearItemList",value:function(){for(var t=0;t<100;t++)delete this["itemList"+t]}},{key:"checkPromotion",value:(n=(0,r.Z)(d().mark((function t(e){var n=this;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=(0,r.Z)(d().mark((function t(i){var r;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""===e){t.next=15;break}return t.next=3,(new f).load({CODE:e});case 3:if(!(t.sent.length>0)){t.next=12;break}return r={id:"msgRef",showTitle:!0,title:n.t("msgRef.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgRef.btn01"),location:"before"},{id:"btn02",caption:n.t("msgRef.btn02"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgRef.msg"))},t.next=8,(0,S.W)(r);case 8:"btn01"==t.sent?(n.getPromotion(e),i(2)):i(3),t.next=13;break;case 12:i(1);case 13:t.next=16;break;case 15:i(0);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)}))),function(t){return n.apply(this,arguments)})},{key:"getPrice",value:(e=(0,r.Z)(d().mark((function t(e){var n=this;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=(0,r.Z)(d().mark((function t(i){var r,a;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"00000000-0000-0000-0000-000000000000"==e&&i(0),r={query:"SELECT dbo.FN_PRICE_SALE(@GUID,1,GETDATE(),@CUSTOMER) AS PRICE",param:["GUID:string|50","CUSTOMER:string|50"],value:[e,n.promo.dt()[0].CUSTOMER_GUID]},t.next=4,n.core.sql.execute(r);case 4:(a=t.sent).result.recordset.length>0&&i(a.result.recordset[0].PRICE),i(0);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})},{key:"groupTemplate",value:function(t){var e=this;return p.createElement("div",{className:"row"},p.createElement("div",{className:"col-6"},t.text),p.createElement("div",{className:"col-6"},p.createElement(C(),{style:{backgroundColor:"#f1f4f5"}},p.createElement(M.Item,{location:"after",locateInMenu:"auto"},p.createElement(w.Z,{id:"btnPlus",parent:this,icon:"plus",type:"default",onClick:(0,r.Z)(d().mark((function n(){var i,r;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return 0==t.id&&((i=W({},e.promo.cond.empty)).GUID=E.$A.uuidv4(),i.WITHAL=e.condDt.max("WITHAL")+1,e.condDt.push(i)),1==t.id&&((r=W({},e.promo.app.empty)).GUID=E.$A.uuidv4(),r.WITHAL=e.appDt.max("WITHAL")+1,e.appDt.push(r)),n.next=4,e.core.util.waitUntil(0);case 4:return n.next=6,e.lstPromo.dataRefresh();case 6:case"end":return n.stop()}}),n)})))})))))}},{key:"itemTemplate",value:function(t){var e,n,a=this;return"COND"==t.SECTOR?(void 0!==this["itemList"+t.WITHAL]&&0!=this["itemList"+t.WITHAL].length||(this["itemList"+t.WITHAL]=this.promo.cond.dt().where({WITHAL:t.WITHAL}),this["itemList"+t.WITHAL].forEach(function(){var t=(0,r.Z)(d().mark((function t(e){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.getPrice(e.ITEM_GUID);case 2:e.PRICE=t.sent;case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),this.state["prmType"+t.WITHAL]=t.TYPE,p.createElement("div",{className:"row"},p.createElement("div",{className:"col-12"},p.createElement(R(),{colCount:3,id:"frmCond"+this.tabIndex},p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("cmbPrmType"),alignment:"right"}),p.createElement(U.ZP,{simple:!0,parent:this,id:"cmbPrmType"+t.WITHAL,displayExpr:"NAME",valueExpr:"ID",value:t.TYPE,data:{source:[{ID:0,NAME:this.t("cmbType.item")},{ID:1,NAME:this.t("cmbType.generalAmount")}]},onValueChanged:function(e){0==e.previousValue&&a.promo.cond.dt().where({WITHAL:t.WITHAL}).length>1&&a.promo.cond.dt().where({WITHAL:t.WITHAL}).forEach((function(t){a.promo.cond.dt().removeAt(t)})),a.condDt.where({WITHAL:t.WITHAL}).length>0&&(a.condDt.where({WITHAL:t.WITHAL})[0].TYPE=e.value),a.setState((0,i.Z)({},"prmType"+t.WITHAL,e.value))}})),p.createElement(M.EmptyItem,null),p.createElement(M.EmptyItem,null),p.createElement(M.GroupItem,{colSpan:3},p.createElement(M.GroupItem,{colCount:3,visible:0==this.state["prmType"+t.WITHAL]},p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("txtPrmItem"),alignment:"right"}),p.createElement(w.Z,{text:this.t("btnPrmItem"),type:"default",width:"100%",onClick:function(){a["grdPopItemList"+t.WITHAL].dataRefresh({source:a["itemList"+t.WITHAL]}),a["pop_PrmItemList"+t.WITHAL].show()}}),p.createElement(y.Z,{id:"pg_txtPrmItem"+t.WITHAL,parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,width:"90%",height:"90%",title:this.t("pg_Grid.title"),search:!0,data:{source:{select:{query:"SELECT MAX(ITEM_GUID) AS GUID,MAX(BARCODE) AS BARCODE,ITEM_CODE AS CODE,ITEM_NAME AS NAME,MAIN_GRP_NAME AS MAIN_GRP_NAME, ISNULL((SELECT dbo.FN_PRICE_SALE(ITEM_GUID,1,GETDATE(),'00000000-0000-0000-0000-000000000000')),0) AS PRICE FROM ITEM_BARCODE_VW_01 WHERE (UPPER(ITEM_CODE) LIKE UPPER(@VAL) OR UPPER(ITEM_NAME) LIKE UPPER(@VAL) OR BARCODE LIKE @VAL) AND STATUS = 1 GROUP BY ITEM_CODE,ITEM_NAME,MAIN_GRP_NAME,ITEM_GUID",param:["VAL:string|50"]},sql:this.core.sql}}},p.createElement(x.sg,{dataField:"BARCODE",caption:this.t("pg_Grid.clmBarcode"),width:150}),p.createElement(x.sg,{dataField:"CODE",caption:this.t("pg_Grid.clmCode"),width:150}),p.createElement(x.sg,{dataField:"NAME",caption:this.t("pg_Grid.clmName"),width:650,defaultSortOrder:"asc"}),p.createElement(x.sg,{dataField:"MAIN_GRP_NAME",caption:this.t("pg_Grid.clmGrpName"),width:150}),p.createElement(x.sg,{dataField:"PRICE",caption:this.t("pg_Grid.clmPrice"),width:100})),p.createElement(N.ZP,{parent:this,id:"pop_PrmItemList"+t.WITHAL,container:"#root",position:{of:"#root"},showCloseButton:!0,showTitle:!0,title:this.t("pg_Grid.title"),width:"70%",height:"90%"},p.createElement("div",{className:"row pb-1"},p.createElement("div",{className:"col-12"},p.createElement(w.Z,{text:this.t("btnPrmItem"),type:"default",width:"100%",onClick:function(){a["pg_txtPrmItem"+t.WITHAL]["txtpg_txtPrmItem"+t.WITHAL].value="",a["pg_txtPrmItem"+t.WITHAL].show(),a["pg_txtPrmItem"+t.WITHAL].onClick=function(){var e=(0,r.Z)(d().mark((function e(n){var i,r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a.promo.cond.dt().where({WITHAL:t.WITHAL}).forEach((function(t){a.promo.cond.dt().removeAt(t)})),i=0;i<n.length;i++)(r=W({},a.promo.cond.empty)).GUID=E.$A.uuidv4(),r.ITEM_GUID=n[i].GUID,r.ITEM_CODE=n[i].CODE,r.ITEM_NAME=n[i].NAME,r.PRICE=n[i].PRICE,r.PROMO=a.promo.dt()[0].GUID,r.QUANTITY=1,r.AMOUNT=0,r.WITHAL=t.WITHAL,a["itemList"+t.WITHAL].push(r);n.length>0&&a.condDt.where({WITHAL:t.WITHAL}).length>0&&(a.condDt.where({WITHAL:t.WITHAL})[0].ITEM_GUID=n[0].GUID,a.condDt.where({WITHAL:t.WITHAL})[0].ITEM_CODE=n[0].CODE,a.condDt.where({WITHAL:t.WITHAL})[0].ITEM_NAME=n[0].NAME);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}))),p.createElement("div",{className:"row"},p.createElement("div",{className:"col-12"},p.createElement(x.ZP,{parent:this,id:"grdPopItemList"+t.WITHAL,showBorders:!0,columnsAutoWidth:!1,allowColumnResizing:!0,allowColumnReordering:!1,height:"100%",width:"100%",dbApply:!1,selection:{mode:"single"},loadPanel:{enabled:!1},sorting:{mode:"none"}},p.createElement(x.LO,{mode:"cell",allowUpdating:!1,allowDeleting:!0}),p.createElement(x.PY,{mode:"standart"}),p.createElement(x.sg,{dataField:"ITEM_CODE",caption:this.t("pg_Grid.clmCode"),width:100}),p.createElement(x.sg,{dataField:"ITEM_NAME",caption:this.t("pg_Grid.clmName"),width:290}),p.createElement(x.sg,{dataField:"PRICE",caption:this.t("pg_Grid.clmPrice"),width:100})))))),p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("txtPrmQuantity"),alignment:"right"}),p.createElement(_.ZP,{id:"txtPrmQuantity"+t.WITHAL,parent:this,simple:!0,value:t.QUANTITY,onValueChanged:function(e){a["txtPrmAmount"+t.WITHAL].value=0,a.condDt.where({WITHAL:t.WITHAL}).length>0&&(a.condDt.where({WITHAL:t.WITHAL})[0].QUANTITY=e.value)}})),p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("txtPrmAmount"),alignment:"right"}),p.createElement(_.ZP,{id:"txtPrmAmount"+t.WITHAL,parent:this,simple:!0,value:t.AMOUNT,onValueChanged:function(e){a["txtPrmQuantity"+t.WITHAL].value=0,a.condDt.where({WITHAL:t.WITHAL}).length>0&&(a.condDt.where({WITHAL:t.WITHAL})[0].AMOUNT=e.value)}}))),p.createElement(M.GroupItem,{colCount:3,visible:1==this.state["prmType"+t.WITHAL]},p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("txtPrmAmount"),alignment:"right"}),p.createElement(_.ZP,{id:"txtPrmAmount"+t.WITHAL,parent:this,simple:!0,value:t.AMOUNT,onValueChanged:function(e){a.condDt.where({WITHAL:t.WITHAL}).length>0&&(a.condDt.where({WITHAL:t.WITHAL})[0].AMOUNT=e.value)}})),p.createElement(M.EmptyItem,null),p.createElement(M.EmptyItem,null))))))):"APP"==t.SECTOR?(this.state["rstType"+t.WITHAL]=t.TYPE,p.createElement("div",{className:"row"},p.createElement("div",{className:"col-12"},p.createElement(R(),{colCount:3,id:"frmApp"+this.tabIndex},p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("cmbRstType"),alignment:"right"}),p.createElement(U.ZP,{simple:!0,parent:this,id:"cmbRstType"+t.WITHAL,displayExpr:"NAME",valueExpr:"ID",value:t.TYPE,data:{source:[{ID:0,NAME:this.t("cmbType.discountRate")},{ID:1,NAME:this.t("cmbType.moneyPoint")},{ID:2,NAME:this.t("cmbType.giftCheck")},{ID:3,NAME:this.t("cmbType.item")},{ID:4,NAME:this.t("cmbType.generalDiscount")},{ID:5,NAME:this.t("cmbType.discountAmount")}]},onValueChanged:function(e){var n;a.appDt.where({WITHAL:t.WITHAL}).length>0&&(a.appDt.where({WITHAL:t.WITHAL})[0].TYPE=e.value),a.setState((n={},(0,i.Z)(n,"rstType"+t.WITHAL,e.value),(0,i.Z)(n,"discPrice",0),n))}})),p.createElement(M.EmptyItem,null),p.createElement(M.EmptyItem,null),p.createElement(M.GroupItem,{colSpan:3},p.createElement(M.GroupItem,{colCount:3,visible:0==this.state["rstType"+t.WITHAL]||5==this.state["rstType"+t.WITHAL]},p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("txtRstQuantity"),alignment:"right"}),p.createElement(_.ZP,{id:"txtRstQuantity"+t.WITHAL,parent:this,simple:!0,readOnly:!0,value:t.AMOUNT,button:[{id:"01",icon:"more",onClick:(n=(0,r.Z)(d().mark((function e(){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.condDt.length>0)){e.next=5;break}return e.next=3,a.getPrice(a.condDt[0].ITEM_GUID);case 3:n=e.sent,a.setState({discPrice:n});case 5:a["txtDiscRate"+t.WITHAL].value=a["txtRstQuantity"+t.WITHAL].value,a["txtDiscAmount"+t.WITHAL].value=Number(a.state.discPrice-Number(a.state.discPrice).rateInc(a["txtRstQuantity"+t.WITHAL].value,2)).toFixed(2),a["popDiscount"+t.WITHAL].show();case 8:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})}]})),p.createElement(M.EmptyItem,null),p.createElement(M.EmptyItem,null)),p.createElement(M.GroupItem,{colCount:3,visible:1==this.state["rstType"+t.WITHAL]||2==this.state["rstType"+t.WITHAL]||4==this.state["rstType"+t.WITHAL]},p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("txtRstQuantity"),alignment:"right"}),p.createElement(_.ZP,{id:"txtRstPointGift"+t.WITHAL,parent:this,simple:!0,value:t.AMOUNT,onValueChanged:function(e){a.appDt.where({WITHAL:t.WITHAL}).length>0&&(a.appDt.where({WITHAL:t.WITHAL})[0].AMOUNT=e.value)}})),p.createElement(M.EmptyItem,null),p.createElement(M.EmptyItem,null)),p.createElement(M.GroupItem,{colCount:3,visible:3==this.state["rstType"+t.WITHAL]},p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("txtRstItem"),alignment:"right"}),p.createElement(_.ZP,{id:"txtRstItem"+t.WITHAL,parent:this,simple:!0,readOnly:!0,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,value:t.ITEM_CODE,displayValue:t.ITEM_NAME,placeholder:"Açıklama girilecek",button:[{id:"01",icon:"more",onClick:function(){a["pg_txtRstItem"+t.WITHAL]["txtpg_txtRstItem"+t.WITHAL].value="",a["pg_txtRstItem"+t.WITHAL].show(),a["pg_txtRstItem"+t.WITHAL].onClick=function(e){e.length>0&&(a["txtRstItem"+t.WITHAL].value=e[0].CODE,a["txtRstItem"+t.WITHAL].displayValue=e[0].NAME,a.appDt.where({WITHAL:t.WITHAL}).length>0&&(a.appDt.where({WITHAL:t.WITHAL})[0].ITEM_GUID=e[0].GUID,a.appDt.where({WITHAL:t.WITHAL})[0].ITEM_CODE=e[0].CODE,a.appDt.where({WITHAL:t.WITHAL})[0].ITEM_NAME=e[0].NAME,a.appDt.where({WITHAL:t.WITHAL})[0].QUANTITY=1,a.appDt.where({WITHAL:t.WITHAL})[0].AMOUNT=0))}}}]}),p.createElement(y.Z,{id:"pg_txtRstItem"+t.WITHAL,parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,width:"90%",height:"90%",title:this.t("pg_Grid.title"),search:!0,data:{source:{select:{query:"SELECT MAX(ITEM_GUID) AS GUID,MAX(BARCODE) AS BARCODE,ITEM_CODE AS CODE,ITEM_NAME AS NAME,MAIN_GRP_NAME AS MAIN_GRP_NAME FROM ITEM_BARCODE_VW_01 WHERE (UPPER(ITEM_CODE) LIKE UPPER(@VAL) OR UPPER(ITEM_NAME) LIKE UPPER(@VAL) OR BARCODE LIKE @VAL) AND STATUS = 1 GROUP BY ITEM_CODE,ITEM_NAME,MAIN_GRP_NAME",param:["VAL:string|50"]},sql:this.core.sql}}},p.createElement(x.sg,{dataField:"BARCODE",caption:this.t("pg_Grid.clmBarcode"),width:150}),p.createElement(x.sg,{dataField:"CODE",caption:this.t("pg_Grid.clmCode"),width:150}),p.createElement(x.sg,{dataField:"NAME",caption:this.t("pg_Grid.clmName"),width:650,defaultSortOrder:"asc"}),p.createElement(x.sg,{dataField:"MAIN_GRP_NAME",caption:this.t("pg_Grid.clmGrpName"),width:150}))),p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("txtRstItemQuantity"),alignment:"right"}),p.createElement(_.ZP,{id:"txtRstItemQuantity"+t.WITHAL,parent:this,simple:!0,value:t.QUANTITY,onValueChanged:function(e){a.appDt.where({WITHAL:t.WITHAL}).length>0&&(a.appDt.where({WITHAL:t.WITHAL})[0].QUANTITY=e.value)}})),p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("txtRstItemAmount"),alignment:"right"}),p.createElement(_.ZP,{id:"txtRstItemAmount"+t.WITHAL,parent:this,simple:!0,readOnly:!0,value:t.AMOUNT,button:[{id:"01",icon:"more",onClick:(e=(0,r.Z)(d().mark((function e(){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.appDt.length>0)){e.next=5;break}return e.next=3,a.getPrice(a.appDt[0].ITEM_GUID);case 3:n=e.sent,a.setState({discPrice:n});case 5:a["txtDiscRate"+t.WITHAL].value=a["txtRstItemAmount"+t.WITHAL].value,a["txtDiscAmount"+t.WITHAL].value=Number(a.state.discPrice-Number(a.state.discPrice).rateInc(a["txtRstItemAmount"+t.WITHAL].value,2)).toFixed(2),a["popDiscount"+t.WITHAL].show();case 8:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})}]}))))),p.createElement("div",null,p.createElement(N.ZP,{parent:this,id:"popDiscount"+t.WITHAL,container:"#root",position:{of:"#root"},showCloseButton:!0,showTitle:!0,title:this.t("popDiscount.title"),width:"400",height:"260"},p.createElement("div",{className:"row"},p.createElement("div",{className:"col-12"},p.createElement("h5",{className:"text-center"},this.state.discPrice))),p.createElement("div",{className:"row"},p.createElement(R(),{colCount:1},p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("popDiscount.txtDiscRate"),alignment:"right"}),p.createElement(_.ZP,{id:"txtDiscRate"+t.WITHAL,parent:this,simple:!0,onValueChanged:function(){var e=(0,r.Z)(d().mark((function e(n){var i;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.value>=0&&n.value<=100)){e.next=4;break}a["txtDiscAmount"+t.WITHAL].value=Number(a.state.discPrice-Number(a.state.discPrice).rateInc(n.value,2)).toFixed(2),e.next=9;break;case 4:return a["txtDiscAmount"+t.WITHAL].value=0,a["txtDiscRate"+t.WITHAL].value=0,i={id:"msgDiscRate",showTitle:!0,title:a.t("msgDiscRate.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgDiscRate.btn01"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgDiscRate.msg"))},e.next=9,(0,S.W)(i);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})),p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("popDiscount.txtDiscAmount"),alignment:"right"}),p.createElement(_.ZP,{id:"txtDiscAmount"+t.WITHAL,parent:this,simple:!0,onValueChanged:function(){var e=(0,r.Z)(d().mark((function e(n){var i;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Number(100-Number(a.state.discPrice).rate2Num(n.value,2))>=0&&Number(100-Number(a.state.discPrice).rate2Num(n.value,2))<=100)){e.next=4;break}a["txtDiscRate"+t.WITHAL].value=Number(100-Number(a.state.discPrice).rate2Num(n.value,2)).toFixed(2),e.next=9;break;case 4:return a["txtDiscAmount"+t.WITHAL].value=0,a["txtDiscRate"+t.WITHAL].value=0,i={id:"msgDiscRate",showTitle:!0,title:a.t("msgDiscRate.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgDiscRate.btn01"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgDiscRate.msg"))},e.next=9,(0,S.W)(i);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})),p.createElement(M.Item,null,p.createElement(w.Z,{id:"btnDiscSave"+t.WITHAL,parent:this,text:this.t("popDiscount.btnSave"),type:"default",width:"100%",onClick:function(){0==a.state["rstType"+t.WITHAL]?(a["txtRstQuantity"+t.WITHAL].value=a["txtDiscRate"+t.WITHAL].value,a.appDt.where({WITHAL:t.WITHAL})[0].AMOUNT=a["txtDiscRate"+t.WITHAL].value):3==a.state["rstType"+t.WITHAL]?(a["txtRstItemAmount"+t.WITHAL].value=a["txtDiscRate"+t.WITHAL].value,a.appDt.where({WITHAL:t.WITHAL})[0].AMOUNT=a["txtDiscRate"+t.WITHAL].value):5==a.state["rstType"+t.WITHAL]&&(a["txtRstQuantity"+t.WITHAL].value=a["txtDiscAmount"+t.WITHAL].value,a.appDt.where({WITHAL:t.WITHAL})[0].AMOUNT=a["txtDiscAmount"+t.WITHAL].value),a["popDiscount"+t.WITHAL].hide()}}))))))))):void 0}},{key:"render",value:function(){var t,e=this;return p.createElement("div",null,p.createElement(v(),null,p.createElement("div",{className:"row px-2 pt-2"},p.createElement("div",{className:"col-12"},p.createElement(C(),null,p.createElement(M.Item,{location:"after",locateInMenu:"auto"},p.createElement(w.Z,{id:"btnNew",parent:this,icon:"file",type:"default",onClick:function(){e.init()}})),p.createElement(M.Item,{location:"after",locateInMenu:"auto"},p.createElement(w.Z,{id:"btnSave",parent:this,icon:"floppy",type:"default",validationGroup:"frmPromo"+this.tabIndex,onClick:function(){var t=(0,r.Z)(d().mark((function t(n){var i,r,a;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("valid"!=n.validationGroup.validate().status){t.next=26;break}return i={id:"msgSave",showTitle:!0,title:e.t("msgSave.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.t("msgSave.btn01"),location:"before"},{id:"btn02",caption:e.t("msgSave.btn02"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},e.t("msgSave.msg"))},t.next=4,(0,S.W)(i);case 4:if("btn01"!=t.sent){t.next=24;break}return r={id:"msgSaveResult",showTitle:!0,title:e.t("msgSave.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.t("msgSave.btn01"),location:"after"}]},e.condDt.forEach((function(t){if(0==t.TYPE)if(e["itemList"+t.WITHAL].length>0)e["itemList"+t.WITHAL].forEach((function(n){var i=e.promo.cond.dt().where({GUID:n.GUID}).where({ITEM_GUID:n.ITEM_GUID});if(i.length>0)i[0].TYPE=t.TYPE,i[0].ITEM_CODE=n.ITEM_CODE,i[0].ITEM_NAME=n.ITEM_NAME,i[0].QUANTITY=t.QUANTITY,i[0].AMOUNT=t.AMOUNT;else{var r=W({},e.promo.cond.empty);r.PROMO=e.promo.dt()[0].GUID,r.ITEM_GUID=n.ITEM_GUID,r.ITEM_CODE=n.ITEM_CODE,r.ITEM_NAME=n.ITEM_NAME,r.TYPE=t.TYPE,r.QUANTITY=t.QUANTITY,r.AMOUNT=t.AMOUNT,r.WITHAL=t.WITHAL,e.promo.cond.addEmpty(r)}}));else{var n=W({},e.promo.cond.empty);n.PROMO=e.promo.dt()[0].GUID,n.ITEM_GUID="00000000-0000-0000-0000-000000000000",n.ITEM_CODE="",n.ITEM_NAME="",n.TYPE=t.TYPE,n.QUANTITY=t.QUANTITY,n.AMOUNT=t.AMOUNT,n.WITHAL=t.WITHAL,e.promo.cond.addEmpty(n)}else if(1==t.TYPE){var i=e.promo.cond.dt().where({GUID:t.GUID});if(i.length>0)i[0].TYPE=t.TYPE,i[0].ITEM_GUID="00000000-0000-0000-0000-000000000000",i[0].ITEM_CODE="",i[0].ITEM_NAME="",i[0].QUANTITY=t.QUANTITY,i[0].AMOUNT=t.AMOUNT;else{var r=W({},e.promo.cond.empty);r.PROMO=e.promo.dt()[0].GUID,r.ITEM_GUID="00000000-0000-0000-0000-000000000000",r.ITEM_CODE="",r.ITEM_NAME="",r.TYPE=t.TYPE,r.QUANTITY=t.QUANTITY,r.AMOUNT=t.AMOUNT,r.WITHAL=t.WITHAL,e.promo.cond.addEmpty(r)}}})),e.appDt.forEach((function(t){var n=e.promo.app.dt().where({GUID:t.GUID});if(n.length>0)n[0].TYPE=t.TYPE,3!=t.TYPE?(n[0].ITEM_GUID="00000000-0000-0000-0000-000000000000",n[0].ITEM_CODE="",n[0].ITEM_NAME=""):(n[0].ITEM_GUID=t.ITEM_GUID,n[0].ITEM_CODE=t.ITEM_CODE,n[0].ITEM_NAME=t.ITEM_NAME),n[0].QUANTITY=t.QUANTITY,n[0].AMOUNT=t.AMOUNT;else{var i=W({},e.promo.app.empty);i.PROMO=e.promo.dt()[0].GUID,i.TYPE=t.TYPE,3!=t.TYPE?(i.ITEM_GUID="00000000-0000-0000-0000-000000000000",i.ITEM_CODE="",i.ITEM_NAME=""):(i.ITEM_GUID=t.ITEM_GUID,i.ITEM_CODE=t.ITEM_CODE,i.ITEM_NAME=t.ITEM_NAME),i.QUANTITY=t.QUANTITY,i.AMOUNT=t.AMOUNT,i.WITHAL=t.WITHAL,e.promo.app.addEmpty(i)}})),t.next=11,e.core.util.waitUntil(0);case 11:return t.next=13,e.promo.save();case 13:if(t.t0=t.sent,0!=t.t0){t.next=21;break}return e.getPromotion(e.txtCode.value),r.content=p.createElement("div",{style:{textAlign:"center",fontSize:"20px",color:"green"}},e.t("msgSaveResult.msgSuccess")),t.next=19,(0,S.W)(r);case 19:t.next=24;break;case 21:return r.content=p.createElement("div",{style:{textAlign:"center",fontSize:"20px",color:"red"}},e.t("msgSaveResult.msgFailed")),t.next=24,(0,S.W)(r);case 24:t.next=29;break;case 26:return a={id:"msgSaveValid",showTitle:!0,title:e.t("msgSaveValid.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.t("msgSaveValid.btn01"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},e.t("msgSaveValid.msg"))},t.next=29,(0,S.W)(a);case 29:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),p.createElement(M.Item,{location:"after",locateInMenu:"auto"},p.createElement(w.Z,{id:"btnDelete",parent:this,icon:"trash",type:"default",onClick:(0,r.Z)(d().mark((function t(){var n;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={id:"msgDelete",showTitle:!0,title:e.t("msgDelete.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.t("msgDelete.btn01"),location:"before"},{id:"btn02",caption:e.t("msgDelete.btn02"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},e.t("msgDelete.msg"))},t.next=3,(0,S.W)(n);case 3:if("btn01"!=t.sent){t.next=9;break}return e.promo.dt().removeAt(0),t.next=8,e.promo.dt().delete();case 8:e.init();case 9:case"end":return t.stop()}}),t)})))})),p.createElement(M.Item,{location:"after",locateInMenu:"auto",widget:"dxButton",options:{type:"default",icon:"clear",onClick:(t=(0,r.Z)(d().mark((function t(){var n;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={id:"msgClose",showTitle:!0,title:e.lang.t("msgWarning"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.lang.t("btnYes"),location:"before"},{id:"btn02",caption:e.lang.t("btnNo"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},e.lang.t("msgClose"))},t.next=3,(0,S.W)(n);case 3:"btn01"==t.sent&&h.Z.instance.panel.closePage();case 5:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}})))),p.createElement("div",{className:"row px-2 pt-2"},p.createElement("div",{className:"col-12"},p.createElement(R(),{colCount:3,id:"frmPromo"+this.tabIndex},p.createElement(M.GroupItem,{colSpan:3},p.createElement(M.GroupItem,{colCount:3},p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("txtCode"),alignment:"right"}),p.createElement(_.ZP,{id:"txtCode",parent:this,simple:!0,tabIndex:this.tabIndex,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,dt:{data:this.promo.dt(),field:"CODE"},placeholder:this.t("txtCodePlace"),button:[{id:"01",icon:"more",onClick:function(){e.pg_txtCode.show(),e.pg_txtCode.onClick=function(t){t.length>0&&e.getPromotion(t[0].CODE)}}},{id:"02",icon:"arrowdown",onClick:function(){e.txtCode.value=Math.floor(Date.now()/1e3)}}],onChange:(0,r.Z)(d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.checkPromotion(e.txtCode.value);case 2:3==t.sent&&(e.txtCode.value="");case 4:case"end":return t.stop()}}),t)}))).bind(this),param:this.param.filter({ELEMENT:"txtCode",USERS:this.user.CODE})},p.createElement(_.cX,{validationGroup:"frmPromo"+this.tabIndex},p.createElement(_.n2,null))),p.createElement(y.Z,{id:"pg_txtCode",parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,width:"90%",height:"90%",title:this.t("pg_Grid.title"),data:{source:{select:{query:"SELECT CODE,NAME FROM PROMO_VW_01 GROUP BY CODE,NAME"},sql:this.core.sql}}},p.createElement(x.sg,{dataField:"CODE",caption:this.t("pg_Grid.clmCode"),width:150}),p.createElement(x.sg,{dataField:"NAME",caption:this.t("pg_Grid.clmName"),width:650,defaultSortOrder:"asc"}))),p.createElement(M.Item,{colSpan:2},p.createElement(M.Label,{text:this.t("txtName"),alignment:"right"}),p.createElement(_.ZP,{id:"txtName",parent:this,simple:!0,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,placeholder:this.t("txtNamePlace"),dt:{data:this.promo.dt(),field:"NAME"}})),p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("dtStartDate"),alignment:"right"}),p.createElement(L.ZP,{simple:!0,parent:this,id:"dtStartDate",dt:{data:this.promo.dt(),field:"START_DATE"}})),p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("dtFinishDate"),alignment:"right"}),p.createElement(L.ZP,{simple:!0,parent:this,id:"dtFinishDate",dt:{data:this.promo.dt(),field:"FINISH_DATE"}})),p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("cmbDepot"),alignment:"right"}),p.createElement(U.ZP,{simple:!0,parent:this,id:"cmbDepot",dt:{data:this.promo.dt(),field:"DEPOT_GUID",display:"DEPOT_NAME"},displayExpr:"DEPOT_NAME",valueExpr:"DEPOT_GUID",data:{source:{select:{query:"SELECT '00000000-0000-0000-0000-000000000000' AS DEPOT_GUID, 'ALL DEPOT' AS DEPOT_NAME UNION ALL SELECT GUID AS DEPOT_GUID,NAME AS DEPOT_NAME FROM DEPOT_VW_01"},sql:this.core.sql}},onValueChanged:function(t){}})),p.createElement(M.Item,null,p.createElement(M.Label,{text:this.t("txtCustomerCode"),alignment:"right"}),p.createElement(_.ZP,{id:"txtCustomerCode",parent:this,simple:!0,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,dt:{data:this.promo.dt(),field:"CUSTOMER_CODE"},placeholder:this.t("txtCustomerCodePlace"),button:[{id:"01",icon:"more",onClick:function(){e.pg_txtCustomerCode.show(),e.pg_txtCustomerCode.onClick=function(t){t.length>0&&(e.promo.dt()[0].CUSTOMER_GUID=t[0].GUID,e.txtCustomerCode.value=t[0].CODE,e.txtCustomerName.value=t[0].TITLE)}}}],onChange:(0,r.Z)(d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))).bind(this)}),p.createElement(y.Z,{id:"pg_txtCustomerCode",parent:this,container:".dx-multiview-wrapper",position:{of:"#page"},showTitle:!0,showBorders:!0,width:"90%",height:"90%",title:this.t("pg_Grid.title"),columnAutoWidth:!0,allowColumnResizing:!0,search:!0,data:{source:{select:{query:"SELECT GUID,CODE,TITLE,NAME,LAST_NAME,[TYPE_NAME],[GENUS_NAME] FROM CUSTOMER_VW_01 WHERE UPPER(CODE) LIKE UPPER(@VAL) OR UPPER(TITLE) LIKE UPPER(@VAL)",param:["VAL:string|50"]},sql:this.core.sql}}},p.createElement(x.PY,{mode:"standart"}),p.createElement(x.sg,{dataField:"TITLE",caption:this.t("pg_Grid.clmName"),width:650,defaultSortOrder:"asc"}),p.createElement(x.sg,{dataField:"CODE",caption:this.t("pg_Grid.clmCode"),width:150}))),p.createElement(M.Item,{colSpan:2},p.createElement(M.Label,{text:this.t("txtCustomerName"),alignment:"right"}),p.createElement(_.ZP,{id:"txtCustomerName",parent:this,simple:!0,readOnly:!0,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,dt:{data:this.promo.dt(),field:"CUSTOMER_NAME"}})))),p.createElement(M.GroupItem,{colSpan:3},p.createElement(M.Item,null,p.createElement(b.Z,{id:"lstPromo",parent:this,allowItemDeleting:!0,itemDeleteMode:"static",selectionMode:"none",collapsibleGroups:!1,grouped:!0,height:"100%",width:"100%",itemRender:this.itemTemplate.bind(this),groupRender:this.groupTemplate.bind(this),onItemDeleted:function(t){0==t.itemIndex.group?e.promo.cond.dt().where({WITHAL:t.itemIndex.item}).forEach((function(t){e.promo.cond.dt().removeAt(t)})):1==t.itemIndex.group&&e.promo.app.dt().where({WITHAL:t.itemIndex.item}).forEach((function(t){e.promo.app.dt().removeAt(t)}))}}))))))))}}]),O}(p.PureComponent)}}]);