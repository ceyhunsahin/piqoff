"use strict";(self.webpackChunkwww=self.webpackChunkwww||[]).push([[4566],{51559:(e,t,a)=>{a.d(t,{ZP:()=>p});var r=a(15861),s=a(15671),i=a(43144),n=a(97326),o=a(60136),c=a(82963),l=a(61120),d=a(64687),u=a.n(d),h=a(67294),m=a(11694),E=a.n(m);var p=function(e){(0,o.Z)(p,e);var t,a,d,m=(a=p,d=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,l.Z)(a);if(d){var r=(0,l.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,c.Z)(this,e)});function p(e){var t;return(0,s.Z)(this,p),(t=m.call(this,e)).dev=null,t.state.value=void 0!==e.value?e.value:"",t.state.placeholder=void 0===e.placeholder?"":e.placeholder,t._onInitialized=t._onInitialized.bind((0,n.Z)(t)),t._onValueChanged=t._onValueChanged.bind((0,n.Z)(t)),t}return(0,i.Z)(p,[{key:"_onInitialized",value:function(e){this.dev=e.component}},{key:"_TagBoxView",value:function(){return h.createElement(E(),{id:this.props.id,items:[],acceptCustomValue:!0,onValueChanged:this._onValueChanged,placeholder:this.state.placeholder,openOnFieldClick:!1,showClearButton:!0,maxFilterQueryLength:1e4,noDataText:""},this.props.children,this.validationView())}},{key:"_onValueChanged",value:function(e){this.value=e.value,void 0!==this.props.onValueChanged&&this.props.onValueChanged(e)}},{key:"value",get:function(){return this.state.value},set:function(e){var t=this;if(void 0!==e){if(void 0!==this.props.dt&&void 0!==this.props.dt.data&&this.props.dt.data.length>0&&void 0!==this.props.dt.field)if(void 0===this.props.dt.filter)void 0!==this.props.dt.row&&void 0!==this.props.dt.data.find((function(e){return e===t.props.dt.row}))?(this.props.dt.data.find((function(e){return e===t.props.dt.row}))[this.props.dt.field]=e,void 0!==this.props.dt.display&&(this.props.dt.data.find((function(e){return e===t.props.dt.row}))[this.props.dt.display]=this.displayValue)):(this.props.dt.data[this.props.dt.data.length-1][this.props.dt.field]=e,void 0!==this.props.dt.display&&(this.props.dt.data[this.props.dt.data.length-1][this.props.dt.display]=this.displayValue));else{var a=this.props.dt.data.where(this.props.dt.filter);a.length>0&&(void 0!==this.props.dt.row&&void 0!==a.find((function(e){return e===t.props.dt.row}))?(a.find((function(e){return e===t.props.dt.row}))[this.props.dt.field]=e,void 0!==this.props.dt.display&&(a.find((function(e){return e===t.props.dt.row}))[this.props.dt.display]=this.displayValue)):(a[a.length-1][this.props.dt.field]=e,void 0!==this.props.dt.display&&(a[a.length-1][this.props.dt.display]=this.displayValue)))}this.setState({value:null==e?"":e})}}},{key:"displayValue",get:function(){return this.dev.option("displayValue")}},{key:"componentDidMount",value:(t=(0,r.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===this.state.data){e.next=3;break}return e.next=3,this.dataRefresh(this.state.data);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){return void 0!==this.props.simple&&this.props.simple?this._TagBoxView():h.createElement("div",{className:"dx-field"},h.createElement("div",{className:"dx-field-label"},void 0===this.props.title?"":this.props.title),h.createElement("div",{className:"dx-field-value"},this._TagBoxView()))}}]),p}(a(20819).ZP)},24566:(e,t,a)=>{a.r(t),a.d(t,{default:()=>b});var r=a(15861),s=a(15671),i=a(43144),n=a(97326),o=a(60136),c=a(82963),l=a(61120),d=a(64687),u=a.n(d),h=a(67294),m=a(73364),E=a(96421),p=a(30381),O=a.n(p),C=(a(42866),a(53221),a(25552)),T=a.n(C),P=(a(91686),a(30886),a(99846),a(5083)),D=a(99077),v=(a(55585),a(417),a(32175)),N=a(18405),f=a(73682),g=a(90428),A=(a(51559),a(4598)),S=(a(57941),a(60547)),U=a(17276);a(51166);var b=function(e){(0,o.Z)(R,e);var t,a,d,p,b,y,_=(b=R,y=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,l.Z)(b);if(y){var a=(0,l.Z)(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return(0,c.Z)(this,e)});function R(){var e;return(0,s.Z)(this,R),(e=_.call(this)).core=m.Z.instance.core,e.prmObj=e.param.filter({TYPE:1,USERS:e.user.CODE}),e.acsobj=e.access.filter({TYPE:1,USERS:e.user.CODE}),e.docObj=new A.Ch,e.btnGetDetail=e.btnGetDetail.bind((0,n.Z)(e)),e.message="",e.Advance=0,e.lastPosSaleDt=new U.$A,e.lastPosPayDt=new U.$A,e.state={ticketId:""},e.finishButtonClick=e.finishButtonClick.bind((0,n.Z)(e)),E.Z.defaultProps={validate:!0,previousButtonText:e.t("previous"),finishButtonText:e.t("finish"),nextButtonText:e.t("next"),color:"primary",progressbar:!1},e.steps=[{stepName:e.t("start"),stepIcon:"tim-icons icon-single-02",component:e.stepStart()},{stepName:e.t("advance"),stepIcon:"tim-icons icon-settings-gear-63",component:e.stepAdvance()},{stepName:e.t("cash"),stepIcon:"tim-icons icon-delivery-fast",component:e.stepCash()},{stepName:e.t("debitCard"),stepIcon:"tim-icons icon-settings-gear-63",component:e.stepCreditCard()},{stepName:e.t("check"),stepIcon:"tim-icons icon-settings-gear-63",component:e.stepCheck()},{stepName:e.t("ticketRest"),stepIcon:"tim-icons icon-settings-gear-63",component:e.stepRestorant()}],e.Cash="",e.DebitCard="",e.Check="",e.TicketRest="",e.color={cash:"green",card:"green",check:"green",rest:"green"},e.paymentData=new U.$A,e}return(0,i.Z)(R,[{key:"componentDidMount",value:(p=(0,r.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.core.util.waitUntil(0);case 2:this.init();case 3:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"init",value:(d=(0,r.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dtDocDate.value=O()(new Date).format("YYYY-MM-DD"),t={source:{groupBy:this.groupList,select:{query:"SELECT *,CONVERT(NVARCHAR,DOC_DATE,104) AS DATE,SUBSTRING(CONVERT(NVARCHAR(50),GUID),20,25) AS TICKET_ID,ISNULL((SELECT TOP 1 DESCRIPTION FROM POS_EXTRA WHERE POS_EXTRA.POS_GUID =POS_VW_01.GUID AND TAG = 'PARK DESC' ),'') AS DESCRIPTION FROM POS_VW_01 WHERE STATUS = 0 ORDER BY DOC_DATE "},sql:this.core.sql}},e.next=4,this.grdOpenTike.dataRefresh(t);case 4:return this.grdOpenTike.data.datatable.length>0&&this.popOpenTike.show(),e.next=7,this.grdAdvance.dataRefresh({source:this.docObj.docCustomer.dt("DOC_CUSTOMER")});case 7:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"btnGetDetail",value:(a=(0,r.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastPosSaleDt.selectCmd={query:"SELECT * FROM POS_SALE_VW_01  WHERE POS_GUID = @POS_GUID ",param:["POS_GUID:string|50"],value:[t]},e.next=3,this.lastPosSaleDt.refresh();case 3:return e.next=5,this.grdSaleTicketItems.dataRefresh({source:this.lastPosSaleDt});case 5:return this.lastPosPayDt.selectCmd={query:"SELECT (AMOUNT-CHANGE) AS LINE_TOTAL,* FROM POS_PAYMENT_VW_01  WHERE POS_GUID = @POS_GUID ",param:["POS_GUID:string|50"],value:[t]},this.lastPosPayDt.insertCmd={query:"EXEC [dbo].[PRD_POS_PAYMENT_INSERT] @GUID = @PGUID, @CUSER = @PCUSER, @POS = @PPOS, @TYPE = @PTYPE, @LINE_NO = @PLINE_NO, @AMOUNT = @PAMOUNT, @CHANGE = @PCHANGE ",param:["PGUID:string|50","PCUSER:string|25","PPOS:string|50","PTYPE:int","PLINE_NO:int","PAMOUNT:float","PCHANGE:float"],dataprm:["GUID","CUSER","POS_GUID","PAY_TYPE","LINE_NO","AMOUNT","CHANGE"]},this.lastPosPayDt.updateCmd={query:"EXEC [dbo].[PRD_POS_PAYMENT_UPDATE] @GUID = @PGUID, @CUSER = @PCUSER, @POS = @PPOS, @TYPE = @PTYPE, @LINE_NO = @PLINE_NO, @AMOUNT = @PAMOUNT, @CHANGE = @PCHANGE ",param:["PGUID:string|50","PCUSER:string|25","PPOS:string|50","PTYPE:int","PLINE_NO:int","PAMOUNT:float","PCHANGE:float"],dataprm:["GUID","CUSER","POS_GUID","PAY_TYPE","LINE_NO","AMOUNT","CHANGE"]},this.lastPosPayDt.deleteCmd={query:"EXEC [dbo].[PRD_POS_PAYMENT_DELETE] @CUSER = @PCUSER, @UPDATE = 1, @GUID = @PGUID, @POS_GUID = @PPOS_GUID ",param:["PCUSER:string|25","PGUID:string|50","PPOS_GUID:string|50"],dataprm:["CUSER","GUID","POS_GUID"]},e.next=11,this.lastPosPayDt.refresh();case 11:return e.next=13,this.grdSaleTicketPays.dataRefresh({source:this.lastPosPayDt});case 13:this.popDetail.show();case 14:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"finishButtonClick",value:(t=(0,r.Z)(u().mark((function e(){var t,a,r,s,i,n,o,c,l,d,h;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.message=this.txtAdvance.value.toLocaleString("en-IN",{style:"currency",currency:"eur",minimumFractionDigits:2}),this.Advance=this.txtAdvance.value,t={query:"SELECT   MAX(DOC_DATE) AS DOC_DATE,PAY_TYPE AS PAY_TYPE,TYPE AS TYPE,  PAY_TYPE_NAME AS PAY_TYPE_NAME,   CASE WHEN TYPE = 0 THEN SUM(AMOUNT - CHANGE) ELSE SUM(AMOUNT) * -1 END AS AMOUNT   FROM POS_PAYMENT_VW_01 WHERE DOC_DATE = @DOC_DATE AND DEVICE = @DEVICE AND STATUS = 1   GROUP BY PAY_TYPE_NAME,PAY_TYPE,TYPE ",param:["DOC_DATE:date","DEVICE:string|50"],value:[this.dtDocDate.value,this.cmbSafe.value]},e.next=5,this.core.sql.execute(t);case 5:if((a=e.sent).result.recordset.length>0)for(this.paymentData.clear(),r=0;r<a.result.recordset.length;r++)this.paymentData.push(a.result.recordset[r]);parseFloat(this.paymentData.where({PAY_TYPE:0}).sum("AMOUNT").toFixed(2))==parseFloat((this.txtCash.value-this.txtAdvance.value).toFixed(2))?(this.color.cash="green",this.Cash=this.t("txtReal"),this.setState({Cash:this.t("txtReal")})):((s=parseFloat(parseFloat(this.txtCash.value)-parseFloat(this.txtAdvance.value).toFixed(2))-parseFloat(this.paymentData.where({PAY_TYPE:0}).sum("AMOUNT").toFixed(2)))>0?(this.color.cash="blue",i="+"+s.toLocaleString("en-IN",{style:"currency",currency:"eur",minimumFractionDigits:2})):(this.color.cash="red",i=s.toLocaleString("en-IN",{style:"currency",currency:"eur",minimumFractionDigits:2})),this.Cash=i,this.setState({Cash:i})),this.paymentData.where({PAY_TYPE:1}).sum("AMOUNT").toFixed(2)==this.txtCreditCard.value.toFixed(2)?(this.color.card="green",this.DebitCard=this.t("txtReal"),this.setState({DebitCard:this.t("txtReal")})):((n=(this.txtCreditCard.value-parseFloat(this.paymentData.where({PAY_TYPE:1}).sum("AMOUNT"))).toFixed(2))>0?(this.color.card="blue",o="+"+n.toLocaleString("en-IN",{style:"currency",currency:"eur",minimumFractionDigits:2})):(this.color.card="red",o=n.toLocaleString("en-IN",{style:"currency",currency:"eur",minimumFractionDigits:2})),this.DebitCard=o,this.setState({DebitCard:o})),parseFloat(this.paymentData.where({PAY_TYPE:2}).sum("AMOUNT").toFixed(2))==this.txtCheck.value?(this.color.check="green",this.Check=this.t("txtReal"),this.setState({Check:this.t("txtReal")})):((c=parseFloat((this.txtCheck.value-parseFloat(this.paymentData.where({PAY_TYPE:2}).sum("AMOUNT"))).toFixed(2)))>0?(this.color.check="blue",l="+"+c.toLocaleString("en-IN",{style:"currency",currency:"eur",minimumFractionDigits:2})):(this.color.check="red",l=c.toLocaleString("en-IN",{style:"currency",currency:"eur",minimumFractionDigits:2})),this.Check=l,this.setState({Check:l})),parseFloat(this.paymentData.where({PAY_TYPE:3}).sum("AMOUNT"))==this.txtRestorant.value?(this.color.rest="green",this.TicketRest=this.t("txtReal"),this.setState({TicketRest:this.t("txtReal")})):((d=parseFloat((this.txtRestorant.value-parseFloat(this.paymentData.where({PAY_TYPE:3}).sum("AMOUNT"))).toFixed(2)))>0?(this.color.rest="blue",h="+"+d.toLocaleString("en-IN",{style:"currency",currency:"eur",minimumFractionDigits:2})):(this.color.rest="red",h=d.toLocaleString("en-IN",{style:"currency",currency:"eur",minimumFractionDigits:2})),this.TicketRest=h,this.setState({TicketRest:d})),this.popFinish.show();case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"stepStart",value:function(){var e=this;return h.createElement(T(),{colCount:2},h.createElement(C.Item,null,h.createElement(C.Label,{text:this.t("dtDocDate"),alignment:"right"}),h.createElement(g.ZP,{simple:!0,parent:this,id:"dtDocDate",onValueChanged:function(){var t=(0,r.Z)(u().mark((function t(a){var r,s;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""==e.cmbSafe.value){t.next=7;break}return r={query:"SELECT ROUND((SUM(AMOUNT) - ISNULL((SELECT SUM(AMOUNT) FROM DOC_CUSTOMER_VW_01 AS DOCOUT WHERE DOCOUT.OUTPUT = DOCIN.INPUT AND TYPE = 2 AND DOC_TYPE = 201 AND PAY_TYPE = 20),0)),2) AS AMOUNT FROM DOC_CUSTOMER_VW_01 AS DOCIN WHERE INPUT_CODE = @INPUT_CODE AND TYPE = 2 AND DOC_TYPE = 201 AND PAY_TYPE = 20 GROUP BY INPUT",param:["INPUT_CODE:string|50"],value:[e.cmbSafe.value]},t.next=4,e.core.sql.execute(r);case 4:s=t.sent,console.log(s),s.result.recordset.length>0&&(e.txtAdvance.value=s.result.recordset[0].AMOUNT);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}().bind(this)})),h.createElement(C.Item,null,h.createElement(C.Label,{text:this.t("cmbSafe"),alignment:"right"}),h.createElement(D.ZP,{simple:!0,parent:this,id:"cmbSafe",notRefresh:!0,displayExpr:"NAME",valueExpr:"CODE",showClearButton:!0,value:"",data:{source:{select:{query:"SELECT NAME,CODE,GUID FROM [dbo].[SAFE_VW_01] WHERE TYPE = 2"},sql:this.core.sql}},param:this.param.filter({ELEMENT:"cmbSafe",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"cmbSafe",USERS:this.user.CODE}),onValueChanged:function(){var t=(0,r.Z)(u().mark((function t(a){var r,s;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={query:"SELECT ROUND((SUM(AMOUNT) - ISNULL((SELECT SUM(AMOUNT) FROM DOC_CUSTOMER_VW_01 AS DOCOUT WHERE DOCOUT.OUTPUT = DOCIN.INPUT AND TYPE = 2 AND DOC_TYPE = 201 AND PAY_TYPE = 20),0)),2) AS AMOUNT FROM DOC_CUSTOMER_VW_01 AS DOCIN WHERE INPUT_CODE = @INPUT_CODE  AND TYPE = 2 AND DOC_TYPE = 201 AND PAY_TYPE = 20 GROUP BY INPUT",param:["INPUT_CODE:string|50"],value:[e.cmbSafe.value]},t.next=3,e.core.sql.execute(r);case 3:s=t.sent,console.log(s),s.result.recordset.length>0&&(e.txtAdvance.value=s.result.recordset[0].AMOUNT);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}().bind(this)})))}},{key:"stepAdvance",value:function(){return h.createElement(T(),{colCount:2},h.createElement(C.EmptyItem,null),h.createElement(C.Item,null,h.createElement(C.Label,{text:this.t("txtAdvance"),alignment:"right"}),h.createElement(P.ZP,{id:"txtAdvance",parent:this,simple:!0,readOnly:!0,param:this.param.filter({ELEMENT:"txtAdvance",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtAdvance",USERS:this.user.CODE})})))}},{key:"stepCash",value:function(){return h.createElement(T(),{colCount:2},h.createElement(C.EmptyItem,null),h.createElement(C.Item,null,h.createElement(C.Label,{text:this.t("txtCash"),alignment:"right"}),h.createElement(P.ZP,{id:"txtCash",parent:this,simple:!0,value:"",param:this.param.filter({ELEMENT:"txtCash",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtCash",USERS:this.user.CODE})})))}},{key:"stepCreditCard",value:function(){return h.createElement(T(),{colCount:2},h.createElement(C.EmptyItem,null),h.createElement(C.Item,null,h.createElement(C.Label,{text:this.t("txtCreditCard"),alignment:"right"}),h.createElement(P.ZP,{id:"txtCreditCard",parent:this,simple:!0,value:"",param:this.param.filter({ELEMENT:"txtCreditCard",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtCreditCard",USERS:this.user.CODE})})))}},{key:"stepCheck",value:function(){return h.createElement(T(),{colCount:2},h.createElement(C.EmptyItem,null),h.createElement(C.Item,null,h.createElement(C.Label,{text:this.t("txtCheck"),alignment:"right"}),h.createElement(P.ZP,{id:"txtCheck",parent:this,simple:!0,param:this.param.filter({ELEMENT:"txtCheck",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtCheck",USERS:this.user.CODE})})))}},{key:"stepRestorant",value:function(){return h.createElement(T(),{colCount:2},h.createElement(C.EmptyItem,null),h.createElement(C.Item,null,h.createElement(C.Label,{text:this.t("txtRestorant"),alignment:"right"}),h.createElement(P.ZP,{id:"txtRestorant",parent:this,simple:!0,value:"",param:this.param.filter({ELEMENT:"txtRestorant",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtRestorant",USERS:this.user.CODE})})))}},{key:"render",value:function(){var e=this;return h.createElement("div",null,h.createElement("div",{className:"panel"},h.createElement("div",{className:"panel-body container-fluid"},h.createElement("div",{className:"row"},h.createElement("div",{className:"col-12"},h.createElement(E.Z,{color:"green",steps:this.steps,progressbar:!0,title:this.t("title"),finishButtonClick:this.finishButtonClick}))))),h.createElement("div",null,h.createElement(v.ZP,{parent:this,id:"popFinish",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popFinish.title"),container:"#root",width:"500",height:"600",position:{of:"#root"}},h.createElement("div",{className:"col-12"},h.createElement("div",{className:"row"},h.createElement("div",{className:"col-6"},h.createElement("h2",null,this.t("cash"))),h.createElement("div",{className:"col-6",style:{color:this.color.cash}},h.createElement("h2",null," : ",this.Cash))),h.createElement("div",{className:"row"},h.createElement("div",{className:"col-6"},h.createElement("h2",null,this.t("debitCard"))),h.createElement("div",{className:"col-6",style:{color:this.color.card}},h.createElement("h2",null," : ",this.DebitCard))),h.createElement("div",{className:"row"},h.createElement("div",{className:"col-6"},h.createElement("h2",null,this.t("check"))),h.createElement("div",{className:"col-6",style:{color:this.color.check}},h.createElement("h2",null," : ",this.Check))),h.createElement("div",{className:"row"},h.createElement("div",{className:"col-6"},h.createElement("h2",null,this.t("ticketRest"))),h.createElement("div",{className:"col-6",style:{color:this.color.rest}},h.createElement("h2",null," : ",this.TicketRest))),h.createElement("div",{className:"row px-4"},h.createElement("div",{className:"col-12"},h.createElement("h2",null,this.t("advanceMsg1")))),h.createElement("div",{className:"row px-4"},h.createElement("div",{className:"col-4 offset-4"},h.createElement("h2",null,this.message))),h.createElement("div",{className:"row px-4"},h.createElement("div",{className:"col-12"},h.createElement("h2",null,this.t("advanceMsg2")))),h.createElement("div",null,h.createElement(T(),{colCount:3},h.createElement(C.EmptyItem,null),h.createElement(C.Item,null,h.createElement(f.Z,{text:this.t("addAdvance"),onClick:(0,r.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.popAdvance.show();case 1:case"end":return t.stop()}}),t)})))}))))))),h.createElement("div",null,h.createElement(v.ZP,{parent:this,id:"popOpenTike",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popOpenTike.title"),container:"#root",width:"900",height:"500",position:{of:"#root"}},h.createElement(T(),{colCount:1,height:"fit-content"},h.createElement(C.Item,null,h.createElement(N.ZP,{parent:this,id:"grdOpenTike",showBorders:!0,columnsAutoWidth:!0,allowColumnReordering:!0,allowColumnResizing:!0,headerFilter:{visible:!0},height:350,width:"100%",dbApply:!1,onRowDblClick:function(){var t=(0,r.Z)(u().mark((function t(a){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.btnGetDetail(a.data.GUID),e.setState({ticketId:a.data.TICKET_ID});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),onRowRemoved:function(){var e=(0,r.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},h.createElement(N.PY,{mode:"standart"}),h.createElement(N.LO,{mode:"cell",allowUpdating:!1,allowDeleting:!1}),h.createElement(N.sg,{dataField:"CUSER_NAME",caption:this.t("grdOpenTike.clmUser"),width:110,headerFilter:{visible:!0}}),h.createElement(N.sg,{dataField:"DEVICE",caption:this.t("grdOpenTike.clmDevice"),width:80,headerFilter:{visible:!0}}),h.createElement(N.sg,{dataField:"DATE",caption:this.t("grdOpenTike.clmDate"),width:100,allowEditing:!1}),h.createElement(N.sg,{dataField:"TICKET_ID",caption:this.t("grdOpenTike.clmTicketId"),width:180,headerFilter:{visible:!0}}),h.createElement(N.sg,{dataField:"DESCRIPTION",caption:this.t("grdOpenTike.clmDescription"),width:250,headerFilter:{visible:!0}})))))),h.createElement("div",null,h.createElement(v.ZP,{parent:this,id:"popAdvance",visible:!1,showTitle:!0,title:this.t("popAdvance.title"),container:"#root",width:"450",height:"250",position:{of:"#root"}},h.createElement(T(),{colCount:1,height:"fit-content"},h.createElement(C.Item,null,h.createElement("div",{className:"row px-4"},h.createElement("div",{className:"col-12"},h.createElement("h4",null,this.t("popAdvance.msg"))))),h.createElement(C.Item,null,h.createElement(C.Label,{text:this.t("txtPopAdvance"),alignment:"right"}),h.createElement(P.ZP,{id:"txtPopAdvance",parent:this,simple:!0})),h.createElement(C.Item,null,h.createElement("div",{className:"row"},h.createElement("div",{className:"col-6"}),h.createElement("div",{className:"col-6"},h.createElement(f.Z,{text:this.t("btnPopAdd"),type:"normal",stylingMode:"contained",width:"100%",onClick:(0,r.Z)(u().mark((function t(){var a,r,s,i,n,o,c,l;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.txtPopAdvance.value){t.next=9;break}return a={id:"msgZeroQuantity",showTitle:!0,title:e.t("msgZeroQuantity.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.t("msgZeroQuantity.btn01"),location:"before"},{id:"btn02",caption:e.t("msgZeroQuantity.btn02"),location:"after"}],content:h.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},e.t("msgZeroQuantity.msg"))},t.next=4,(0,S.W)(a);case 4:if("btn01"!=t.sent){t.next=7;break}return t.abrupt("return");case 7:t.next=16;break;case 9:if(!(e.txtPopAdvance.value>600)){t.next=16;break}return r={id:"msgBigAmount",showTitle:!0,title:e.t("msgBigAmount.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.t("msgBigAmount.btn01"),location:"before"}],content:h.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},e.t("msgBigAmount.msg"))},t.next=13,(0,S.W)(r);case 13:if("btn01"!=t.sent){t.next=16;break}return t.abrupt("return");case 16:return s={query:"SELECT GUID FROM SAFE_VW_01 WHERE CODE = @INPUT_CODE",param:["INPUT_CODE:string|50"],value:[e.cmbSafe.value]},t.next=19,e.core.sql.execute(s);case 19:return i=t.sent,n=i.result.recordset[0].GUID,o={query:"SELECT ROUND((SUM(AMOUNT) - ISNULL((SELECT SUM(AMOUNT) FROM DOC_CUSTOMER_VW_01 AS DOCOUT WHERE DOCOUT.OUTPUT = DOCIN.INPUT AND TYPE = 2 AND DOC_TYPE = 201 AND PAY_TYPE = 20),0)),2) AS AMOUNT FROM DOC_CUSTOMER_VW_01 AS DOCIN WHERE INPUT_CODE = @INPUT_CODE  AND TYPE = 2 AND DOC_TYPE = 201 AND PAY_TYPE = 20 GROUP BY INPUT",param:["INPUT_CODE:string|50"],value:[e.cmbSafe.value]},t.next=24,e.core.sql.execute(o);case 24:return c=t.sent,l=0,c.result.recordset.length>0&&(l=c.result.recordset[0].AMOUNT),0==e.docObj.dt().length&&(e.docObj.addEmpty(),e.docObj.dt()[0].TYPE=2,e.docObj.dt()[0].DOC_TYPE=201,e.docObj.dt()[0].REF="POS",e.docObj.dt()[0].REF_NO=Math.floor(Date.now()/1e3),e.docObj.dt()[0].DOC_DATE=e.dtDocDate.value,e.docObj.dt()[0].INPUT=n,e.docObj.dt()[0].OUTPUT=e.prmObj.filter({ID:"SafeCenter",TYPE:1}).getValue(),e.docObj.dt()[0].AMOUNT=e.txtPopAdvance.value,e.docObj.dt()[0].TOTAL=e.txtPopAdvance.value),e.docObj.docCustomer.addEmpty(),e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].TYPE=2,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].DOC_GUID=e.docObj.dt()[0].GUID,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].DOC_TYPE=201,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].DOC_DATE=e.dtDocDate.value,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].REF="POS",e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].REF_NO=e.docObj.dt()[0].REF_NO,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].INPUT=n,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].INPUT_NAME=e.cmbSafe.displayValue,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].OUTPUT=e.docObj.dt()[0].OUTPUT,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].PAY_TYPE=20,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].AMOUNT=e.txtPopAdvance.value,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].DESCRIPTION="",e.docObj.docCustomer.addEmpty(),e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].TYPE=2,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].DOC_GUID=e.docObj.dt()[0].GUID,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].DOC_TYPE=201,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].DOC_DATE=e.dtDocDate.value,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].REF="POS",e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].REF_NO=e.docObj.dt()[0].REF_NO,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].INPUT=e.docObj.dt()[0].OUTPUT,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].INPUT_NAME=e.cmbSafe.displayValue,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].OUTPUT=n,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].PAY_TYPE=20,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].AMOUNT=l,e.docObj.docCustomer.dt()[e.docObj.docCustomer.dt().length-1].DESCRIPTION="",t.next=56,e.docObj.save();case 56:e.popAdvance.hide(),e.popFinish.hide();case 58:case"end":return t.stop()}}),t)})))}))))))),h.createElement(v.ZP,{parent:this,id:"popDetail",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popDetail.title"),container:"#root",width:"100%",height:"100%",position:{of:"#root"}},h.createElement("div",{className:"row"},h.createElement("div",{className:"col-1 pe-0"}),h.createElement("div",{className:"col-7 pe-0"},this.t("TicketId")," : ",this.state.ticketId)),h.createElement("div",{className:"row"},h.createElement("div",{className:"col-1 pe-0"}),h.createElement("div",{className:"col-7 pe-0"},h.createElement(N.ZP,{id:"grdSaleTicketItems",parent:this,selection:{mode:"multiple"},showBorders:!0,filterRow:{visible:!0},headerFilter:{visible:!0},columnAutoWidth:!0,allowColumnReordering:!0,allowColumnResizing:!0},h.createElement(N.Po,{defaultPageSize:20}),h.createElement(N.uE,{visible:!0,allowedPageSizes:[5,10,50],showPageSizeSelector:!0}),h.createElement(N.D7,{fileName:this.lang.t("menu.pos_02_001"),enabled:!0,allowExportSelectedData:!0}),h.createElement(N.sg,{dataField:"BARCODE",caption:this.t("grdSaleTicketItems.clmBarcode"),visible:!0,width:150}),h.createElement(N.sg,{dataField:"ITEM_NAME",caption:this.t("grdSaleTicketItems.clmName"),visible:!0,width:250}),h.createElement(N.sg,{dataField:"QUANTITY",caption:this.t("grdSaleTicketItems.clmQuantity"),visible:!0,width:100}),h.createElement(N.sg,{dataField:"PRICE",caption:this.t("grdSaleTicketItems.clmPrice"),visible:!0,width:150,format:{style:"currency",currency:"EUR",precision:2}}),h.createElement(N.sg,{dataField:"TOTAL",caption:this.t("grdSaleTicketItems.clmTotal"),visible:!0,width:150,format:{style:"currency",currency:"EUR",precision:2}}))),h.createElement("div",{className:"col-3 ps-0"},h.createElement(N.ZP,{id:"grdSaleTicketPays",parent:this,selection:{mode:"multiple"},showBorders:!0,filterRow:{visible:!0},headerFilter:{visible:!0},columnAutoWidth:!0,allowColumnReordering:!0,allowColumnResizing:!0,onRowClick:function(){var t=(0,r.Z)(u().mark((function t(a){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.lastPosPayDt.length>0&&(e.rbtnTotalPayType.value=0,e.lastPayRest.value=e.lastPosSaleDt[0].GRAND_TOTAL-e.lastPosPayDt.sum("AMOUNT")<0?0:Number(e.lastPosSaleDt[0].GRAND_TOTAL-e.lastPosPayDt.sum("AMOUNT")),e.txtPopLastTotal.value=e.lastPosSaleDt[0].GRAND_TOTAL,e.popLastTotal.show(),setTimeout((function(){e.grdLastTotalPay.devGrid.selectRowsByIndexes(0)}),100));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},h.createElement(N.Po,{defaultPageSize:20}),h.createElement(N.uE,{visible:!0,allowedPageSizes:[5,10,50],showPageSizeSelector:!0}),h.createElement(N.D7,{fileName:this.lang.t("menu.pos_02_001"),enabled:!0,allowExportSelectedData:!0}),h.createElement(N.sg,{dataField:"PAY_TYPE_NAME",caption:this.t("grdSaleTicketPays.clmPayName"),visible:!0,width:155}),h.createElement(N.sg,{dataField:"LINE_TOTAL",caption:this.t("grdSaleTicketPays.clmTotal"),visible:!0,format:{style:"currency",currency:"EUR",precision:2},width:150}))))))}}]),R}(h.PureComponent)}}]);