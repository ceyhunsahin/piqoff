"use strict";(self.webpackChunkwww=self.webpackChunkwww||[]).push([[6525],{90428:(t,e,n)=>{n.d(e,{ZP:()=>E});var i=n(15671),r=n(43144),a=n(97326),s=n(60136),o=n(82963),c=n(61120),l=n(67294),d=n(14140),u=n.n(d),h=n(20819),p=n(30381),m=n.n(p);var E=function(t){(0,s.Z)(h,t);var e,n,d=(e=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=(0,c.Z)(e);if(n){var r=(0,c.Z)(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return(0,o.Z)(this,t)});function h(t){var e;return(0,i.Z)(this,h),(e=d.call(this,t)).state.value=void 0===t.param?new Date(0):new Date(t.param.getValue().toString()),e.state.title=void 0===t.title?"":t.title,e.state.titleAlign=void 0===t.titleAlign?"left":t.titleAlign,e.state.showClearButton=void 0!==t.showClearButton&&t.showClearButton,e.state.pickerType=void 0===t.pickerType?"calendar":t.pickerType,e.state.type=void 0===t.type?"date":t.type,e.state.editorOptions=void 0===t.editorOptions?void 0:t.editorOptions,e._onValueChanged=e._onValueChanged.bind((0,a.Z)(e)),e._onEnterKey=e._onEnterKey.bind((0,a.Z)(e)),e}return(0,r.Z)(h,[{key:"_onValueChanged",value:function(t){this.value=t.value,void 0!==this.props.onValueChanged&&this.props.onValueChanged()}},{key:"_onEnterKey",value:function(){void 0!==this.props.onEnterKey&&this.props.onEnterKey()}},{key:"_dateView",value:function(){return l.createElement(u(),{id:this.props.id,showClearButton:this.state.showClearButton,pickerType:this.state.pickerType,height:"fit-content",valueChangeEvent:"keyup",value:"1970-01-01"==m()(this.state.value).format("YYYY-MM-DD")?null:m()(this.state.value),disabled:this.state.editable,type:this.state.type,dateSerializationFormat:"yyyy-MM-dd HH:mm",editorOptions:this.state.editorOptions,onEnterKey:this._onEnterKey,onValueChanged:this._onValueChanged},this.props.children,this.validationView())}},{key:"value",get:function(){return null==this.state.value?new Date(0):this.state.value},set:function(t){var e=this;if(void 0!==t&&null!=t||(t="1970-01-01"),void 0!==this.props.dt&&void 0!==this.props.dt.data&&this.props.dt.data.length>0&&void 0!==this.props.dt.field)if(void 0===this.props.dt.filter)void 0!==this.props.dt.row&&void 0!==this.props.dt.data.find((function(t){return t===e.props.dt.row}))?this.props.dt.data.find((function(t){return t===e.props.dt.row}))[this.props.dt.field]=t:this.props.dt.data[this.props.dt.data.length-1][this.props.dt.field]=t;else{var n=this.props.dt.data.where(this.props.dt.filter);n.length>0&&(void 0!==this.props.dt.row&&void 0!==n.find((function(t){return t===e.props.dt.row}))?n.find((function(t){return t===e.props.dt.row}))[this.props.dt.field]=t:n[n.length-1][this.props.dt.field]=t)}this.setState({value:t})}},{key:"render",value:function(){return 0==this.state.visible?l.createElement("div",null):void 0!==this.props.simple&&this.props.simple?this._dateView():void 0===this.state.title?l.createElement("div",{className:"dx-field"},this._dateView()):void 0===this.state.titleAlign?l.createElement("div",{className:"dx-field"},l.createElement("div",{className:"dx-field-label",style:{textAlign:"right"}},this.state.title),this._dateView()):"top"==this.state.titleAlign?l.createElement("div",{className:"dx-field"},l.createElement("div",null,this.state.title),this._dateView()):"bottom"==this.state.titleAlign?l.createElement("div",{className:"dx-field"},this._dateView(),l.createElement("div",null,this.state.option.title)):"left"==this.state.titleAlign?l.createElement("div",{className:"dx-field"},l.createElement("div",{className:"dx-field-label",style:{textAlign:"right"}},this.state.title),this._dateView()):"right"==this.state.titleAlign?l.createElement("div",{className:"dx-field"},this._dateView(),l.createElement("div",{className:"dx-field-label",style:{float:"right",paddingLeft:"15px"}},this.state.title)):void 0}}]),h}(h.ZP)},5083:(t,e,n)=>{n.d(e,{ZP:()=>h});var i=n(15671),r=n(43144),a=n(97326),s=n(60136),o=n(82963),c=n(61120),l=n(67294),d=n(67497),u=n(20819);n(17276);var h=function(t){(0,s.Z)(h,t);var e,n,u=(e=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,i=(0,c.Z)(e);if(n){var r=(0,c.Z)(this).constructor;t=Reflect.construct(i,arguments,r)}else t=i.apply(this,arguments);return(0,o.Z)(this,t)});function h(t){var e;return(0,i.Z)(this,h),(e=u.call(this,t)).dev=null,e.state.value=void 0!==t.value?t.value:0,e.state.title=void 0===t.title?"":t.title,e.state.titleAlign=void 0===t.titleAlign?"left":t.titleAlign,e.state.showClearButton=void 0!==t.showClearButton&&t.showClearButton,e.state.readOnly=void 0!==t.readOnly&&t.readOnly,e._onInitialized=e._onInitialized.bind((0,a.Z)(e)),e._onValueChanged=e._onValueChanged.bind((0,a.Z)(e)),e._onEnterKey=e._onEnterKey.bind((0,a.Z)(e)),e._onFocusIn=e._onFocusIn.bind((0,a.Z)(e)),e._onFocusOut=e._onFocusOut.bind((0,a.Z)(e)),e._onChange=e._onChange.bind((0,a.Z)(e)),e}return(0,r.Z)(h,[{key:"_onInitialized",value:function(t){this.dev=t.component}},{key:"_onValueChanged",value:function(t){this.value=t.value,void 0!==this.props.onValueChanged&&this.props.onValueChanged(t)}},{key:"_onEnterKey",value:function(){void 0!==this.props.onEnterKey&&this.props.onEnterKey()}},{key:"_onFocusIn",value:function(t){void 0!==this.props.selectAll&&1!=this.props.selectAll||this.dev.element().getElementsByTagName("input")[1].select(),void 0!==this.props.onFocusIn&&this.props.onFocusIn(t)}},{key:"_onFocusOut",value:function(){void 0!==this.props.onFocusOut&&this.props.onFocusOut()}},{key:"_onChange",value:function(){void 0!==this.props.onChange&&this.props.onChange()}},{key:"_txtView",value:function(){return l.createElement(d.NumberBox,{showClearButton:this.state.showClearButton,height:"fit-content",elementAttr:this.props.elementAttr,style:this.props.style,valueChangeEvent:"keyup",onValueChanged:this._onValueChanged,onEnterKey:this._onEnterKey,onFocusIn:this._onFocusIn,onFocusOut:this._onFocusOut,onChange:this._onChange,value:this.state.value,readOnly:this.state.readOnly,onInitialized:this._onInitialized,disabled:void 0===this.props.editable?this.state.editable:this.props.editable,showSpinButtons:this.props.showSpinButtons,step:this.props.step,format:this.props.format},this.props.children,this.validationView())}},{key:"value",get:function(){return this.state.value},set:function(t){var e=this;if(void 0!==t){if(void 0!==this.props.dt&&void 0!==this.props.dt.data&&this.props.dt.data.length>0&&void 0!==this.props.dt.field)if(void 0===this.props.dt.filter)void 0!==this.props.dt.row&&void 0!==this.props.dt.data.find((function(t){return t===e.props.dt.row}))?this.props.dt.data.find((function(t){return t===e.props.dt.row}))[this.props.dt.field]=t:this.props.dt.data[this.props.dt.data.length-1][this.props.dt.field]=t;else{var n=this.props.dt.data.where(this.props.dt.filter);n.length>0&&(void 0!==this.props.dt.row&&void 0!==n.find((function(t){return t===e.props.dt.row}))?n.find((function(t){return t===e.props.dt.row}))[this.props.dt.field]=t:n[n.length-1][this.props.dt.field]=t)}this.setState({value:t})}}},{key:"readOnly",get:function(){return this.state.readOnly},set:function(t){this.setState({readOnly:t})}},{key:"focus",value:function(){this.dev.focus()}},{key:"render",value:function(){return 0==this.state.visible?l.createElement("div",null):void 0!==this.props.simple&&this.props.simple?this._txtView():""==this.state.title?l.createElement("div",{className:"dx-field"},this._txtView()):void 0===this.state.titleAlign?l.createElement("div",{className:"dx-field"},l.createElement("div",{className:"dx-field-label",style:{textAlign:"right"}},this.state.title),this._txtView()):"top"==this.state.titleAlign?l.createElement("div",{className:"dx-field"},l.createElement("div",null,this.state.title),this._txtView()):"bottom"==this.state.titleAlign?l.createElement("div",{className:"dx-field"},this._txtView(),l.createElement("div",null,this.state.option.title)):"left"==this.state.titleAlign?l.createElement("div",{className:"dx-field"},l.createElement("div",{className:"dx-field-label",style:{textAlign:"right"}},this.state.title),this._txtView()):"right"==this.state.titleAlign?l.createElement("div",{className:"dx-field"},this._txtView(),l.createElement("div",{className:"dx-field-label",style:{float:"right",paddingLeft:"15px"}},this.state.title)):void 0}}]),h}(u.ZP)},36525:(t,e,n)=>{n.r(e),n.d(e,{default:()=>_});var i=n(4942),r=n(15861),a=n(15671),s=n(43144),o=n(97326),c=n(60136),l=n(82963),d=n(61120),u=n(64687),h=n.n(u),p=n(67294),m=n(85107),E=n(4598),f=(n(30381),n(42866)),O=n.n(f),b=(n(53221),n(25552)),g=n.n(b),v=(n(41226),n(91686),n(30886),n(99846)),x=n(5083),C=n(99077),T=n(55585),y=n(417),D=n(32175),w=n(18405),A=n(73682),S=n(90428),I=n(60547),R=n(17276);function N(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function U(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?N(Object(n),!0).forEach((function(e){(0,i.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n(9279),n(82048);var _=function(t){(0,c.Z)(B,t);var e,n,i,u,f,N,_,P,k,M,F,V=(M=B,F=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=(0,d.Z)(M);if(F){var n=(0,d.Z)(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return(0,l.Z)(this,t)});function B(){var t;return(0,a.Z)(this,B),(t=V.call(this)).state={tbMain:"visible",tbBarcode:"hidden",tbDocument:"hidden"},t.barcode={name:"",vat:0,barcode:"",code:"",guid:"00000000-0000-0000-0000-000000000000"},t.core=m.Z.instance.core,t.prmObj=t.param.filter({TYPE:1,USERS:t.user.CODE}),t.acsobj=t.access.filter({TYPE:1,USERS:t.user.CODE}),t.docObj=new E.Ch,t.itemCustomerObj=new R.$A,t.dropmenuMainItems=[t.t("btnNew"),t.t("btnSave")],t.dropmenuDocItems=[t.t("btnSave")],t.pageChange=t.pageChange.bind((0,o.Z)(t)),t.setBarcode=t.setBarcode.bind((0,o.Z)(t)),t._calculateTotal=t._calculateTotal.bind((0,o.Z)(t)),t.dropmenuClick=t.dropmenuClick.bind((0,o.Z)(t)),t.barcodeScan=t.barcodeScan.bind((0,o.Z)(t)),t}return(0,s.Z)(B,[{key:"componentDidMount",value:(k=(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.core.util.waitUntil(0);case 2:this.init();case 3:case"end":return t.stop()}}),t,this)}))),function(){return k.apply(this,arguments)})},{key:"init",value:(P=(0,r.Z)(h().mark((function t(){var e;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.docObj.clearAll(),(e=U({},this.docObj.empty)).TYPE=0,e.DOC_TYPE=60,this.docObj.addEmpty(e),this.txtCustomerCode.readOnly=!1,this.txtRef.readOnly=!1,this.txtRefno.readOnly=!1,this.txtRef.readOnly=!0,t.next=11,this.grdSlsOrder.dataRefresh({source:this.docObj.docOrders.dt("DOC_ORDERS")});case 11:return t.next=13,this.grdChkCustomer.dataRefresh({source:this.itemCustomerObj});case 13:case"end":return t.stop()}}),t,this)}))),function(){return P.apply(this,arguments)})},{key:"dropmenuClick",value:(_=(0,r.Z)(h().mark((function t(e){var n,i;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.itemData!=this.t("btnNew")){t.next=4;break}this.init(),t.next=23;break;case 4:if(e.itemData!=this.t("btnSave")){t.next=23;break}return n={id:"msgSave",showTitle:!0,title:this.t("msgSave.title"),showCloseButton:!0,width:"350px",height:"200px",button:[{id:"btn01",caption:this.t("msgSave.btn01"),location:"before"},{id:"btn02",caption:this.t("msgSave.btn02"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgSave.msg"))},t.next=8,(0,I.W)(n);case 8:if("btn01"!=t.sent){t.next=23;break}return i={id:"msgSaveResult",showTitle:!0,title:this.t("msgSave.title"),showCloseButton:!0,width:"350px",height:"200px",button:[{id:"btn01",caption:this.t("msgSave.btn01"),location:"after"}]},t.next=13,this.docObj.save();case 13:if(t.t0=t.sent,0!=t.t0){t.next=20;break}return i.content=p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgSaveResult.msgSuccess")),t.next=18,(0,I.W)(i);case 18:t.next=23;break;case 20:return i.content=p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgSaveResult.msgFailed")),t.next=23,(0,I.W)(i);case 23:case"end":return t.stop()}}),t,this)}))),function(t){return _.apply(this,arguments)})},{key:"getDoc",value:(N=(0,r.Z)(h().mark((function t(e,n,i){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.docObj.clearAll(),t.next=3,this.docObj.load({GUID:e,REF:n,REF_NO:i,TYPE:0,DOC_TYPE:60});case 3:this.txtRef.readOnly=!0,this.txtRefno.readOnly=!0;case 5:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return N.apply(this,arguments)})},{key:"pageChange",value:(f=(0,r.Z)(h().mark((function t(e){var n,i;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("Main"==e&&(this.setState({tbMain:"visible"}),this.setState({tbBarcode:"hidden"}),this.setState({tbDocument:"hidden"})),"Barcode"!=e){t.next=20;break}if(""!=this.cmbDepot.value){t.next=10;break}return n={id:"msgDepotSelect",showTitle:!0,title:this.t("msgDepotSelect.title"),showCloseButton:!0,width:"350px",height:"200px",button:[{id:"btn01",caption:this.t("msgDepotSelect.btn01"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgDepotSelect.msg"))},t.next=6,(0,I.W)(n);case 6:return t.sent,t.abrupt("return");case 10:if(""!=this.docObj.dt()[0].OUTPUT_CODE){t.next=16;break}return i={id:"msgCustomerSelect",showTitle:!0,title:this.t("msgCustomerSelect.title"),showCloseButton:!0,width:"350px",height:"200px",button:[{id:"btn01",caption:this.t("msgCustomerSelect.btn01"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgCustomerSelect.msg"))},t.next=14,(0,I.W)(i);case 14:return t.sent,t.abrupt("return");case 16:this.setState({tbMain:"hidden"}),this.setState({tbBarcode:"visible"}),this.setState({tbDocument:"hidden"}),this.txtBarcode.focus();case 20:"Document"==e&&(this.setState({tbMain:"hidden"}),this.setState({tbBarcode:"hidden"}),this.setState({tbDocument:"visible"}));case 21:case"end":return t.stop()}}),t,this)}))),function(t){return f.apply(this,arguments)})},{key:"barcodeScan",value:(u=(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:cordova.plugins.barcodeScanner.scan(function(){var t=(0,r.Z)(h().mark((function t(e){var n,i,r;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.cancelled){t.next=20;break}return this.txtBarcode.value=e.text,n={query:"SELECT ITEM_CODE AS CODE,ITEM_NAME AS NAME,ITEM_GUID AS GUID,BARCODE, ISNULL((SELECT VAT FROM ITEMS WHERE ITEMS.GUID = ITEM_BARCODE_VW_01.ITEM_GUID),0) AS VAT FROM ITEM_BARCODE_VW_01  WHERE BARCODE = @BARCODE OR ITEM_CODE = @BARCODE ",param:["BARCODE:string|50"],value:[e.text]},t.next=5,this.core.sql.execute(n);case 5:if(!((i=t.sent).result.recordset.length>0)){t.next=15;break}this.barcode.name=i.result.recordset[0].NAME,this.barcode.barcode=i.result.recordset[0].BARCODE,this.barcode.code=i.result.recordset[0].CODE,this.barcode.guid=i.result.recordset[0].GUID,this.barcode.vat=i.result.recordset[0].VAT,this.setBarcode(),t.next=20;break;case 15:return r={id:"msgBarcodeNotFound",showTitle:!0,title:this.t("msgBarcodeNotFound.title"),showCloseButton:!0,width:"350px",height:"200px",button:[{id:"btn01",caption:this.t("msgBarcodeNotFound.btn01"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgBarcodeNotFound.msg"))},t.next=18,(0,I.W)(r);case 18:this.txtBarcode.value="",document.getElementById("Sound").play();case 20:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}().bind(this),(function(t){}),{prompt:"Scan",orientation:"portrait"});case 1:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"setBarcode",value:(i=(0,r.Z)(h().mark((function t(){var e,n,i,a,s,o,c=this;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.itemCustomerObj.clear(),this.txtQuantity.value=1,e={query:"SELECT MULTICODE,CUSTOMER_PRICE AS PRICE FROM ITEM_MULTICODE_VW_01 WHERE ITEM_CODE = @ITEM_CODE AND CUSTOMER_GUID = @CUSTOMER_GUID",param:["ITEM_CODE:string|50","CUSTOMER_GUID:string|50"],value:[this.barcode.code,this.docObj.dt()[0].OUTPUT]},t.next=5,this.core.sql.execute(e);case 5:if(0!=(n=t.sent).result.recordset.length){t.next=14;break}return i={id:"msgCustomerNotFound",showTitle:!0,title:this.t("msgCustomerNotFound.title"),showCloseButton:!0,width:"350px",height:"200px",button:[{id:"btn01",caption:this.t("msgCustomerNotFound.btn01"),location:"before"},{id:"btn02",caption:this.t("msgCustomerNotFound.btn02"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgCustomerNotFound.msg"))},t.next=10,(0,I.W)(i);case 10:if("btn02"!=t.sent){t.next=14;break}return this.barcodeReset(),t.abrupt("return");case 14:if(!(n.result.recordset.length>0)){t.next=26;break}return this.txtPrice.value=parseFloat(n.result.recordset[0].PRICE.toFixed(2)),this.txtVat.value=parseFloat((n.result.recordset[0].PRICE*(this.barcode.vat/100)).toFixed(2)),this.txtAmount.value=parseFloat((Number(this.txtPrice.value)+Number(this.txtVat.value)).toFixed(2)),a={query:"SELECT CUSTOMER_PRICE AS PRICE,SUBSTRING(CUSTOMER_NAME, 1,10) AS CUSTOMER,CUSTOMER_PRICE_DATE AS PRICE_DATE FROM ITEM_MULTICODE_VW_01 WHERE ITEM_CODE = @ITEM_CODE",param:["ITEM_CODE:string|50","CUSTOMER_GUID:string|50"],value:[this.barcode.code,this.docObj.dt()[0].OUTPUT]},t.next=21,this.core.sql.execute(a);case 21:if(!((s=t.sent).result.recordset.length>1)){t.next=26;break}for(o=0;o<s.result.recordset.length;o++)this.itemCustomerObj.push(s.result.recordset[o]);return t.next=26,this.popUnderPrice.show().then(function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 26:if(1!=this.chkAutoAdd.value){t.next=32;break}return setTimeout((0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:c.txtPopQuantity.focus();case 1:case"end":return t.stop()}}),t)}))),700),t.next=30,this.msgQuantity.show().then(function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"btn01"==e&&c.addItem(c.txtPopQuantity.value);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 30:t.next=33;break;case 32:this.txtQuantity.focus();case 33:this.setState({tbBarcode:"visible"});case 34:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"barcodeReset",value:function(){0==this.chkAutoAdd.value&&(this.barcode={name:"",vat:0,barcode:"",code:"",guid:"00000000-0000-0000-0000-000000000000"}),this.txtBarcode.value="",this.txtAmount.value=0,this.txtVat.value=0,this.txtQuantity.value=0,this.txtPrice.value=0,this.setState({tbBarcode:"visible"}),this.txtBarcode.focus()}},{key:"addItem",value:(n=(0,r.Z)(h().mark((function t(e){var n,i,r,a;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e=1),""!=this.txtBarcode.value){t.next=7;break}return n={id:"msgBarcodeCheck",showTitle:!0,title:this.t("msgBarcodeCheck.title"),showCloseButton:!0,width:"350px",height:"200px",button:[{id:"btn01",caption:this.t("msgBarcodeCheck.btn01"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgBarcodeCheck.msg"))},t.next=5,(0,I.W)(n);case 5:return t.sent,t.abrupt("return");case 7:i=0;case 8:if(!(i<this.docObj.docOrders.dt().length)){t.next=28;break}if(this.docObj.docOrders.dt()[i].ITEM_CODE!=this.barcode.code){t.next=25;break}return r={id:"msgCombineItem",showTitle:!0,title:this.t("msgCombineItem.title"),showCloseButton:!0,width:"350px",height:"200px",button:[{id:"btn01",caption:this.t("msgCombineItem.btn01"),location:"before"},{id:"btn02",caption:this.t("msgCombineItem.btn02"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgCombineItem.msg"))},t.next=13,(0,I.W)(r);case 13:if("btn01"!=t.sent){t.next=24;break}return this.docObj.docOrders.dt()[i].QUANTITY=this.docObj.docOrders.dt()[i].QUANTITY+e,this.docObj.docOrders.dt()[i].VAT=parseFloat((this.docObj.docOrders.dt()[i].VAT+this.docObj.docOrders.dt()[i].PRICE*(this.docObj.docOrders.dt()[i].VAT_RATE/100)*e).toFixed(3)),this.docObj.docOrders.dt()[i].AMOUNT=parseFloat((this.docObj.docOrders.dt()[i].QUANTITY*this.docObj.docOrders.dt()[i].PRICE).toFixed(3)),this.docObj.docOrders.dt()[i].TOTAL=parseFloat((this.docObj.docOrders.dt()[i].QUANTITY*this.docObj.docOrders.dt()[i].PRICE-this.docObj.docOrders.dt()[i].DISCOUNT+this.docObj.docOrders.dt()[i].VAT).toFixed(3)),this._calculateTotal(),this.barcodeReset(),t.abrupt("return");case 24:return t.abrupt("break",28);case 25:i++,t.next=8;break;case 28:return(a=U({},this.docObj.docOrders.empty)).REF=this.docObj.dt()[0].REF,a.REF_NO=this.docObj.dt()[0].REF_NO,a.ITEM_NAME=this.barcode.name,a.ITEM_CODE=this.barcode.code,a.ITEM=this.barcode.guid,a.DOC_GUID=this.docObj.dt()[0].GUID,a.TYPE=this.docObj.dt()[0].TYPE,a.DOC_TYPE=this.docObj.dt()[0].DOC_TYPE,a.LINE_NO=this.docObj.docOrders.dt().length,a.REF=this.docObj.dt()[0].REF,a.REF_NO=this.docObj.dt()[0].REF_NO,a.INPUT=this.docObj.dt()[0].INPUT,a.OUTPUT=this.docObj.dt()[0].OUTPUT,a.DOC_DATE=this.docObj.dt()[0].DOC_DATE,a.QUANTITY=e,a.VAT_RATE=this.barcode.vat,a.PRICE=this.txtPrice.value,a.VAT=(this.txtVat.value*e).toFixed(2),a.AMOUNT=(this.txtPrice.value*e).toFixed(2),a.TOTAL=parseFloat(this.txtPrice.value*e+this.txtVat.value*e).toFixed(2),this.docObj.docOrders.addEmpty(a),this.barcodeReset(),this._calculateTotal(),t.next=54,this.docObj.save();case 54:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"calculateItemPrice",value:function(){this.txtVat.value=parseFloat((this.txtPrice.value*(this.barcode.vat/100)*this.txtQuantity.value).toFixed(2)),this.txtAmount.value=parseFloat(this.txtPrice.value*this.txtQuantity.value+this.txtVat.value).toFixed(2)}},{key:"_calculateTotal",value:(e=(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.docObj.dt()[0].AMOUNT=this.docObj.docOrders.dt().sum("AMOUNT",2),this.docObj.dt()[0].DISCOUNT=this.docObj.docOrders.dt().sum("DISCOUNT",2),this.docObj.dt()[0].VAT=this.docObj.docOrders.dt().sum("VAT",2),this.docObj.dt()[0].TOTAL=this.docObj.docOrders.dt().sum("TOTAL",2);case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"render",value:function(){var t,e,n,i,a,s=this;return p.createElement(O(),null,p.createElement("div",null,p.createElement("div",{className:"row px-1 pt-1"},p.createElement("div",{className:"row px-1 pt-1",style:{visibility:this.state.tbMain,position:"absolute"}},p.createElement(g(),{colCount:1},p.createElement(b.Item,null,p.createElement(b.Label,{text:this.t("txtRefRefno"),alignment:"right"}),p.createElement("div",{className:"row"},p.createElement("div",{className:"col-4 pe-0"},p.createElement(v.ZP,{id:"txtRef",parent:this,simple:!0,dt:{data:this.docObj.dt("DOC"),field:"REF"},upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,readOnly:!0,maxLength:32,onChange:(0,r.Z)(h().mark((function t(){var e,n;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={query:"SELECT ISNULL(MAX(REF_NO) + 1,1) AS REF_NO FROM DOC WHERE TYPE = 0 AND DOC_TYPE = 60 AND REF = @REF ",param:["REF:string|25"],value:[s.txtRef.value]},t.next=3,s.core.sql.execute(e);case 3:(n=t.sent).result.recordset.length>0&&(s.txtRefno.value=n.result.recordset[0].REF_NO);case 5:case"end":return t.stop()}}),t)}))).bind(this),param:this.param.filter({ELEMENT:"txtRef",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtRef",USERS:this.user.CODE})},p.createElement(v.cX,{validationGroup:"frmLabelQeueu"},p.createElement(v.n2,{message:this.t("validRef")})))),p.createElement("div",{className:"col-8 ps-0"},p.createElement(v.ZP,{id:"txtRefno",parent:this,simple:!0,dt:{data:this.docObj.dt("DOC"),field:"REF_NO"},upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,readOnly:!0,button:[{id:"01",icon:"more",onClick:(a=(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.pg_Docs.show(),s.pg_Docs.onClick=function(t){t.length>0&&s.getDoc(t[0].GUID,t[0].REF,t[0].REF_NO)};case 2:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})},{id:"02",icon:"arrowdown",onClick:function(){s.txtRefno.value=Math.floor(Date.now()/1e3)}},{id:"03",icon:"revert",onClick:function(){s.init()}}],onChange:(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.checkDoc("00000000-0000-0000-0000-000000000000",s.txtRef.value,s.txtRefno.value);case 2:3==t.sent&&(s.txtRefno.value="");case 4:case"end":return t.stop()}}),t)}))).bind(this),param:this.param.filter({ELEMENT:"txtRefno",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtRefno",USERS:this.user.CODE})},p.createElement(v.cX,{validationGroup:"frmLabelQeueu"},p.createElement(v.n2,{message:this.t("validRefNo")}))))),p.createElement(y.Z,{id:"pg_Docs",parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,headerFilter:{visible:!1},width:"90%",height:"90%",selection:{mode:"single"},title:this.t("pg_Docs.title"),data:{source:{select:{query:"SELECT GUID,REF,REF_NO,OUTPUT_CODE,OUTPUT_NAME FROM DOC_VW_01 WHERE TYPE = 0 AND DOC_TYPE = 60 AND REBATE = 0 AND DOC_DATE > GETDATE() - 30"},sql:this.core.sql}},button:[{id:"01",icon:"more",onClick:function(){}}]},p.createElement(w.sg,{dataField:"REF_NO",caption:this.t("pg_Docs.clmRefNo"),width:100,defaultSortOrder:"asc"}),p.createElement(w.sg,{dataField:"OUTPUT_NAME",caption:this.t("pg_Docs.clmOutputName"),width:150,defaultSortOrder:"asc"}),p.createElement(w.sg,{dataField:"OUTPUT_CODE",caption:this.t("pg_Docs.clmOutputCode"),width:150,defaultSortOrder:"asc"}))),p.createElement(b.Item,null,p.createElement(b.Label,{text:this.t("txtDepot"),alignment:"right"}),p.createElement(C.ZP,{simple:!0,parent:this,id:"cmbDepot",notRefresh:!0,dt:{data:this.docObj.dt("DOC"),field:"INPUT"},displayExpr:"NAME",valueExpr:"GUID",value:"",searchEnabled:!0,onValueChanged:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}().bind(this),data:{source:{select:{query:"SELECT * FROM DEPOT_VW_01"},sql:this.core.sql}},param:this.param.filter({ELEMENT:"cmbDepot",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"cmbDepot",USERS:this.user.CODE})})),p.createElement(b.Item,null,p.createElement(b.Label,{text:this.t("txtCustomerCode"),alignment:"right"}),p.createElement("div",{className:"row"},p.createElement("div",{className:"col-12"},p.createElement(v.ZP,{id:"txtCustomerCode",parent:this,simple:!0,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,dt:{data:this.docObj.dt("DOC"),field:"OUTPUT_CODE"},onEnterKey:(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.pg_CustomerSelect.setVal(s.txtCustomerCode.value);case 2:s.pg_CustomerSelect.show(),s.pg_CustomerSelect.onClick=function(t){if(t.length>0){s.docObj.dt()[0].OUTPUT=t[0].GUID,s.docObj.dt()[0].OUTPUT_CODE=t[0].CODE,s.docObj.dt()[0].OUTPUT_NAME=t[0].TITLE;var e=s.sysParam.filter({ID:"refForCustomerCode",USERS:s.user.CODE}).getValue();void 0!==e&&1==e.value&&(s.txtRef.value=t[0].CODE,s.txtRef.props.onChange())}};case 4:case"end":return t.stop()}}),t)}))).bind(this),button:[{id:"01",icon:"more",onClick:(i=(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log(111111),s.pg_CustomerSelect.show(),s.pg_CustomerSelect.onClick=function(t){if(t.length>0){console.log(s.docObj.dt()),s.docObj.dt()[0].OUTPUT=t[0].GUID,s.docObj.dt()[0].OUTPUT_CODE=t[0].CODE,s.docObj.dt()[0].OUTPUT_NAME=t[0].TITLE;var e=s.sysParam.filter({ID:"refForCustomerCode",USERS:s.user.CODE}).getValue();console.log(s.txtCustomerCode),void 0!==e&&1==e.value&&(s.txtRef.value=t[0].CODE,s.txtRef.props.onChange())}};case 3:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{id:"02",icon:"arrowdown",onClick:function(){}}],onChange:(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))).bind(this),param:this.param.filter({ELEMENT:"txtCustomerCode",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtCustomerCode",USERS:this.user.CODE})}))),p.createElement(y.Z,{id:"pg_CustomerSelect",parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,headerFilter:{visible:!1},width:"90%",height:"90%",selection:{mode:"single"},title:this.t("pg_CustomerSelect.title"),search:!0,data:{source:{select:{query:"SELECT GUID,CODE,TITLE,NAME,LAST_NAME,[TYPE_NAME],[GENUS_NAME] FROM CUSTOMER_VW_01 WHERE UPPER(CODE) LIKE UPPER(@VAL) OR UPPER(TITLE) LIKE UPPER(@VAL)",param:["VAL:string|50"]},sql:this.core.sql}}},p.createElement(w.sg,{dataField:"CODE",caption:this.t("pg_CustomerSelect.clmCode"),width:150}),p.createElement(w.sg,{dataField:"TITLE",caption:this.t("pg_CustomerSelect.clmTitle"),width:200,defaultSortOrder:"asc"}),p.createElement(w.sg,{dataField:"TYPE_NAME",caption:this.t("pg_CustomerSelect.clmTypeName"),width:100}),p.createElement(w.sg,{dataField:"GENUS_NAME",caption:this.t("pg_CustomerSelect.clmGenusName"),width:100,filterValues:["Tedarikçi","Her Ikisi"]}))),p.createElement(b.Item,null,p.createElement(b.Label,{text:this.t("txtCustomerName"),alignment:"right"}),p.createElement(v.ZP,{id:"txtCustomerName",parent:this,simple:!0,readOnly:!0,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,dt:{data:this.docObj.dt("DOC"),field:"OUTPUT_NAME"},param:this.param.filter({ELEMENT:"txtCustomerName",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtCustomerName",USERS:this.user.CODE})})),p.createElement(b.Item,null,p.createElement(b.Label,{text:this.t("txtDate"),alignment:"right"}),p.createElement(S.ZP,{simple:!0,parent:this,id:"dtDocDate",pickerType:"rollers",dt:{data:this.docObj.dt("DOC"),field:"DOC_DATE"},onValueChanged:(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))).bind(this)},p.createElement(v.cX,{validationGroup:"frmslsDoc"},p.createElement(v.n2,{message:this.t("validDocDate")})))),p.createElement(b.Item,null,p.createElement("div",{className:"row"},p.createElement("div",{className:"col-6 px-2 pt-2"},p.createElement(A.Z,{text:this.t("btnBarcodeEntry"),type:"default",width:"100%",onClick:function(){return s.pageChange("Barcode")}})),p.createElement("div",{className:"col-6 px-2 pt-2"},p.createElement(A.Z,{text:this.t("btnDocument"),type:"default",width:"100%",onClick:function(){return s.pageChange("Document")}})))))),p.createElement("div",{className:"row px-1 pt-1",style:{visibility:this.state.tbBarcode,position:"absolute"}},p.createElement(g(),{colCount:1},p.createElement(b.Item,null,p.createElement("div",{className:"row",style:{height:"25px"}},p.createElement("div",{className:"col-4 px-1 pt-1"},p.createElement(A.Z,{icon:"arrowleft",type:"default",width:"100%",onClick:function(){return s.pageChange("Main")}})),p.createElement("div",{className:"col-4 px-1 pt-1"},p.createElement(A.Z,{icon:"detailslayout",type:"default",width:"100%",onClick:function(){return s.pageChange("Document")}})),p.createElement("div",{className:"col-4 px-1 pt-1"},p.createElement(T.ZP,{id:"chkAutoAdd",text:this.t("chkAutoAdd"),parent:this,defaultValue:!0,value:!0,param:this.param.filter({ELEMENT:"chkAutoAdd",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"chkAutoAdd",USERS:this.user.CODE})})))),p.createElement(b.Item,null,p.createElement("div",{className:"col-12 px-2 pt-2"},p.createElement(v.ZP,{id:"txtBarcode",parent:this,placeholder:this.t("txtBarcodePlace"),button:[{id:"01",icon:"more",onClick:(n=(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.popItemCode.show(),s.popItemCode.onClick=function(){var t=(0,r.Z)(h().mark((function t(e){var n,i;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1!=e.length){t.next=8;break}return s.txtBarcode.value=e[0].CODE,s.barcode={name:e[0].NAME,code:e[0].CODE,barcode:e[0].BARCODE,guid:e[0].GUID,vat:e[0].VAT},t.next=5,s.setBarcode();case 5:s.setState({tbBarcode:"visible"}),t.next=23;break;case 8:if(!(e.length>1)){t.next=23;break}n=0;case 10:if(!(n<e.length)){t.next=20;break}return s.txtBarcode.value=e[n].CODE,s.barcode={name:e[n].NAME,code:e[n].CODE,barcode:e[n].BARCODE,guid:e[0].GUID,vat:e[0].VAT},t.next=15,s.setBarcode();case 15:return t.next=17,s.addItem();case 17:n++,t.next=10;break;case 20:return i={id:"msgItemsAdd",showTitle:!0,title:s.t("msgItemsAdd.title"),showCloseButton:!0,width:"350px",height:"200px",button:[{id:"btn01",caption:s.t("msgItemsAdd.btn01"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},s.t("msgItemsAdd.msg"))},t.next=23,(0,I.W)(i);case 23:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();case 2:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{id:"02",icon:"photo",onClick:(e=(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.barcodeScan();case 1:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})}],onKeyUp:function(){var t=(0,r.Z)(h().mark((function t(e){var n,i,r;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log(e),"Enter"!=e.event.key){t.next=22;break}if(""!=e.component._changedValue){t.next=4;break}return t.abrupt("return");case 4:return n={query:"SELECT ITEM_CODE AS CODE,ITEM_NAME AS NAME,ITEM_GUID AS GUID,BARCODE, ISNULL((SELECT VAT FROM ITEMS WHERE ITEMS.GUID = ITEM_BARCODE_VW_01.ITEM_GUID),0) AS VAT FROM ITEM_BARCODE_VW_01  WHERE BARCODE = @BARCODE OR ITEM_CODE = @BARCODE ",param:["BARCODE:string|50"],value:[e.component._changedValue]},t.next=7,s.core.sql.execute(n);case 7:if(!((i=t.sent).result.recordset.length>0)){t.next=17;break}s.barcode.name=i.result.recordset[0].NAME,s.barcode.barcode=i.result.recordset[0].BARCODE,s.barcode.code=i.result.recordset[0].CODE,s.barcode.guid=i.result.recordset[0].GUID,s.barcode.vat=i.result.recordset[0].VAT,s.setBarcode(),t.next=22;break;case 17:return r={id:"msgBarcodeNotFound",showTitle:!0,title:s.t("msgBarcodeNotFound.title"),showCloseButton:!0,width:"350px",height:"200px",button:[{id:"btn01",caption:s.t("msgBarcodeNotFound.btn01"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},s.t("msgBarcodeNotFound.msg"))},t.next=20,(0,I.W)(r);case 20:s.txtBarcode.value="",document.getElementById("Sound").play();case 22:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}().bind(this)}))),p.createElement(b.Item,null,p.createElement("div",null,p.createElement("h4",{className:"text-center"},this.barcode.name))),p.createElement(b.Item,null,p.createElement(b.Label,{text:this.t("txtQuantity")}),p.createElement(x.ZP,{id:"txtQuantity",parent:this,simple:!0,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,param:this.param.filter({ELEMENT:"txtQuantity",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtQuantity",USERS:this.user.CODE}),onValueChanged:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.calculateItemPrice();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}().bind(this),onEnterKey:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.addItem();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}().bind(this)})),p.createElement(b.Item,null,p.createElement(b.Label,{text:this.t("txtPrice"),alignment:"right"}),p.createElement(x.ZP,{id:"txtPrice",parent:this,simple:!0,param:this.param.filter({ELEMENT:"txtPrice",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtPrice",USERS:this.user.CODE}),onValueChanged:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.calculateItemPrice();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}().bind(this),onEnterKey:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.addItem();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}().bind(this)})),p.createElement(b.Item,null,p.createElement(b.Label,{text:this.t("txtVat"),alignment:"right"}),p.createElement(v.ZP,{id:"txtVat",parent:this,simple:!0,readOnly:!0,param:this.param.filter({ELEMENT:"txtVat",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtVat",USERS:this.user.CODE})})),p.createElement(b.Item,null,p.createElement(b.Label,{text:this.t("txtAmount"),alignment:"right"}),p.createElement(v.ZP,{id:"txtAmount",parent:this,simple:!0,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,readOnly:!0,param:this.param.filter({ELEMENT:"txtAmount",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtAmount",USERS:this.user.CODE})})),p.createElement(b.Item,null,p.createElement("div",{className:"row"},p.createElement("div",{className:"col-12 px-1 pt-1"},p.createElement(A.Z,{text:this.t("btnItemAdd"),type:"default",width:"100%",onClick:function(){return s.addItem(s.txtQuantity.value)}})))))),p.createElement("div",{className:"row",style:{visibility:this.state.tbDocument,position:"absolute"}},p.createElement(g(),{colCount:1},p.createElement(b.Item,null,p.createElement("div",{className:"row",style:{height:"25px"}},p.createElement("div",{className:"col-4 px-1 pt-1"},p.createElement(A.Z,{icon:"arrowleft",type:"default",width:"100%",onClick:function(){return s.pageChange("Main")}})),p.createElement("div",{className:"col-4 px-1 pt-1"},p.createElement(A.Z,{icon:"plus",type:"default",width:"100%",onClick:function(){return s.pageChange("Barcode")}})),p.createElement("div",{className:"col-4"}))),p.createElement(b.Item,null,p.createElement(w.ZP,{parent:this,id:"grdSlsOrder",showBorders:!0,columnsAutoWidth:!0,allowColumnReordering:!0,allowColumnResizing:!0,headerFilter:{visible:!1},height:"350",width:"100%",dbApply:!1,onRowUpdated:function(){var t=(0,r.Z)(h().mark((function t(e){var n,i,r,a,o,c,l;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==e.data.DISCOUNT_RATE&&(e.key.DISCOUNT=parseFloat((e.key.AMOUNT*e.data.DISCOUNT_RATE/100).toFixed(2))),!(e.key.COST_PRICE>e.key.PRICE)){t.next=18;break}if(void 0===(n=s.acsobj.filter({ID:"underMinCostPrice",USERS:s.user.CODE}).getValue())||1!=n){t.next=15;break}return i={id:"msgUnderPrice1",showTitle:!0,title:s.t("msgUnderPrice1.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:s.t("msgUnderPrice1.btn01"),location:"before"},{id:"btn02",caption:s.t("msgUnderPrice1.btn02"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},s.t("msgUnderPrice1.msg"))},t.next=7,(0,I.W)(i);case 7:if("btn01"!=(r=t.sent)){t.next=11;break}t.next=13;break;case 11:if("btn02"!=r){t.next=13;break}return t.abrupt("return");case 13:t.next=18;break;case 15:return a={id:"msgUnderPrice2",showTitle:!0,title:"Uyarı",showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:s.t("msgUnderPrice2.btn01"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},"msgUnderPrice2.msg")},(0,I.W)(a),t.abrupt("return");case 18:if(!(e.key.DISCOUNT>e.key.PRICE*e.key.QUANTITY)){t.next=23;break}return o={id:"msgDiscount",showTitle:!0,title:"Uyarı",showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:s.t("msgDiscount.btn01"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},s.t("msgDiscount.msg"))},(0,I.W)(o),e.key.DISCOUNT=0,t.abrupt("return");case 23:return e.key.VAT>0&&(e.key.VAT=parseFloat(((e.key.PRICE*e.key.QUANTITY-e.key.DISCOUNT)*e.key.VAT_RATE/100).toFixed(2))),e.key.AMOUNT=parseFloat((e.key.PRICE*e.key.QUANTITY).toFixed(2)),e.key.TOTAL=parseFloat((e.key.PRICE*e.key.QUANTITY-e.key.DISCOUNT+e.key.VAT).toFixed(2)),c=e.key.TOTAL-e.key.VAT-e.key.COST_PRICE*e.key.QUANTITY,l=c/(e.key.TOTAL-e.key.VAT)*100,e.key.MARGIN=c.toFixed(2)+"€ / %"+l.toFixed(2),e.key.DISCOUNT>0&&(e.key.DISCOUNT_RATE=parseFloat((100-(e.key.PRICE*e.key.QUANTITY-e.key.DISCOUNT)/(e.key.PRICE*e.key.QUANTITY)*100).toFixed(2))),console.log(e.key.MARGIN),s._calculateTotal(),t.next=34,s.docObj.save();case 34:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),onContentReady:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.component.columnOption("command:edit","visibleIndex",-1);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),onRowRemoved:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s._calculateTotal(),t.next=3,s.docObj.save();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},p.createElement(w.m_,{editOnKeyPress:!0,enterKeyAction:"moveFocus",enterKeyDirection:"row"}),p.createElement(w.PY,{mode:"standart"}),p.createElement(w.Po,{defaultPageSize:10}),p.createElement(w.uE,{visible:!0,allowedPageSizes:[5,10,20,50,100],showPageSizeSelector:!0}),p.createElement(w.LO,{mode:"cell",allowUpdating:!0,allowDeleting:!0,confirmDelete:!1}),p.createElement(w.sg,{dataField:"ITEM_NAME",caption:this.t("grdSlsOrder.clmItemName"),width:150}),p.createElement(w.sg,{dataField:"QUANTITY",caption:this.t("grdSlsOrder.clmQuantity"),dataType:"number",width:40}),p.createElement(w.sg,{dataField:"PRICE",caption:this.t("grdSlsOrder.clmPrice"),dataType:"number",format:{style:"currency",currency:"EUR",precision:3},width:60}),p.createElement(w.sg,{dataField:"AMOUNT",caption:this.t("grdSlsOrder.clmAmount"),allowEditing:!1,format:{style:"currency",currency:"EUR",precision:3},width:80}),p.createElement(w.sg,{dataField:"DISCOUNT",caption:this.t("grdSlsOrder.clmDiscount"),dataType:"number",format:{style:"currency",currency:"EUR",precision:3},width:80}),p.createElement(w.sg,{dataField:"DISCOUNT_RATE",caption:this.t("grdSlsOrder.clmDiscountRate"),dataType:"number",width:80}),p.createElement(w.sg,{dataField:"VAT",caption:this.t("grdSlsOrder.clmVat"),format:{style:"currency",currency:"EUR",precision:3},allowEditing:!1,width:80}),p.createElement(w.sg,{dataField:"TOTAL",caption:this.t("grdSlsOrder.clmTotal"),format:{style:"currency",currency:"EUR",precision:3},allowEditing:!1,width:100})))),p.createElement("div",{className:"row px-1 pt-1"},p.createElement("div",{className:"col-12"},p.createElement(g(),{colCount:4,parent:this,id:"frmslsDoc"},p.createElement(b.Item,null,p.createElement(b.Label,{text:this.t("txtAmount"),alignment:"right"}),p.createElement(v.ZP,{id:"txtGrandAmount",parent:this,simple:!0,readOnly:!0,dt:{data:this.docObj.dt("DOC"),field:"AMOUNT"},maxLength:32})),p.createElement(b.Item,null,p.createElement(b.Label,{text:this.t("txtDiscount"),alignment:"right"}),p.createElement(v.ZP,{id:"txtGrandDiscount",parent:this,simple:!0,readOnly:!0,dt:{data:this.docObj.dt("DOC"),field:"DISCOUNT"},maxLength:32,button:[{id:"01",icon:"more",onClick:function(){s.docObj.dt()[0].DISCOUNT>0&&(s.txtDiscountPercent.value=parseFloat((100-(s.docObj.dt()[0].AMOUNT-s.docObj.dt()[0].DISCOUNT)/s.docObj.dt()[0].AMOUNT*100).toFixed(2)),s.txtDiscountPrice.value=s.docObj.dt()[0].DISCOUNT),s.popDiscount.show()}}]})),p.createElement(b.Item,null,p.createElement(b.Label,{text:this.t("txtVat"),alignment:"right"}),p.createElement(v.ZP,{id:"txtGrandVat",parent:this,simple:!0,readOnly:!0,dt:{data:this.docObj.dt("DOC"),field:"VAT"},maxLength:32,button:[{id:"01",icon:"clear",onClick:(t=(0,r.Z)(h().mark((function t(){var e,n;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={id:"msgVatDelete",showTitle:!0,title:s.t("msgVatDelete.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:s.t("msgVatDelete.btn01"),location:"before"},{id:"btn02",caption:s.t("msgSave.btn02"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},s.t("msgVatDelete.msg"))},t.next=3,(0,I.W)(e);case 3:if("btn01"==t.sent)for(n=0;n<s.docObj.docOrders.dt().length;n++)s.docObj.docOrders.dt()[n].VAT=0,s.docObj.docOrders.dt()[n].VAT_RATE=0,s.docObj.docOrders.dt()[n].TOTAL=s.docObj.docOrders.dt()[n].PRICE*s.docObj.docOrders.dt()[n].QUANTITY-s.docObj.docOrders.dt()[n].DISCOUNT,s._calculateTotal();case 5:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}]})),p.createElement(b.Item,null,p.createElement(b.Label,{text:this.t("txtGrandTotal"),alignment:"right"}),p.createElement(v.ZP,{id:"txtGrandTotal",parent:this,simple:!0,readOnly:!0,dt:{data:this.docObj.dt("DOC"),field:"TOTAL"},maxLength:32})))))),p.createElement(y.Z,{id:"popItemCode",parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,headerFilter:{visible:!1},width:"90%",height:"90%",title:this.t("popItemCode.title"),search:!0,selection:{mode:"single"},data:{source:{select:{query:"SELECT  *,  CASE WHEN UNDER_UNIT_VALUE =0  THEN 0 ELSE ROUND((PRICE * UNDER_UNIT_VALUE),2) END AS UNDER_UNIT_PRICE FROM  (  SELECT GUID,   CODE,   NAME,   VAT,   ISNULL((SELECT TOP 1 BARCODE FROM ITEM_BARCODE WHERE ITEM = ITEMS_VW_01.GUID ORDER BY CDATE DESC),'') AS BARCODE,   MAIN_GRP AS ITEM_GRP,   MAIN_GRP_NAME AS ITEM_GRP_NAME,   (SELECT [dbo].[FN_PRICE_SALE](GUID,1,GETDATE(),'00000000-0000-0000-0000-000000000000')) AS PRICE  , ISNULL((SELECT TOP 1 FACTOR FROM ITEM_UNIT WHERE TYPE = 1 AND ITEM_UNIT.ITEM = ITEMS_VW_01.GUID),0) AS UNDER_UNIT_VALUE FROM ITEMS_VW_01 WHERE ISNULL((SELECT TOP 1 BARCODE FROM ITEM_BARCODE WHERE ITEM = ITEMS_VW_01.GUID),'') <> '') AS TMP WHERE UPPER(CODE) LIKE UPPER(@VAL) OR UPPER(NAME) LIKE UPPER(@VAL) ",param:["VAL:string|50"]},sql:this.core.sql}}},p.createElement(w.sg,{dataField:"CODE",caption:this.t("popItemCode.clmCode"),width:100}),p.createElement(w.sg,{dataField:"NAME",caption:this.t("popItemCode.clmName"),defaultSortOrder:"asc"})),p.createElement("div",null,p.createElement(D.ZP,{parent:this,id:"popDiscount",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popDiscount.title"),container:"#root",width:"350",height:"250",position:{of:"#root"}},p.createElement(g(),{colCount:1,height:"fit-content"},p.createElement(b.Item,null,p.createElement(b.Label,{text:this.t("popDiscount.Percent"),alignment:"right"}),p.createElement(x.ZP,{id:"txtDiscountPercent",parent:this,simple:!0,maxLength:32,onValueChanged:(0,r.Z)(h().mark((function t(){var e;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(s.txtDiscountPercent.value>100)){t.next=7;break}return e={id:"msgDiscountPercent",showTitle:!0,title:s.t("msgDiscountPercent.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:s.t("msgDiscountPercent.btn01"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},s.t("msgDiscountPercent.msg"))},t.next=4,(0,I.W)(e);case 4:return s.txtDiscountPercent.value=0,s.txtDiscountPrice.value=0,t.abrupt("return");case 7:s.txtDiscountPrice.value=parseFloat((s.docObj.dt()[0].AMOUNT*s.txtDiscountPercent.value/100).toFixed(3));case 8:case"end":return t.stop()}}),t)}))).bind(this)})),p.createElement(b.Item,null,p.createElement(b.Label,{text:this.t("popDiscount.Price"),alignment:"right"}),p.createElement(x.ZP,{id:"txtDiscountPrice",parent:this,simple:!0,maxLength:32,onValueChanged:(0,r.Z)(h().mark((function t(){var e;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(s.txtDiscountPrice.value>s.docObj.dt()[0].AMOUNT)){t.next=7;break}return e={id:"msgDiscountPrice",showTitle:!0,title:s.t("msgDiscountPrice.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:s.t("msgDiscountPrice.btn01"),location:"after"}],content:p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},s.t("msgDiscountPrice.msg"))},t.next=4,(0,I.W)(e);case 4:return s.txtDiscountPercent.value=0,s.txtDiscountPrice.value=0,t.abrupt("return");case 7:s.txtDiscountPercent.value=parseFloat((100-(s.docObj.dt()[0].AMOUNT-s.txtDiscountPrice.value)/s.docObj.dt()[0].AMOUNT*100).toFixed(3));case 8:case"end":return t.stop()}}),t)}))).bind(this)})),p.createElement(b.Item,null,p.createElement("div",{className:"row"},p.createElement("div",{className:"col-6"},p.createElement(A.Z,{text:this.lang.t("btnSave"),type:"normal",stylingMode:"contained",width:"100%",onClick:(0,r.Z)(h().mark((function t(){var e;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=0;e<s.docObj.docOrders.dt().length;e++)s.docObj.docOrders.dt()[e].DISCOUNT_RATE=s.txtDiscountPercent.value,s.docObj.docOrders.dt()[e].DISCOUNT=parseFloat((s.docObj.docOrders.dt()[e].PRICE*s.docObj.docOrders.dt()[e].QUANTITY*s.txtDiscountPercent.value/100).toFixed(3)),s.docObj.docOrders.dt()[e].VAT>0&&(s.docObj.docOrders.dt()[e].VAT=parseFloat((s.docObj.docOrders.dt()[e].PRICE*s.docObj.docOrders.dt()[e].QUANTITY*(s.docObj.docOrders.dt()[e].VAT_RATE/100)).toFixed(3))),s.docObj.docOrders.dt()[e].TOTAL=parseFloat((s.docObj.docOrders.dt()[e].PRICE*s.docObj.docOrders.dt()[e].QUANTITY+s.docObj.docOrders.dt()[e].VAT-s.docObj.docOrders.dt()[e].DISCOUNT).toFixed(3));s._calculateTotal(),s.popDiscount.hide();case 3:case"end":return t.stop()}}),t)})))})),p.createElement("div",{className:"col-6"},p.createElement(A.Z,{text:this.lang.t("btnCancel"),type:"normal",stylingMode:"contained",width:"100%",onClick:function(){s.popDiscount.hide()}}))))))),p.createElement(I.Z,{id:"msgQuantity",container:"#root",parent:this,position:{of:"#root"},showTitle:!0,title:this.t("msgQuantity.title"),showCloseButton:!1,width:"350px",height:"250px",button:[{id:"btn01",caption:this.t("msgQuantity.btn01"),location:"after"}]},p.createElement("div",{className:"row"},p.createElement("div",{className:"col-12 py-2"},p.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgQuantity.msg"))),p.createElement("div",{className:"col-12 py-2"},p.createElement(g(),null,p.createElement(b.Item,null,p.createElement(b.Label,{text:this.t("txtQuantity"),alignment:"right"}),p.createElement(x.ZP,{id:"txtPopQuantity",parent:this,simple:!0,onEnterKey:(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s.addItem(s.txtPopQuantity.value),s.msgQuantity.hide();case 2:case"end":return t.stop()}}),t)}))).bind(this)}))))),p.createElement("div",{className:"row"})),p.createElement("div",null,p.createElement(I.Z,{parent:this,id:"popUnderPrice",showCloseButton:!0,showTitle:!0,title:this.t("popUnderPrice.title"),container:"#root",width:"350px",height:"300px",position:{of:"#root",my:"bottom"},button:[{id:"btn01",caption:this.lang.t("btnOk"),location:"after"}]},p.createElement(g(),{colCount:1,height:"fit-content"},p.createElement(b.Item,null,p.createElement(w.ZP,{parent:this,id:"grdChkCustomer",showBorders:!0,columnsAutoWidth:!0,allowColumnReordering:!0,allowColumnResizing:!0,headerFilter:{visible:!1},height:"100%",width:"100%",dbApply:!1},p.createElement(w.Po,{defaultPageSize:7}),p.createElement(w.LO,{mode:"cell",allowUpdating:!1,allowDeleting:!1}),p.createElement(w.sg,{dataField:"CUSTOMER",caption:this.t("grdChkCustomer.clmCustomer"),width:80}),p.createElement(w.sg,{dataField:"PRICE",caption:this.t("grdChkCustomer.clmPrice"),dataType:"number",format:{style:"currency",currency:"EUR",precision:2},width:70}),p.createElement(w.sg,{dataField:"PRICE_DATE",caption:this.t("grdChkCustomer.clmDate"),width:100})))))))))}}]),B}(p.Component)}}]);