"use strict";(self.webpackChunkwww=self.webpackChunkwww||[]).push([[6276],{16276:(t,e,n)=>{n.r(e),n.d(e,{default:()=>Z});var a=n(71002),r=n(4942),c=n(15861),i=n(15671),o=n(43144),s=n(97326),d=n(60136),l=n(82963),m=n(61120),E=n(64687),u=n.n(E),h=n(30381),p=n.n(h),O=n(67294),T=n(73364),b=n(4598),I=n(42866),f=n.n(I),C=n(53221),D=n.n(C),g=n(25552),x=n.n(g),_=n(65580),R=n.n(_),v=n(91686),P=n.n(v),N=n(30886),y=n(99846),w=n(5083),A=n(99077),U=n(55585),S=n(417),j=n(32175),k=n(18405),M=n(73682),F=n(90428),L=(n(57941),n(60547));function V(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function G(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?V(Object(n),!0).forEach((function(e){(0,r.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n(17276),n(51166);var Z=function(t){(0,d.Z)(X,t);var e,n,r,E,h,I,C,_,v,V,Z,B,Y,W,H,Q,q,z,K=(q=X,z=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=(0,m.Z)(q);if(z){var n=(0,m.Z)(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return(0,l.Z)(this,t)});function X(t){var e;return(0,i.Z)(this,X),(e=K.call(this,t)).core=T.Z.instance.core,e.prmObj=e.param.filter({TYPE:1,USERS:e.user.CODE}),e.acsobj=e.access.filter({TYPE:1,USERS:e.user.CODE}),e.docObj=new b.Ch,e.paymentObj=new b.Ch,e.tabIndex=t.data.tabkey,e._cellRoleRender=e._cellRoleRender.bind((0,s.Z)(e)),e._calculateTotal=e._calculateTotal.bind((0,s.Z)(e)),e._getContract=e._getContract.bind((0,s.Z)(e)),e._addPayment=e._addPayment.bind((0,s.Z)(e)),e._onItemRendered=e._onItemRendered.bind((0,s.Z)(e)),e._getProforma=e._getProforma.bind((0,s.Z)(e)),e.rightItems=[{text:e.t("getContract")},{text:e.t("getProforma")}],e.frmDocItems=void 0,e.docLocked=!1,e.combineControl=!0,e.combineNew=!1,e}return(0,o.Z)(X,[{key:"componentDidMount",value:(Q=(0,c.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.core.util.waitUntil(0);case 2:this.init(),void 0!==this.pagePrm&&this.getDoc(this.pagePrm.GUID,"",0);case 4:case"end":return t.stop()}}),t,this)}))),function(){return Q.apply(this,arguments)})},{key:"init",value:(H=(0,c.Z)(u().mark((function t(){var e,n,a=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.docObj.clearAll(),this.paymentObj.clearAll(),this.docObj.ds.on("onAddRow",(function(t,e){"new"==e.stat&&(a.btnNew.setState({disabled:!1}),a.btnBack.setState({disabled:!1}),a.btnNew.setState({disabled:!1}),a.btnBack.setState({disabled:!0}),a.btnSave.setState({disabled:!1}),a.btnDelete.setState({disabled:!1}),a.btnPrint.setState({disabled:!1}))})),this.docObj.ds.on("onEdit",(function(t,e){"edit"==e.rowData.stat&&(a.btnBack.setState({disabled:!1}),a.btnNew.setState({disabled:!0}),a.btnSave.setState({disabled:!1}),a.btnDelete.setState({disabled:!1}),a.btnPrint.setState({disabled:!1}),e.rowData.CUSER=a.user.CODE)})),this.docObj.ds.on("onRefresh",(function(t){a.btnBack.setState({disabled:!0}),a.btnNew.setState({disabled:!1}),a.btnSave.setState({disabled:!1}),a.btnDelete.setState({disabled:!1}),a.btnPrint.setState({disabled:!1})})),this.docObj.ds.on("onDelete",(function(t){a.btnBack.setState({disabled:!1}),a.btnNew.setState({disabled:!1}),a.btnSave.setState({disabled:!1}),a.btnDelete.setState({disabled:!1}),a.btnPrint.setState({disabled:!1})})),this.dtDocDate.value=p()(new Date),(e=G({},this.docObj.empty)).TYPE=1,e.DOC_TYPE=21,e.REBATE=0,this.docObj.addEmpty(e),(n=G({},this.docObj.docCustomer.empty)).DOC_GUID=this.docObj.dt()[0].GUID,n.TYPE=this.docObj.dt()[0].TYPE,n.DOC_TYPE=this.docObj.dt()[0].DOC_TYPE,n.REBATE=this.docObj.dt()[0].REBATE,n.DOC_DATE=this.docObj.dt()[0].DOC_DATE,this.docObj.docCustomer.addEmpty(n),this.txtRef.readOnly=!1,this.txtRefno.readOnly=!1,this.docLocked=!1,this.frmDocItems.option("disabled",!0),t.next=25,this.grdDiffInv.dataRefresh({source:this.docObj.docItems.dt("DOC_ITEMS")});case 25:return t.next=27,this.grdInvoicePayment.dataRefresh({source:this.paymentObj.docCustomer.dt()});case 27:case"end":return t.stop()}}),t,this)}))),function(){return H.apply(this,arguments)})},{key:"getDoc",value:(W=(0,c.Z)(u().mark((function t(e,n,a){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.docObj.clearAll(),this.paymentObj.clearAll(),T.Z.instance.setState({isExecute:!0}),t.next=5,this.docObj.load({GUID:e,REF:n,REF_NO:a,TYPE:1,DOC_TYPE:21});case 5:if(T.Z.instance.setState({isExecute:!1}),this.txtRef.readOnly=!0,this.txtRefno.readOnly=!0,0==this.docObj.dt()[0].LOCKED){t.next=16;break}return this.docLocked=!0,r={id:"msgGetLocked",showTitle:!0,title:this.t("msgGetLocked.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:this.t("msgGetLocked.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgGetLocked.msg"))},t.next=13,(0,L.W)(r);case 13:this.frmDocItems.option("disabled",!0),t.next=18;break;case 16:this.docLocked=!1,this.frmDocItems.option("disabled",!1);case 18:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return W.apply(this,arguments)})},{key:"checkDoc",value:(Y=(0,c.Z)(u().mark((function t(e,n,a){var r=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=(0,c.Z)(u().mark((function t(c){var i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""===n){t.next=15;break}return t.next=3,(new b.Ch).load({GUID:e,REF:n,REF_NO:a});case 3:if(!(t.sent.length>0)){t.next=12;break}return i={id:"msgCode",showTitle:!0,title:"Dikkat",showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:"Evrağa Git",location:"before"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},"Evrak Bulundu")},t.next=8,(0,L.W)(i);case 8:"btn01"==t.sent?(r.getDoc(e,n,a),c(2)):c(3),t.next=13;break;case 12:c(1);case 13:t.next=16;break;case 15:c(0);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)}))),function(t,e,n){return Y.apply(this,arguments)})},{key:"_calculateTotal",value:(B=(0,c.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.docObj.dt()[0].AMOUNT=this.docObj.docItems.dt().sum("AMOUNT",2),this.docObj.dt()[0].DISCOUNT=this.docObj.docItems.dt().sum("DISCOUNT",2),this.docObj.dt()[0].VAT=this.docObj.docItems.dt().sum("VAT",2),this.docObj.dt()[0].TOTAL=this.docObj.docItems.dt().sum("TOTAL",2),this.docObj.docCustomer.dt()[0].AMOUNT=this.docObj.dt()[0].TOTAL;case 5:case"end":return t.stop()}}),t,this)}))),function(){return B.apply(this,arguments)})},{key:"_calculateTotalMargin",value:(Z=(0,c.Z)(u().mark((function t(){var e,n,a,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=0,n=0;n<this.docObj.docItems.dt().length;n++)e+=this.docObj.docItems.dt()[n].COST_PRICE*this.docObj.docItems.dt()[n].QUANTITY;a=this.docObj.dt()[0].TOTAL-this.docObj.dt()[0].VAT-e,r=a/(this.docObj.dt()[0].TOTAL-this.docObj.dt()[0].VAT)*100,this.docObj.dt()[0].MARGIN=a.toFixed(2)+"€ / %"+r.toFixed(2),console.log(this.docObj.dt()[0].MARGIN);case 6:case"end":return t.stop()}}),t,this)}))),function(){return Z.apply(this,arguments)})},{key:"_calculateMargin",value:(V=(0,c.Z)(u().mark((function t(){var e,n,a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=0;e<this.docObj.docItems.dt().length;e++)n=this.docObj.docItems.dt()[e].TOTAL-this.docObj.docItems.dt()[e].VAT-this.docObj.docItems.dt()[e].COST_PRICE*this.docObj.docItems.dt()[e].QUANTITY,a=n/(this.docObj.docItems.dt()[e].TOTAL-this.docObj.docItems.dt()[e].VAT)*100,this.docObj.docItems.dt()[e].MARGIN=n.toFixed(2)+"€ / %"+a.toFixed(2);case 1:case"end":return t.stop()}}),t,this)}))),function(){return V.apply(this,arguments)})},{key:"_cellRoleRender",value:function(t){var e=this;if("ITEM_CODE"==t.column.dataField)return O.createElement(y.ZP,{id:"txtGrdItemsCode"+t.rowIndex,parent:this,simple:!0,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,value:t.value,onKeyDown:function(){var n=(0,c.Z)(u().mark((function n(a){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("F10"!=a.event.key&&"ArrowRight"!=a.event.key){n.next=4;break}return n.next=3,e.pg_txtItemsCode.setVal(t.value);case 3:e.pg_txtItemsCode.onClick=function(){var n=(0,c.Z)(u().mark((function n(a){var r,c;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.combineControl=!0,e.combineNew=!1,1!=a.length){n.next=7;break}return n.next=5,e.addItem(a[0],t.rowIndex);case 5:n.next=37;break;case 7:if(!(a.length>1)){n.next=37;break}r=0;case 9:if(!(r<a.length)){n.next=37;break}if(0!=r){n.next=15;break}return n.next=13,e.addItem(a[r],t.rowIndex);case 13:n.next=34;break;case 15:return(c=G({},e.docObj.docItems.empty)).DOC_GUID=e.docObj.dt()[0].GUID,c.TYPE=e.docObj.dt()[0].TYPE,c.DOC_TYPE=e.docObj.dt()[0].DOC_TYPE,c.REBATE=e.docObj.dt()[0].REBATE,c.LINE_NO=e.docObj.docItems.dt().length,c.REF=e.docObj.dt()[0].REF,c.REF_NO=e.docObj.dt()[0].REF_NO,c.OUTPUT=e.docObj.dt()[0].OUTPUT,c.INPUT=e.docObj.dt()[0].INPUT,c.DOC_DATE=e.docObj.dt()[0].DOC_DATE,c.SHIPMENT_DATE=e.docObj.dt()[0].SHIPMENT_DATE,e.txtRef.readOnly=!0,e.txtRefno.readOnly=!0,e.docObj.docItems.addEmpty(c),n.next=32,e.core.util.waitUntil(100);case 32:return n.next=34,e.addItem(a[r],e.docObj.docItems.dt().length-1);case 34:r++,n.next=9;break;case 37:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}();case 4:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),onValueChanged:function(e){t.value=e.value},onChange:function(){var n=(0,c.Z)(u().mark((function n(a){var r,c,i;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==a.event.isTrusted){n.next=15;break}return r={query:"SELECT ITEMS_VW_01.GUID,CODE,NAME,VAT,COST_PRICE FROM ITEMS_VW_01 INNER JOIN ITEM_BARCODE_VW_01 ON ITEMS_VW_01.GUID = ITEM_BARCODE_VW_01.ITEM_GUID WHERE CODE = @CODE OR ITEM_BARCODE_VW_01.BARCODE = @CODE",param:["CODE:string|50"],value:[a.component._changedValue]},n.next=4,e.core.sql.execute(r);case 4:if(!((c=n.sent).result.recordset.length>0)){n.next=12;break}return e.combineControl=!0,e.combineNew=!1,n.next=10,e.addItem(c.result.recordset[0],t.rowIndex);case 10:n.next=15;break;case 12:return i={id:"msgItemNotFound",showTitle:!0,title:e.t("msgItemNotFound.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.t("msgItemNotFound.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},e.t("msgItemNotFound.msg"))},n.next=15,(0,L.W)(i);case 15:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}().bind(this),button:[{id:"01",icon:"more",onClick:function(){e.pg_txtItemsCode.show(),e.pg_txtItemsCode.onClick=function(){var n=(0,c.Z)(u().mark((function n(a){var r,c;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.combineControl=!0,e.combineNew=!1,1!=a.length){n.next=7;break}return n.next=5,e.addItem(a[0],t.rowIndex);case 5:n.next=37;break;case 7:if(!(a.length>1)){n.next=37;break}r=0;case 9:if(!(r<a.length)){n.next=37;break}if(0!=r){n.next=15;break}return n.next=13,e.addItem(a[r],t.rowIndex);case 13:n.next=34;break;case 15:return(c=G({},e.docObj.docItems.empty)).DOC_GUID=e.docObj.dt()[0].GUID,c.TYPE=e.docObj.dt()[0].TYPE,c.DOC_TYPE=e.docObj.dt()[0].DOC_TYPE,c.REBATE=e.docObj.dt()[0].REBATE,c.LINE_NO=e.docObj.docItems.dt().length,c.REF=e.docObj.dt()[0].REF,c.REF_NO=e.docObj.dt()[0].REF_NO,c.OUTPUT=e.docObj.dt()[0].OUTPUT,c.INPUT=e.docObj.dt()[0].INPUT,c.DOC_DATE=e.docObj.dt()[0].DOC_DATE,c.SHIPMENT_DATE=e.docObj.dt()[0].SHIPMENT_DATE,e.txtRef.readOnly=!0,e.txtRefno.readOnly=!0,e.docObj.docItems.addEmpty(c),n.next=32,e.core.util.waitUntil(100);case 32:return n.next=34,e.addItem(a[r],e.docObj.docItems.dt().length-1);case 34:r++,n.next=9;break;case 37:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()}}]})}},{key:"_onItemRendered",value:(v=(0,c.Z)(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.core.util.waitUntil(10);case 2:e.itemData.title==this.t("tabTitleSubtotal")||e.itemData.title==this.t("tabTitlePayments")&&this._getPayment(this.docObj.dt()[0].GUID);case 3:case"end":return t.stop()}}),t,this)}))),function(t){return v.apply(this,arguments)})},{key:"addItem",value:(_=(0,c.Z)(u().mark((function t(e,n,r){var i,o,s,d,l,m=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:T.Z.instance.setState({isExecute:!0}),void 0===r&&(r=1),i=u().mark((function t(a){var i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(m.docObj.docItems.dt()[a].ITEM_CODE!=e.CODE){t.next=19;break}if(1!=m.combineControl){t.next=10;break}return i="",T.Z.instance.setState({isExecute:!1}),t.next=6,m.msgCombineItem.show().then(function(){var t=(0,c.Z)(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("btn01"!=e){t.next=11;break}return m.docObj.docItems.dt()[a].QUANTITY=m.docObj.docItems.dt()[a].QUANTITY+r,m.docObj.docItems.dt()[a].VAT=parseFloat((m.docObj.docItems.dt()[a].VAT+m.docObj.docItems.dt()[a].PRICE*(m.docObj.docItems.dt()[a].VAT_RATE/100)*r).toFixed(3)),m.docObj.docItems.dt()[a].AMOUNT=parseFloat((m.docObj.docItems.dt()[a].QUANTITY*m.docObj.docItems.dt()[a].PRICE).toFixed(3)),m.docObj.docItems.dt()[a].TOTAL=parseFloat((m.docObj.docItems.dt()[a].QUANTITY*m.docObj.docItems.dt()[a].PRICE-m.docObj.docItems.dt()[a].DISCOUNT+m.docObj.docItems.dt()[a].VAT).toFixed(3)),m._calculateTotal(),t.next=8,m.grdDiffInv.devGrid.deleteRow(n);case 8:return 1==m.checkCombine.value&&(m.combineControl=!1),i=e,t.abrupt("return");case 11:if("btn02"!=e){t.next=14;break}return 1==m.checkCombine.value&&(m.combineControl=!1,m.combineNew=!0),t.abrupt("return");case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 6:if("btn01"!=i){t.next=8;break}return t.abrupt("return",{v:void 0});case 8:t.next=19;break;case 10:if(0!=m.combineNew){t.next=19;break}return m.docObj.docItems.dt()[a].QUANTITY=m.docObj.docItems.dt()[a].QUANTITY+r,m.docObj.docItems.dt()[a].VAT=parseFloat((m.docObj.docItems.dt()[a].VAT+m.docObj.docItems.dt()[a].PRICE*(m.docObj.docItems.dt()[a].VAT_RATE/100)*r).toFixed(3)),m.docObj.docItems.dt()[a].AMOUNT=parseFloat((m.docObj.docItems.dt()[a].QUANTITY*m.docObj.docItems.dt()[a].PRICE).toFixed(3)),m.docObj.docItems.dt()[a].TOTAL=parseFloat((m.docObj.docItems.dt()[a].QUANTITY*m.docObj.docItems.dt()[a].PRICE-m.docObj.docItems.dt()[a].DISCOUNT+m.docObj.docItems.dt()[a].VAT).toFixed(3)),m._calculateTotal(),t.next=18,m.grdDiffInv.devGrid.deleteRow(n);case 18:return t.abrupt("return",{v:void 0});case 19:case"end":return t.stop()}}),t)})),o=0;case 4:if(!(o<this.docObj.docItems.dt().length)){t.next=12;break}return t.delegateYield(i(o),"t0",6);case 6:if(s=t.t0,"object"!==(0,a.Z)(s)){t.next=9;break}return t.abrupt("return",s.v);case 9:o++,t.next=4;break;case 12:return this.docObj.docItems.dt()[n].ITEM_CODE=e.CODE,this.docObj.docItems.dt()[n].ITEM=e.GUID,this.docObj.docItems.dt()[n].VAT_RATE=e.VAT,this.docObj.docItems.dt()[n].ITEM_NAME=e.NAME,this.docObj.docItems.dt()[n].DISCOUNT=0,this.docObj.docItems.dt()[n].DISCOUNT_RATE=0,d={query:"SELECT dbo.FN_CUSTOMER_PRICE(@GUID,@CUSTOMER,@QUANTITY,GETDATE()) AS PRICE",param:["GUID:string|50","QUANTITY:float","CUSTOMER:string|50"],value:[e.GUID,r,this.docObj.dt()[0].INPUT]},t.next=21,this.core.sql.execute(d);case 21:(l=t.sent).result.recordset.length>0&&(this.docObj.docItems.dt()[n].CUSTOMER_PRICE=parseFloat(l.result.recordset[0].PRICE.toFixed(3)),this.docObj.docItems.dt()[n].PRICE=parseFloat(l.result.recordset[0].PRICE.toFixed(3)),this.docObj.docItems.dt()[n].VAT=parseFloat((l.result.recordset[0].PRICE*(e.VAT/100)).toFixed(3)),this.docObj.docItems.dt()[n].AMOUNT=parseFloat(l.result.recordset[0].PRICE.toFixed(3)),this.docObj.docItems.dt()[n].TOTAL=parseFloat((l.result.recordset[0].PRICE+this.docObj.docItems.dt()[n].VAT).toFixed(3)),this._calculateTotal()),T.Z.instance.setState({isExecute:!1});case 24:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return _.apply(this,arguments)})},{key:"_getContract",value:(C=(0,c.Z)(u().mark((function t(){var e,n,a=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={query:"SELECT *,REF + '-' + CONVERT(VARCHAR,REF_NO) AS REFERANS FROM DOC_VW_01 WHERE OUTPUT = @OUTPUT AND TYPE = 0 AND DOC_TYPE = 20 ORDER BY DOC_DATE DESC",param:["OUTPUT:string|50"],value:[this.docObj.dt()[0].INPUT]},t.next=3,this.core.sql.execute(e);case 3:if(!((n=t.sent).result.recordset.length>0)){t.next=7;break}return t.next=7,this.pg_contractGrid.setData(n.result.recordset);case 7:this.pg_contractGrid.show(),this.pg_contractGrid.onClick=function(){var t=(0,c.Z)(u().mark((function t(e){var n,r,c,i,o,s,d,l,m;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],r=0;case 2:if(!(r<e.length)){t.next=11;break}return c={query:"SELECT * FROM DOC_ITEMS_VW_01 WHERE (((DOC_GUID = @DOC_GUID) OR (INVOICE_GUID = @DOC_GUID)) OR (@DOC_GUID = '00000000-0000-0000-0000-000000000000')) AND ISNULL((SELECT TOP 1 INVOICE_GUID FROM DOC_ITEMS_VW_01 AS DIF WHERE DIF.INVOICE_GUID = DOC_ITEMS_VW_01.GUID AND DIF.DOC_TYPE =21),'00000000-0000-0000-0000-000000000000') = '00000000-0000-0000-0000-000000000000' ",param:["DOC_GUID:string|50"],value:[e[r].GUID]},t.next=6,a.core.sql.execute(c);case 6:(i=t.sent).result.recordset.length>0&&n.push(i.result.recordset);case 8:r++,t.next=2;break;case 11:o=0;case 12:if(!(o<n.length)){t.next=55;break}s=0;case 14:if(!(s<n[o].length)){t.next=52;break}return d={query:"SELECT [dbo].[FN_CUSTOMER_PRICE](@ITEM,@CUSTOMER,@QUANTITY,GETDATE()) AS PRICE",param:["ITEM:string|50","CUSTOMER:string|50","QUANTITY:float"],value:[n[o][s].ITEM,n[o][s].OUTPUT,n[o][s].QUANTITY]},t.next=18,a.core.sql.execute(d);case 18:if(!((l=t.sent).result.recordset[0].PRICE<n[o][s].PRICE&&0!=l.result.recordset[0].PRICE&&0==n[o][s].ITEM_TYPE)){t.next=49;break}return(m=G({},a.docObj.docItems.empty)).DOC_GUID=a.docObj.dt()[0].GUID,m.TYPE=a.docObj.dt()[0].TYPE,m.DOC_TYPE=a.docObj.dt()[0].DOC_TYPE,m.REBATE=a.docObj.dt()[0].REBATE,m.LINE_NO=a.docObj.docItems.dt().length,m.REF=a.docObj.dt()[0].REF,m.REF_NO=a.docObj.dt()[0].REF_NO,m.INPUT=a.docObj.dt()[0].INPUT,m.OUTPUT=a.docObj.dt()[0].OUTPUT,m.DOC_DATE=a.docObj.dt()[0].DOC_DATE,m.SHIPMENT_DATE=a.docObj.dt()[0].SHIPMENT_DATE,m.ITEM=n[o][s].ITEM,m.ITEM_CODE=n[o][s].ITEM_CODE,m.ITEM_NAME=n[o][s].ITEM_NAME,m.QUANTITY=n[o][s].QUANTITY,m.DISCOUNT_RATE=n[o][s].DISCOUNT_RATE,m.DISCOUNT=(n[o][s].PRICE-l.result.recordset[0].PRICE)*n[o][s].DISCOUNT_RATE/100*n[o][s].QUANTITY,m.PRICE=n[o][s].PRICE-l.result.recordset[0].PRICE,m.AMOUNT=(n[o][s].PRICE-l.result.recordset[0].PRICE)*n[o][s].QUANTITY,m.VAT=parseFloat((m.AMOUNT*(n[o][s].VAT_RATE/100)).toFixed(3)),m.TOTAL=(n[o][s].PRICE-l.result.recordset[0].PRICE)*n[o][s].QUANTITY+m.VAT,m.INVOICE_GUID=n[o][s].GUID,m.CONNECT_REF=n[o][s].REF+"-"+n[o][s].REF_NO,a.docObj.docItems.addEmpty(m),t.next=47,a.core.util.waitUntil(100);case 47:a.txtRef.readOnly=!0,a.txtRefno.readOnly=!0;case 49:s++,t.next=14;break;case 52:o++,t.next=12;break;case 55:a._calculateTotal();case 56:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();case 9:case"end":return t.stop()}}),t,this)}))),function(){return C.apply(this,arguments)})},{key:"_getPayment",value:(I=(0,c.Z)(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.paymentObj.load({PAYMENT_DOC_GUID:this.docObj.dt()[0].GUID});case 2:this.paymentObj.dt().length>0?(e=(this.docObj.dt()[0].TOTAL-this.paymentObj.dt()[0].TOTAL).toFixed(2),this.txtRemainder.setState({value:e}),this.txtMainRemainder.setState({value:e})):(this.txtRemainder.setState({value:this.docObj.dt()[0].TOTAL}),this.txtMainRemainder.setState({value:this.docObj.dt()[0].TOTAL}));case 3:case"end":return t.stop()}}),t,this)}))),function(){return I.apply(this,arguments)})},{key:"_addPayment",value:(h=(0,c.Z)(u().mark((function t(e,n){var a,r,c,i,o,s;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n>this.txtRemainder.value)){t.next=5;break}return a={id:"msgMoreAmount",showTitle:!0,title:this.t("msgMoreAmount.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:this.t("msgMoreAmount.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgMoreAmount.msg"))},t.next=4,(0,L.W)(a);case 4:return t.abrupt("return");case 5:if(0!=this.paymentObj.dt().length){t.next=17;break}return r=G({},this.paymentObj.empty),c={query:"SELECT ISNULL(MAX(REF_NO) + 1,1) AS REF_NO FROM DOC WHERE TYPE = 0 AND DOC_TYPE = 200 AND REF = @REF ",param:["REF:string|25"],value:[this.txtRef.value]},t.next=10,this.core.sql.execute(c);case 10:(i=t.sent).result.recordset.length>0&&(r.REF=this.txtRef.value,r.REF_NO=i.result.recordset[0].REF_NO),r.TYPE=0,r.DOC_TYPE=200,r.INPUT="00000000-0000-0000-0000-000000000000",r.OUTPUT=this.docObj.dt()[0].INPUT,this.paymentObj.addEmpty(r);case 17:return(o=G({},this.paymentObj.docCustomer.empty)).DOC_GUID=this.paymentObj.dt()[0].GUID,o.TYPE=this.paymentObj.dt()[0].TYPE,o.REF=this.paymentObj.dt()[0].REF,o.REF_NO=this.paymentObj.dt()[0].REF_NO,o.DOC_TYPE=this.paymentObj.dt()[0].DOC_TYPE,o.DOC_DATE=this.paymentObj.dt()[0].DOC_DATE,o.OUTPUT=this.paymentObj.dt()[0].OUTPUT,o.INVOICE_GUID=this.docObj.dt()[0].GUID,0==e?(o.INPUT=this.cmbCashSafe.value,o.INPUT_NAME=this.cmbCashSafe.displayValue,o.PAY_TYPE=0,o.AMOUNT=n,o.DESCRIPTION=this.cashDescription.value):1==e?(o.INPUT=this.cmbCashSafe.value,o.INPUT_NAME=this.cmbCashSafe.displayValue,o.PAY_TYPE=1,o.AMOUNT=n,o.DESCRIPTION=this.cashDescription.value,(s=G({},this.paymentObj.checkCls.empty)).DOC_GUID=this.paymentObj.dt()[0].GUID,s.REF=checkReference.value,s.DOC_DATE=this.paymentObj.dt()[0].DOC_DATE,s.CHECK_DATE=this.paymentObj.dt()[0].DOC_DATE,s.CUSTOMER=this.paymentObj.dt()[0].OUTPUT,s.AMOUNT=n,s.SAFE=this.cmbCashSafe.value,this.paymentObj.checkCls.addEmpty(s)):1==e&&(o.INPUT=this.cmbCashSafe.value,o.INPUT_NAME=this.cmbCashSafe.displayValue,o.PAY_TYPE=2,o.AMOUNT=n,o.DESCRIPTION=this.cashDescription.value),t.next=29,this.paymentObj.docCustomer.addEmpty(o);case 29:return this.paymentObj.dt()[0].AMOUNT=this.paymentObj.docCustomer.dt().sum("AMOUNT",2),this.paymentObj.dt()[0].TOTAL=this.paymentObj.docCustomer.dt().sum("AMOUNT",2),t.next=33,this.paymentObj.save();case 33:if(t.t0=t.sent,0!=t.t0){t.next=35;break}case 35:return t.next=37,this._getPayment();case 37:this.popPayment.show();case 38:case"end":return t.stop()}}),t,this)}))),function(t,e){return h.apply(this,arguments)})},{key:"checkRow",value:(E=(0,c.Z)(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=0;e<this.docObj.docItems.dt().length;e++)this.docObj.docItems.dt()[e].INPUT=this.docObj.dt()[0].INPUT,this.docObj.docItems.dt()[e].OUTPUT=this.docObj.dt()[0].OUTPUT,this.docObj.docItems.dt()[e].DOC_DATE=this.docObj.dt()[0].DOC_DATE,this.docObj.docItems.dt()[e].SHIPMENT_DATE=this.docObj.dt()[0].SHIPMENT_DATE;case 1:case"end":return t.stop()}}),t,this)}))),function(){return E.apply(this,arguments)})},{key:"_getBarcodes",value:(r=(0,c.Z)(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e={source:{select:{query:"SELECT ITEMS_VW_01.GUID,CODE,NAME,COST_PRICE,VAT,BARCODE,ISNULL((SELECT TOP 1 CODE FROM ITEM_MULTICODE WHERE ITEM_MULTICODE.ITEM = ITEMS_VW_01.GUID AND ITEM_MULTICODE.CUSTOMER = '"+this.docObj.dt()[0].INPUT+"' AND DELETED = 0 ORDER BY LDATE DESC),'') AS MULTICODE,  ISNULL((SELECT TOP 1 CUSTOMER_NAME FROM ITEM_MULTICODE_VW_01 WHERE ITEM_MULTICODE_VW_01.ITEM_GUID = ITEMS_VW_01.GUID ORDER BY LDATE DESC),'') AS CUSTOMER_NAME  FROM ITEMS_VW_01 INNER JOIN ITEM_BARCODE_VW_01 ON ITEMS_VW_01.GUID = ITEM_BARCODE_VW_01.ITEM_GUID WHERE  ITEM_BARCODE_VW_01.BARCODE LIKE  '%' +@BARCODE",param:["BARCODE:string|50"]},sql:this.core.sql}},this.pg_txtBarcode.setSource(e);case 2:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"getDocs",value:(n=(0,c.Z)(u().mark((function t(e){var n,a,r,c=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=0==e?{query:"SELECT GUID,REF,REF_NO,INPUT_CODE,INPUT_NAME,DOC_DATE_CONVERT FROM DOC_VW_01 WHERE TYPE = 1 AND DOC_TYPE = 21 AND REBATE = 0 AND DOC_DATE > GETDATE()-30 ORDER BY DOC_DATE DESC"}:{query:"SELECT GUID,REF,REF_NO,INPUT_CODE,INPUT_NAME,DOC_DATE_CONVERT FROM DOC_VW_01 WHERE TYPE = 1 AND DOC_TYPE = 21 AND REBATE = 0 ORDER BY DOC_DATE DESC"},t.next=3,this.core.sql.execute(n);case 3:return a=t.sent,r=[],a.result.recordset.length>0&&(r=a.result.recordset),t.next=8,this.pg_Docs.setData(r);case 8:this.pg_Docs.show(),this.pg_Docs.onClick=function(t){t.length>0&&c.getDoc(t[0].GUID,t[0].REF,t[0].REF_NO)};case 10:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"_getProforma",value:(e=(0,c.Z)(u().mark((function t(){var e,n,a,r=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!=this.docObj.dt()[0].INPUT&&"00000000-0000-0000-0000-000000000000"!=this.docObj.dt()[0].INPUT){t.next=7;break}return e={id:"msgCustomerSelect",showTitle:!0,title:this.t("msgCustomerSelect.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:this.t("msgCustomerSelect.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgCustomerSelect.msg"))},t.next=4,(0,L.W)(e);case 4:return t.abrupt("return");case 7:return n={query:"SELECT *,REF + '-' + CONVERT(VARCHAR,REF_NO) AS REFERANS FROM DOC_ITEMS_VW_01 WHERE INPUT = @INPUT AND INVOICE_GUID = '00000000-0000-0000-0000-000000000000' AND TYPE = 1 AND DOC_TYPE IN(101)",param:["INPUT:string|50"],value:[this.docObj.dt()[0].INPUT]},console.log(this.docObj.dt()[0].INPUT),t.next=11,this.core.sql.execute(n);case 11:if(a=t.sent,console.log(a),!(a.result.recordset.length>0)){t.next=18;break}return t.next=16,this.pg_proformaGrid.setData(a.result.recordset);case 16:t.next=20;break;case 18:return t.next=20,this.pg_proformaGrid.setData([]);case 20:this.pg_proformaGrid.show(),this.pg_proformaGrid.onClick=function(){var t=(0,c.Z)(u().mark((function t(e){var n,a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:T.Z.instance.setState({isExecute:!0}),n=0;case 2:if(!(n<e.length)){t.next=44;break}return(a=G({},r.docObj.docItems.empty)).DOC_GUID=r.docObj.dt()[0].GUID,a.TYPE=e[n].TYPE,a.DOC_TYPE=21,a.REBATE=e[n].REBATE,a.LINE_NO=e[n].LINE_NO,a.REF=e[n].REF,a.REF_NO=e[n].REF_NO,a.DOC_DATE=e[n].DOC_DATE,a.SHIPMENT_DATE=e[n].SHIPMENT_DATE,a.INPUT=e[n].INPUT,a.INPUT_CODE=e[n].INPUT_CODE,a.INPUT_NAME=e[n].INPUT_NAME,a.OUTPUT=e[n].OUTPUT,a.OUTPUT_CODE=e[n].OUTPUT_CODE,a.OUTPUT_NAME=e[n].OUTPUT_NAME,a.ITEM=e[n].ITEM,a.ITEM_CODE=e[n].ITEM_CODE,a.ITEM_NAME=e[n].ITEM_NAME,a.PRICE=e[n].PRICE,a.QUANTITY=e[n].QUANTITY,a.VAT=e[n].VAT,a.AMOUNT=e[n].AMOUNT,a.TOTAL=e[n].TOTAL,a.DESCRIPTION=e[n].DESCRIPTION,a.PROFORMA_GUID=e[n].GUID,a.VAT_RATE=e[n].VAT_RATE,a.DISCOUNT_RATE=e[n].DISCOUNT_RATE,a.CONNECT_REF=e[n].CONNECT_REF,a.ORDER_GUID=e[n].ORDER_GUID,a.OLD_VAT=e[n].VAT_RATE,a.VAT_RATE=e[n].VAT_RATE,a.DEPOT_QUANTITY=e[n].DEPOT_QUANTITY,a.CUSTOMER_PRICE=e[n].CUSTOMER_PRICE,t.next=39,r.docObj.docItems.addEmpty(a);case 39:return t.next=41,r.core.util.waitUntil(100);case 41:n++,t.next=2;break;case 44:r._calculateTotal(),T.Z.instance.setState({isExecute:!1}),setTimeout((function(){r.btnSave.setState({disabled:!1})}),500);case 47:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();case 22:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"render",value:function(){var t,e,n,a=this;return O.createElement("div",null,O.createElement(f(),null,O.createElement("div",{className:"row px-2 pt-2"},O.createElement("div",{className:"col-12"},O.createElement(D(),null,O.createElement(g.Item,{location:"after",locateInMenu:"auto"},O.createElement(M.Z,{id:"btnBack",parent:this,icon:"revert",type:"default",onClick:function(){a.getDoc(a.docObj.dt()[0].GUID,a.docObj.dt()[0].REF,a.docObj.dt()[0].REF_NO)}})),O.createElement(g.Item,{location:"after",locateInMenu:"auto"},O.createElement(M.Z,{id:"btnNew",parent:this,icon:"file",type:"default",onClick:function(){a.init()}})),O.createElement(g.Item,{location:"after",locateInMenu:"auto"},O.createElement(M.Z,{id:"btnSave",parent:this,icon:"floppy",type:"default",validationGroup:"frmPriceDiffInv"+this.tabIndex,onClick:function(){var t=(0,c.Z)(u().mark((function t(e){var n,r,c,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1!=a.docLocked){t.next=5;break}return n={id:"msgDocLocked",showTitle:!0,title:a.t("msgDocLocked.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgDocLocked.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgDocLocked.msg"))},t.next=4,(0,L.W)(n);case 4:return t.abrupt("return");case 5:if(""!=a.docObj.docItems.dt()[a.docObj.docItems.dt().length-1].ITEM_CODE){t.next=8;break}return t.next=8,a.grdDiffInv.devGrid.deleteRow(a.docObj.docItems.dt().length-1);case 8:if("valid"!=e.validationGroup.validate().status){t.next=32;break}return r={id:"msgSave",showTitle:!0,title:a.t("msgSave.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgSave.btn01"),location:"before"},{id:"btn02",caption:a.t("msgSave.btn02"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgSave.msg"))},t.next=12,(0,L.W)(r);case 12:if("btn01"!=t.sent){t.next=30;break}return c={id:"msgSaveResult",showTitle:!0,title:a.t("msgSave.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgSave.btn01"),location:"after"}]},t.next=17,a.docObj.save();case 17:if(t.t0=t.sent,0!=t.t0){t.next=27;break}return a._getPayment(),c.content=O.createElement("div",{style:{textAlign:"center",fontSize:"20px",color:"green"}},a.t("msgSaveResult.msgSuccess")),t.next=23,(0,L.W)(c);case 23:a.btnSave.setState({disabled:!0}),a.btnNew.setState({disabled:!1}),t.next=30;break;case 27:return c.content=O.createElement("div",{style:{textAlign:"center",fontSize:"20px",color:"red"}},a.t("msgSaveResult.msgFailed")),t.next=30,(0,L.W)(c);case 30:t.next=35;break;case 32:return i={id:"msgSaveValid",showTitle:!0,title:a.t("msgSaveValid.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgSaveValid.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgSaveValid.msg"))},t.next=35,(0,L.W)(i);case 35:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),O.createElement(g.Item,{location:"after",locateInMenu:"auto"},O.createElement(M.Z,{id:"btnDelete",parent:this,icon:"trash",type:"default",onClick:(0,c.Z)(u().mark((function t(){var e,n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a.paymentObj.docCustomer.dt().length>0)){t.next=5;break}return e={id:"msgPayNotDeleted",showTitle:!0,title:a.t("msgPayNotDeleted.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgPayNotDeleted.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgPayNotDeleted.msg"))},t.next=4,(0,L.W)(e);case 4:return t.abrupt("return");case 5:if(0==a.docObj.dt()[0].LOCKED){t.next=11;break}return a.docLocked=!0,n={id:"msgGetLocked",showTitle:!0,title:a.t("msgGetLocked.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgGetLocked.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgGetLocked.msg"))},t.next=10,(0,L.W)(n);case 10:return t.abrupt("return");case 11:return r={id:"msgDelete",showTitle:!0,title:a.t("msgDelete.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgDelete.btn01"),location:"before"},{id:"btn02",caption:a.t("msgDelete.btn02"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgDelete.msg"))},t.next=14,(0,L.W)(r);case 14:if("btn01"!=t.sent){t.next=20;break}return a.docObj.dt("DOC").removeAt(0),t.next=19,a.docObj.dt("DOC").delete();case 19:a.init();case 20:case"end":return t.stop()}}),t)})))})),O.createElement(g.Item,{location:"after",locateInMenu:"auto"},O.createElement(M.Z,{id:"btnLock",parent:this,icon:"key",type:"default",onClick:(0,c.Z)(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=a.docObj.dt()[0].LOCKED){t.next=20;break}if(a.docObj.dt()[0].LOCKED=1,""!=a.docObj.docItems.dt()[a.docObj.docItems.dt().length-1].ITEM_CODE){t.next=5;break}return t.next=5,a.grdDiffInv.devGrid.deleteRow(a.docObj.docItems.dt().length-1);case 5:return t.next=7,a.docObj.save();case 7:if(t.t0=t.sent,0!=t.t0){t.next=15;break}return e={id:"msgLocked",showTitle:!0,title:a.t("msgLocked.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgLocked.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgLocked.msg"))},t.next=12,(0,L.W)(e);case 12:a.frmDocItems.option("disabled",!0),t.next=18;break;case 15:return tmpConfObj1.content=O.createElement("div",{style:{textAlign:"center",fontSize:"20px",color:"red"}},a.t("msgSaveResult.msgFailed")),t.next=18,(0,L.W)(tmpConfObj1);case 18:t.next=22;break;case 20:a.popPassword.show(),a.txtPassword.value="";case 22:case"end":return t.stop()}}),t)})))})),O.createElement(g.Item,{location:"after",locateInMenu:"auto"},O.createElement(M.Z,{id:"btnPrint",parent:this,icon:"print",type:"default",onClick:(0,c.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.popDesign.show();case 1:case"end":return t.stop()}}),t)})))})),O.createElement(g.Item,{location:"after",locateInMenu:"auto",widget:"dxButton",options:{type:"default",icon:"clear",onClick:(n=(0,c.Z)(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={id:"msgClose",showTitle:!0,title:a.lang.t("msgWarning"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.lang.t("btnYes"),location:"before"},{id:"btn02",caption:a.lang.t("btnNo"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.lang.t("msgClose"))},t.next=3,(0,L.W)(e);case 3:"btn01"==t.sent&&T.Z.instance.panel.closePage();case 5:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})}})))),O.createElement("div",{className:"row px-2 pt-2"},O.createElement("div",{className:"col-12"},O.createElement(x(),{colCount:3,id:"frmPriceDiffInv"+this.tabIndex},O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("txtRefRefno"),alignment:"right"}),O.createElement("div",{className:"row"},O.createElement("div",{className:"col-4 pe-0"},O.createElement(y.ZP,{id:"txtRef",parent:this,simple:!0,dt:{data:this.docObj.dt("DOC"),field:"REF"},upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,readOnly:!0,maxLength:32,onValueChanged:(0,c.Z)(u().mark((function t(){var e,n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={query:"SELECT ISNULL(MAX(REF_NO) + 1,1) AS REF_NO FROM DOC WHERE TYPE = 1 AND DOC_TYPE = 21 AND REF = @REF ",param:["REF:string|25"],value:[a.txtRef.value]},t.next=3,a.core.sql.execute(e);case 3:(n=t.sent).result.recordset.length>0&&(a.txtRefno.value=n.result.recordset[0].REF_NO,a.docObj.docCustomer.dt()[0].REF_NO=n.result.recordset[0].REF_NO);case 5:case"end":return t.stop()}}),t)}))).bind(this),param:this.param.filter({ELEMENT:"txtRef",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtRef",USERS:this.user.CODE})},O.createElement(y.cX,{validationGroup:"frmPriceDiffInv"+this.tabIndex},O.createElement(y.n2,{message:this.t("validRef")})))),O.createElement("div",{className:"col-5 ps-0"},O.createElement(y.ZP,{id:"txtRefno",parent:this,simple:!0,dt:{data:this.docObj.dt("DOC"),field:"REF_NO"},readOnly:!0,button:[{id:"01",icon:"more",onClick:function(){a.getDocs(0)}},{id:"02",icon:"arrowdown",onClick:function(){a.txtRefno.value=Math.floor(Date.now()/1e3)}}],onChange:(0,c.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.docObj.docCustomer.dt()[0].REF_NO=a.txtRefno.value,t.next=3,a.checkDoc("00000000-0000-0000-0000-000000000000",a.txtRef.value,a.txtRefno.value);case 3:3==t.sent&&(a.txtRefno.value="");case 5:case"end":return t.stop()}}),t)}))).bind(this),param:this.param.filter({ELEMENT:"txtRefno",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtRefno",USERS:this.user.CODE})},O.createElement(y.cX,{validationGroup:"frmPriceDiffInv"+this.tabIndex},O.createElement(y.n2,{message:this.t("validRefNo")}))))),O.createElement(S.Z,{id:"pg_Docs",parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,width:"90%",height:"90%",title:this.t("pg_Docs.title"),button:[{id:"01",icon:"more",onClick:function(){a.getDocs(1)}}]},O.createElement(k.sg,{dataField:"REF",caption:this.t("pg_Docs.clmRef"),width:150}),O.createElement(k.sg,{dataField:"REF_NO",caption:this.t("pg_Docs.clmRefNo"),width:120}),O.createElement(k.sg,{dataField:"DOC_DATE_CONVERT",caption:this.t("pg_Docs.clmDate"),width:300}),O.createElement(k.sg,{dataField:"INPUT_NAME",caption:this.t("pg_Docs.clmInputName"),width:300}),O.createElement(k.sg,{dataField:"INPUT_CODE",caption:this.t("pg_Docs.clmInputCode"),width:300}))),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("cmbDepot"),alignment:"right"}),O.createElement(A.ZP,{simple:!0,parent:this,id:"cmbDepot",notRefresh:!0,dt:{data:this.docObj.dt("DOC"),field:"OUTPUT"},displayExpr:"NAME",valueExpr:"GUID",value:"",searchEnabled:!0,onValueChanged:(0,c.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.docObj.docCustomer.dt()[0].OUTPUT=a.cmbDepot.value,a.checkRow(),""!=a.txtCustomerCode.value&&""!=a.cmbDepot.value&&0==a.docLocked&&a.frmDocItems.option("disabled",!1);case 3:case"end":return t.stop()}}),t)}))).bind(this),data:{source:{select:{query:"SELECT * FROM DEPOT_VW_01 WHERE TYPE IN(0,2)"},sql:this.core.sql}},param:this.param.filter({ELEMENT:"cmbDepot",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"cmbDepot",USERS:this.user.CODE})},O.createElement(y.cX,{validationGroup:"frmPriceDiffInv"+this.tabIndex},O.createElement(y.n2,{message:this.t("validDepot")})))),O.createElement(g.EmptyItem,null),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("txtCustomerCode"),alignment:"right"}),O.createElement(y.ZP,{id:"txtCustomerCode",parent:this,simple:!0,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,dt:{data:this.docObj.dt("DOC"),field:"INPUT_CODE"},onEnterKey:function(){var t=(0,c.Z)(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.pg_txtCustomerCode.setVal(a.txtCustomerCode.value);case 2:a.pg_txtCustomerCode.show(),a.pg_txtCustomerCode.onClick=function(){var t=(0,c.Z)(u().mark((function t(e){var n,r,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.length>0)){t.next=21;break}return a.docObj.dt()[0].INPUT=e[0].GUID,a.docObj.docCustomer.dt()[0].INPUT=e[0].GUID,a.docObj.dt()[0].INPUT_CODE=e[0].CODE,a.docObj.dt()[0].INPUT_NAME=e[0].TITLE,void 0!==(n=a.sysParam.filter({ID:"refForCustomerCode",USERS:a.user.CODE}).getValue())&&1==n.value&&(a.txtRef.value=e[0].CODE,a.txtRef.props.onValueChanged()),""!=a.txtCustomerCode.value&&""!=a.cmbDepot.value&&0==a.docLocked&&a.frmDocItems.option("disabled",!1),r={query:"SELECT * FROM CUSTOMER_ADRESS_VW_01 WHERE CUSTOMER = @CUSTOMER",param:["CUSTOMER:string|50"],value:[e[0].GUID]},t.next=11,a.core.sql.execute(r);case 11:if(!((i=t.sent).result.recordset.length>1)){t.next=19;break}return t.next=15,a.pg_adress.setData(i.result.recordset);case 15:a.pg_adress.show(),a.pg_adress.onClick=function(){var t=(0,c.Z)(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.length>0&&(a.docObj.dt()[0].ADDRESS=e[0].TYPE);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),t.next=21;break;case 19:return t.next=21,a.pg_adress.setData([]);case 21:a._getBarcodes();case 22:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}().bind(this),button:[{id:"01",icon:"more",onClick:function(){a.pg_txtCustomerCode.show(),a.pg_txtCustomerCode.onClick=function(){var t=(0,c.Z)(u().mark((function t(e){var n,r,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.length>0)){t.next=21;break}return a.docObj.dt()[0].INPUT=e[0].GUID,a.docObj.docCustomer.dt()[0].INPUT=e[0].GUID,a.docObj.dt()[0].INPUT_CODE=e[0].CODE,a.docObj.dt()[0].INPUT_NAME=e[0].TITLE,void 0!==(n=a.sysParam.filter({ID:"refForCustomerCode",USERS:a.user.CODE}).getValue())&&1==n.value&&(a.txtRef.value=e[0].CODE,a.txtRef.props.onValueChanged()),""!=a.txtCustomerCode.value&&""!=a.cmbDepot.value&&0==a.docLocked&&a.frmDocItems.option("disabled",!1),r={query:"SELECT * FROM CUSTOMER_ADRESS_VW_01 WHERE CUSTOMER = @CUSTOMER",param:["CUSTOMER:string|50"],value:[e[0].GUID]},t.next=11,a.core.sql.execute(r);case 11:if(!((i=t.sent).result.recordset.length>1)){t.next=19;break}return t.next=15,a.pg_adress.setData(i.result.recordset);case 15:a.pg_adress.show(),a.pg_adress.onClick=function(){var t=(0,c.Z)(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.length>0&&(a.docObj.dt()[0].ADDRESS=e[0].TYPE);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),t.next=21;break;case 19:return t.next=21,a.pg_adress.setData([]);case 21:a._getBarcodes();case 22:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}],param:this.param.filter({ELEMENT:"txtCustomerCode",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtCustomerCode",USERS:this.user.CODE})},O.createElement(y.cX,{validationGroup:"frmPriceDiffInv"+this.tabIndex},O.createElement(y.n2,{message:this.t("validCustomerCode")}))),O.createElement(S.Z,{id:"pg_txtCustomerCode",parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,width:"90%",height:"90%",title:this.t("pg_txtCustomerCode.title"),search:!0,data:{source:{select:{query:"SELECT GUID,CODE,TITLE,NAME,LAST_NAME,[TYPE_NAME],[GENUS_NAME] FROM CUSTOMER_VW_01 WHERE UPPER(CODE) LIKE UPPER(@VAL) OR UPPER(TITLE) LIKE UPPER(@VAL)",param:["VAL:string|50"]},sql:this.core.sql}},button:{id:"01",icon:"more",onClick:function(){console.log(1111)}}},O.createElement(k.sg,{dataField:"CODE",caption:this.t("pg_txtCustomerCode.clmCode"),width:150}),O.createElement(k.sg,{dataField:"TITLE",caption:this.t("pg_txtCustomerCode.clmTitle"),width:500,defaultSortOrder:"asc"}),O.createElement(k.sg,{dataField:"TYPE_NAME",caption:this.t("pg_txtCustomerCode.clmTypeName"),width:150}),O.createElement(k.sg,{dataField:"GENUS_NAME",caption:this.t("pg_txtCustomerCode.clmGenusName"),width:150,filterType:"include",filterValues:["Tedarikçi"]}))),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("txtCustomerName"),alignment:"right"}),O.createElement(y.ZP,{id:"txtCustomerName",parent:this,simple:!0,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,dt:{data:this.docObj.dt("DOC"),field:"INPUT_NAME"},readOnly:!0,param:this.param.filter({ELEMENT:"txtCustomerName",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtCustomerName",USERS:this.user.CODE})})),O.createElement(g.EmptyItem,null),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("txtBarcode"),alignment:"right"}),O.createElement(y.ZP,{id:"txtBarcode",parent:this,simple:!0,placeholder:this.t("txtBarcodePlace"),upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,button:[{id:"01",icon:"fa-solid fa-barcode",onClick:(e=(0,c.Z)(u().mark((function t(e){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!=a.cmbDepot.value&&""!=a.txtCustomerCode.value){t.next=6;break}return n={id:"msgDocValid",showTitle:!0,title:a.t("msgDocValid.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgDocValid.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgDocValid.msg"))},t.next=4,(0,L.W)(n);case 4:return a.txtBarcode.setState({value:""}),t.abrupt("return");case 6:return t.next=8,a.pg_txtBarcode.setVal(a.txtBarcode.value);case 8:a.pg_txtBarcode.show(),a.pg_txtBarcode.onClick=function(){var t=(0,c.Z)(u().mark((function t(e){var n,r,c;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.txtBarcode.setState({value:""}),(n=G({},a.docObj.docItems.empty)).DOC_GUID=a.docObj.dt()[0].GUID,n.TYPE=a.docObj.dt()[0].TYPE,n.DOC_TYPE=a.docObj.dt()[0].DOC_TYPE,n.REBATE=a.docObj.dt()[0].REBATE,n.LINE_NO=a.docObj.docItems.dt().length,n.REF=a.docObj.dt()[0].REF,n.REF_NO=a.docObj.dt()[0].REF_NO,n.OUTPUT=a.docObj.dt()[0].OUTPUT,n.INPUT=a.docObj.dt()[0].INPUT,n.DOC_DATE=a.docObj.dt()[0].DOC_DATE,n.SHIPMENT_DATE=a.docObj.dt()[0].SHIPMENT_DATE,a.txtRef.readOnly=!0,a.txtRefno.readOnly=!0,a.docObj.docItems.addEmpty(n),t.next=18,a.core.util.waitUntil(100);case 18:if(!(e.length>0)){t.next=58;break}if(a.customerControl=!0,a.customerClear=!1,a.combineControl=!0,a.combineNew=!1,1!=e.length){t.next=28;break}return t.next=26,a.addItem(e[0],a.docObj.docItems.dt().length-1);case 26:t.next=58;break;case 28:if(!(e.length>1)){t.next=58;break}r=0;case 30:if(!(r<e.length)){t.next=58;break}if(0!=r){t.next=36;break}return t.next=34,a.addItem(e[r],a.docObj.docItems.dt().length-1);case 34:t.next=55;break;case 36:return(c=G({},a.docObj.docItems.empty)).DOC_GUID=a.docObj.dt()[0].GUID,c.TYPE=a.docObj.dt()[0].TYPE,c.DOC_TYPE=a.docObj.dt()[0].DOC_TYPE,c.REBATE=a.docObj.dt()[0].REBATE,c.LINE_NO=a.docObj.docItems.dt().length,c.REF=a.docObj.dt()[0].REF,c.REF_NO=a.docObj.dt()[0].REF_NO,c.OUTPUT=a.docObj.dt()[0].OUTPUT,c.INPUT=a.docObj.dt()[0].INPUT,c.DOC_DATE=a.docObj.dt()[0].DOC_DATE,c.SHIPMENT_DATE=a.docObj.dt()[0].SHIPMENT_DATE,a.txtRef.readOnly=!0,a.txtRefno.readOnly=!0,a.docObj.docItems.addEmpty(c),t.next=53,a.core.util.waitUntil(100);case 53:return t.next=55,a.addItem(e[r],a.docObj.docItems.dt().length-1);case 55:r++,t.next=30;break;case 58:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();case 10:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})}],onEnterKey:function(){var t=(0,c.Z)(u().mark((function t(e){var n,r,i,o;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!=a.cmbDepot.value){t.next=6;break}return n={id:"msgDocValid",showTitle:!0,title:a.t("msgDocValid.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgDocValid.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgDocValid.msg"))},t.next=4,(0,L.W)(n);case 4:return a.txtBarcode.setState({value:""}),t.abrupt("return");case 6:return r={query:"SELECT ITEMS_VW_01.GUID,CODE,NAME,COST_PRICE,VAT,ISNULL((SELECT TOP 1 CODE FROM ITEM_MULTICODE WHERE ITEM_MULTICODE.ITEM = ITEMS_VW_01.GUID AND ITEM_MULTICODE.CUSTOMER = @CUSTOMER AND DELETED = 0 ORDER BY LDATE DESC),'') AS MULTICODE,  ISNULL((SELECT TOP 1 CUSTOMER_NAME FROM ITEM_MULTICODE_VW_01 WHERE ITEM_MULTICODE_VW_01.ITEM_GUID = ITEMS_VW_01.GUID ORDER BY LDATE DESC),'') AS CUSTOMER_NAME  FROM ITEMS_VW_01 INNER JOIN ITEM_BARCODE_VW_01 ON ITEMS_VW_01.GUID = ITEM_BARCODE_VW_01.ITEM_GUID WHERE CODE = @CODE OR ITEM_BARCODE_VW_01.BARCODE = @CODE",param:["CODE:string|50","CUSTOMER:string|50"],value:[a.txtBarcode.value,a.docObj.dt()[0].OUTPUT]},t.next=9,a.core.sql.execute(r);case 9:if(i=t.sent,a.txtBarcode.setState({value:""}),!(i.result.recordset.length>0)){t.next=20;break}return a.txtPopQuantity.value="",setTimeout((0,c.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.txtPopQuantity.focus();case 1:case"end":return t.stop()}}),t)}))),700),t.next=16,a.msgQuantity.show().then(function(){var t=(0,c.Z)(u().mark((function t(e){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=G({},a.docObj.docItems.empty)).DOC_GUID=a.docObj.dt()[0].GUID,n.TYPE=a.docObj.dt()[0].TYPE,n.DOC_TYPE=a.docObj.dt()[0].DOC_TYPE,n.REBATE=a.docObj.dt()[0].REBATE,n.LINE_NO=a.docObj.docItems.dt().length,n.REF=a.docObj.dt()[0].REF,n.REF_NO=a.docObj.dt()[0].REF_NO,n.OUTPUT=a.docObj.dt()[0].OUTPUT,n.INPUT=a.docObj.dt()[0].INPUT,n.DOC_DATE=a.docObj.dt()[0].DOC_DATE,n.SHIPMENT_DATE=a.docObj.dt()[0].SHIPMENT_DATE,a.txtRef.readOnly=!0,a.txtRefno.readOnly=!0,a.docObj.docItems.addEmpty(n),t.next=17,a.core.util.waitUntil(100);case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 16:a.addItem(i.result.recordset[0],void 0===a.docObj.docItems.dt()[0]?0:a.docObj.docItems.dt().length-1,a.txtPopQuantity.value),a.txtBarcode.focus(),t.next=23;break;case 20:return o={id:"msgItemNotFound",showTitle:!0,title:a.t("msgItemNotFound.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgItemNotFound.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgItemNotFound.msg"))},t.next=23,(0,L.W)(o);case 23:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}().bind(this),param:this.param.filter({ELEMENT:"txtBarcode",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtBarcode",USERS:this.user.CODE})})),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("dtDocDate"),alignment:"right"}),O.createElement(F.ZP,{simple:!0,parent:this,id:"dtDocDate",dt:{data:this.docObj.dt("DOC"),field:"DOC_DATE"},onValueChanged:(0,c.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.docObj.docCustomer.dt()[0].DOC_DATE=p()(a.dtDocDate.value).format("DD/MM/YYYY"),a.checkRow();case 2:case"end":return t.stop()}}),t)}))).bind(this)},O.createElement(y.cX,{validationGroup:"frmPriceDiffInv"+this.tabIndex},O.createElement(y.n2,{message:this.t("validDocDate")})))),O.createElement(g.EmptyItem,null)))),O.createElement("div",{className:"row px-2 pt-2"},O.createElement("div",{className:"col-12"},O.createElement(x(),{colCount:1,onInitialized:function(t){a.frmDocItems=t.component}},O.createElement(g.Item,{location:"after"},O.createElement(N.Button,{icon:"add",validationGroup:"frmPriceDiffInv"+this.tabIndex,onClick:function(){var t=(0,c.Z)(u().mark((function t(e){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("valid"!=e.validationGroup.validate().status){t.next=10;break}if(void 0===a.docObj.docItems.dt()[0]){t.next=6;break}if(""!=a.docObj.docItems.dt()[a.docObj.docItems.dt().length-1].ITEM_CODE){t.next=6;break}return a.pg_txtItemsCode.show(),a.pg_txtItemsCode.onClick=function(){var t=(0,c.Z)(u().mark((function t(e){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.length>0)){t.next=38;break}if(a.combineControl=!0,a.combineNew=!1,1!=e.length){t.next=8;break}return t.next=6,a.addItem(e[0],a.docObj.docItems.dt().length-1);case 6:t.next=38;break;case 8:if(!(e.length>1)){t.next=38;break}n=0;case 10:if(!(n<e.length)){t.next=38;break}if(0!=n){t.next=16;break}return t.next=14,a.addItem(e[n],a.docObj.docItems.dt().length-1);case 14:t.next=35;break;case 16:return(r=G({},a.docObj.docItems.empty)).DOC_GUID=a.docObj.dt()[0].GUID,r.TYPE=a.docObj.dt()[0].TYPE,r.DOC_TYPE=a.docObj.dt()[0].DOC_TYPE,r.REBATE=a.docObj.dt()[0].REBATE,r.LINE_NO=a.docObj.docItems.dt().length,r.REF=a.docObj.dt()[0].REF,r.REF_NO=a.docObj.dt()[0].REF_NO,r.OUTPUT=a.docObj.dt()[0].OUTPUT,r.INPUT=a.docObj.dt()[0].INPUT,r.DOC_DATE=a.docObj.dt()[0].DOC_DATE,r.SHIPMENT_DATE=a.docObj.dt()[0].SHIPMENT_DATE,a.txtRef.readOnly=!0,a.txtRefno.readOnly=!0,a.docObj.docItems.addEmpty(r),t.next=33,a.core.util.waitUntil(100);case 33:return t.next=35,a.addItem(e[n],a.docObj.docItems.dt().length-1);case 35:n++,t.next=10;break;case 38:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),t.abrupt("return");case 6:a.pg_txtItemsCode.show(),a.pg_txtItemsCode.onClick=function(){var t=(0,c.Z)(u().mark((function t(e){var n,r,c;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=G({},a.docObj.docItems.empty)).DOC_GUID=a.docObj.dt()[0].GUID,n.TYPE=a.docObj.dt()[0].TYPE,n.DOC_TYPE=a.docObj.dt()[0].DOC_TYPE,n.REBATE=a.docObj.dt()[0].REBATE,n.LINE_NO=a.docObj.docItems.dt().length,n.REF=a.docObj.dt()[0].REF,n.REF_NO=a.docObj.dt()[0].REF_NO,n.OUTPUT=a.docObj.dt()[0].OUTPUT,n.INPUT=a.docObj.dt()[0].INPUT,n.DOC_DATE=a.docObj.dt()[0].DOC_DATE,n.SHIPMENT_DATE=a.docObj.dt()[0].SHIPMENT_DATE,a.txtRef.readOnly=!0,a.txtRefno.readOnly=!0,a.docObj.docItems.addEmpty(n),t.next=17,a.core.util.waitUntil(100);case 17:if(a.combineControl=!0,a.combineNew=!1,1!=e.length){t.next=24;break}return t.next=22,a.addItem(e[0],a.docObj.docItems.dt().length-1);case 22:t.next=54;break;case 24:if(!(e.length>1)){t.next=54;break}r=0;case 26:if(!(r<e.length)){t.next=54;break}if(0!=r){t.next=32;break}return t.next=30,a.addItem(e[r],a.docObj.docItems.dt().length-1);case 30:t.next=51;break;case 32:return(c=G({},a.docObj.docItems.empty)).DOC_GUID=a.docObj.dt()[0].GUID,c.TYPE=a.docObj.dt()[0].TYPE,c.DOC_TYPE=a.docObj.dt()[0].DOC_TYPE,c.REBATE=a.docObj.dt()[0].REBATE,c.LINE_NO=a.docObj.docItems.dt().length,c.REF=a.docObj.dt()[0].REF,c.REF_NO=a.docObj.dt()[0].REF_NO,c.OUTPUT=a.docObj.dt()[0].OUTPUT,c.INPUT=a.docObj.dt()[0].INPUT,c.DOC_DATE=a.docObj.dt()[0].DOC_DATE,c.SHIPMENT_DATE=a.docObj.dt()[0].SHIPMENT_DATE,a.txtRef.readOnly=!0,a.txtRefno.readOnly=!0,a.docObj.docItems.addEmpty(c),t.next=49,a.core.util.waitUntil(100);case 49:return t.next=51,a.addItem(e[r],a.docObj.docItems.dt().length-1);case 51:r++,t.next=26;break;case 54:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),t.next=13;break;case 10:return n={id:"msgDocValid",showTitle:!0,title:a.t("msgDocValid.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgDocValid.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgDocValid.msg"))},t.next=13,(0,L.W)(n);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),O.createElement(g.Item,null,O.createElement(O.Fragment,null,O.createElement(k.ZP,{parent:this,id:"grdDiffInv",showBorders:!0,columnsAutoWidth:!0,allowColumnReordering:!0,allowColumnResizing:!0,filterRow:{visible:!0},height:"400",width:"100%",dbApply:!1,onRowPrepared:function(t){},onRowUpdated:function(){var t=(0,c.Z)(u().mark((function t(e){var n,r,c;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e.data.CUSTOMER_PRICE&&void 0===e.data.PURC_PRICE||(e.key.PRICE=Number(e.key.PURC_PRICE-e.key.CUSTOMER_PRICE).toFixed(3)),!(e.key.DISCOUNT>e.key.PRICE*e.key.QUANTITY)){t.next=6;break}return n={id:"msgDiscount",showTitle:!0,title:"Uyarı",showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgDiscount.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},"msgDiscount.msg")},(0,L.W)(n),e.key.DISCOUNT=0,t.abrupt("return");case 6:e.key.VAT=parseFloat(((e.key.PRICE*e.key.QUANTITY-e.key.DISCOUNT)*e.key.VAT_RATE/100).toFixed(3)),e.key.AMOUNT=parseFloat((e.key.PRICE*e.key.QUANTITY).toFixed(3)),e.key.TOTAL=parseFloat((e.key.PRICE*e.key.QUANTITY-e.key.DISCOUNT+e.key.VAT).toFixed(3)),r=e.key.TOTAL-e.key.VAT-e.key.COST_PRICE*e.key.QUANTITY,c=r/(e.key.TOTAL-e.key.VAT)*100,e.key.MARGIN=r.toFixed(2)+"€ / %"+c.toFixed(2),e.key.DISCOUNT>0&&(e.key.DISCOUNT_RATE=parseFloat(100-((e.key.PRICE*e.key.QUANTITY-e.key.DISCOUNT)/(e.key.PRICE*e.key.QUANTITY)*100).toFixed(3))),a._calculateTotal();case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),onRowRemoved:function(){var t=(0,c.Z)(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a._calculateTotal();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},O.createElement(k.Po,{defaultPageSize:10}),O.createElement(k.uE,{visible:!0,allowedPageSizes:[5,10,20,50,100],showPageSizeSelector:!0}),O.createElement(k.m_,{editOnKeyPress:!0,enterKeyAction:"moveFocus",enterKeyDirection:"column"}),O.createElement(k.PY,{mode:"standart"}),O.createElement(k.LO,{mode:"cell",allowUpdating:!0,allowDeleting:!0,confirmDelete:!1}),O.createElement(k.D7,{fileName:this.lang.t("menu.ftr_02_004"),enabled:!0,allowExportSelectedData:!0}),O.createElement(k.sg,{dataField:"CDATE_FORMAT",caption:this.t("grdDiffInv.clmCreateDate"),width:80,allowEditing:!1}),O.createElement(k.sg,{dataField:"CUSER_NAME",caption:this.t("grdDiffInv.clmCuser"),width:90,allowEditing:!1}),O.createElement(k.sg,{dataField:"ITEM_CODE",caption:this.t("grdDiffInv.clmItemCode"),width:90,editCellRender:this._cellRoleRender}),O.createElement(k.sg,{dataField:"MULTICODE",caption:this.t("grdDiffInv.clmMulticode"),width:90}),O.createElement(k.sg,{dataField:"ITEM_NAME",caption:this.t("grdDiffInv.clmItemName"),width:200}),O.createElement(k.sg,{dataField:"CUSTOMER_PRICE",caption:this.t("grdDiffInv.clmCustomerPrice"),dataType:"number",format:{style:"currency",currency:"EUR",precision:3},width:70}),O.createElement(k.sg,{dataField:"PURC_PRICE",caption:this.t("grdDiffInv.clmPurcPrice"),dataType:"number",format:{style:"currency",currency:"EUR",precision:3},width:70}),O.createElement(k.sg,{dataField:"QUANTITY",caption:this.t("grdDiffInv.clmQuantity"),dataType:"number",width:50}),O.createElement(k.sg,{dataField:"PRICE",caption:this.t("grdDiffInv.clmPrice"),dataType:"number",format:{style:"currency",currency:"EUR",precision:3},width:70}),O.createElement(k.sg,{dataField:"DISCOUNT",caption:this.t("grdDiffInv.clmDiscount"),dataType:"number",format:{style:"currency",currency:"EUR",precision:2},width:60,allowHeaderFiltering:!1}),O.createElement(k.sg,{dataField:"DISCOUNT_RATE",caption:this.t("grdDiffInv.clmDiscountRate"),dataType:"number",width:60,allowHeaderFiltering:!1}),O.createElement(k.sg,{dataField:"AMOUNT",caption:this.t("grdDiffInv.clmAmount"),format:{style:"currency",currency:"EUR",precision:3},width:90,allowEditing:!1}),O.createElement(k.sg,{dataField:"VAT",caption:this.t("grdDiffInv.clmVat"),format:{style:"currency",currency:"EUR",precision:3},width:75,allowEditing:!1}),O.createElement(k.sg,{dataField:"VAT_RATE",caption:this.t("grdDiffInv.clmVatRate"),width:50,allowEditing:!1}),O.createElement(k.sg,{dataField:"TOTAL",caption:this.t("grdDiffInv.clmTotal"),format:{style:"currency",currency:"EUR",precision:3},width:100,allowEditing:!1}),O.createElement(k.sg,{dataField:"CONNECT_REF",caption:this.t("grdDiffInv.clmInvNo"),width:80,allowEditing:!1}),O.createElement(k.sg,{dataField:"CONNECT_DOC_DATE",caption:this.t("grdDiffInv.clmInvDate"),width:80,allowEditing:!1}),O.createElement(k.sg,{dataField:"DESCRIPTION",caption:this.t("grdDiffInv.clmDescription"),width:80})),O.createElement(R(),{dataSource:this.rightItems,width:200,target:"#grdDiffInv",onItemClick:function(){var t=(0,c.Z)(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.itemData.text!=a.t("getContract")){t.next=4;break}a._getContract(),t.next=11;break;case 4:if(e.itemData.text!=a.t("getPayment")){t.next=10;break}return t.next=7,a._getPayment();case 7:a.popPayment.show(),t.next=11;break;case 10:e.itemData.text==a.t("getProforma")&&a._getProforma();case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}().bind(this)})))))),O.createElement("div",{className:"row px-2 pt-2"},O.createElement("div",{className:"col-12"},O.createElement(P(),{height:"100%",onItemRendered:this._onItemRendered},O.createElement(g.Item,{title:this.t("tabTitleSubtotal")},O.createElement("div",{className:"row px-2 pt-2"},O.createElement("div",{className:"col-12"},O.createElement(x(),{colCount:4,parent:this,id:"frmSlsInv"+this.tabIndex},O.createElement(g.EmptyItem,{colSpan:3}),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("txtAmount"),alignment:"right"}),O.createElement(y.ZP,{id:"txtAmount",parent:this,simple:!0,readOnly:!0,dt:{data:this.docObj.dt("DOC"),field:"AMOUNT"},maxLength:32})),O.createElement(g.EmptyItem,{colSpan:3}),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("txtDiscount"),alignment:"right"}),O.createElement(y.ZP,{id:"txtDiscount",parent:this,simple:!0,readOnly:!0,dt:{data:this.docObj.dt("DOC"),field:"DISCOUNT"},maxLength:32,button:[{id:"01",icon:"more",onClick:function(){a.docObj.dt()[0].DISCOUNT>0&&(a.txtDiscountPercent.value=parseFloat((100-(a.docObj.dt()[0].AMOUNT-a.docObj.dt()[0].DISCOUNT)/a.docObj.dt()[0].AMOUNT*100).toFixed(3)),a.txtDiscountPrice.value=a.docObj.dt()[0].DISCOUNT),a.popDiscount.show()}}]})),O.createElement(g.EmptyItem,{colSpan:3}),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("txtVat"),alignment:"right"}),O.createElement(y.ZP,{id:"txtVat",parent:this,simple:!0,readOnly:!0,dt:{data:this.docObj.dt("DOC"),field:"VAT"},maxLength:32,button:[{id:"01",icon:"clear",onClick:(t=(0,c.Z)(u().mark((function t(){var e,n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={id:"msgVatDelete",showTitle:!0,title:a.t("msgVatDelete.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgVatDelete.btn01"),location:"before"},{id:"btn02",caption:a.t("msgSave.btn02"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgVatDelete.msg"))},t.next=3,(0,L.W)(e);case 3:if("btn01"==t.sent)for(n=0;n<a.docObj.docItems.dt().length;n++)a.docObj.docItems.dt()[n].VAT=0,a.docObj.docItems.dt()[n].VAT_RATE=0,a.docObj.docItems.dt()[n].TOTAL=a.docObj.docItems.dt()[n].PRICE*a.docObj.docItems.dt()[n].QUANTITY-a.docObj.docItems.dt()[n].DISCOUNT,a._calculateTotal();case 5:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}]})),O.createElement(g.EmptyItem,{colSpan:3}),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("txtTotal"),alignment:"right"}),O.createElement(y.ZP,{id:"txtTotal",parent:this,simple:!0,readOnly:!0,dt:{data:this.docObj.dt("DOC"),field:"TOTAL"},maxLength:32})))))),O.createElement(g.Item,{title:this.t("tabTitlePayments")},O.createElement("div",{className:"row px-2 pt-2"},O.createElement("div",{className:"col-12"},O.createElement(x(),{colCount:4,parent:this,id:"frmSlsInv"+this.tabIndex},O.createElement(g.EmptyItem,{colSpan:3}),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("txtPayTotal"),alignment:"right"}),O.createElement(y.ZP,{id:"txtPayTotal",parent:this,simple:!0,readOnly:!0,dt:{data:this.paymentObj.dt("DOC"),field:"TOTAL"},maxLength:32})),O.createElement(g.EmptyItem,{colSpan:3}),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("txtRemainder"),alignment:"right"}),O.createElement(y.ZP,{id:"txtRemainder",parent:this,simple:!0,readOnly:!0,maxLength:32})),O.createElement(g.EmptyItem,{colSpan:3}),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("txtbalance"),alignment:"right"}),O.createElement(y.ZP,{id:"txtbalance",format:{style:"currency",currency:"EUR",precision:2},parent:this,simple:!0,readOnly:!0,dt:{data:this.docObj.dt("DOC_CUSTOMER"),field:"INPUT_BALANCE"},maxLength:32})),O.createElement(g.EmptyItem,{colSpan:3}),O.createElement(g.Item,null,O.createElement("div",{className:"row"},O.createElement("div",{className:"col-12"},O.createElement(M.Z,{text:this.t("getPayment"),type:"normal",stylingMode:"contained",width:"100%",onClick:function(){var t=(0,c.Z)(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a._getPayment();case 2:a.popPayment.show();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}))))))))))),O.createElement("div",null,O.createElement(j.ZP,{parent:this,id:"popDiscount",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popDiscount.title"),container:"#root",width:"500",height:"250",position:{of:"#root"}},O.createElement(x(),{colCount:1,height:"fit-content"},O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("popDiscount.Percent"),alignment:"right"}),O.createElement(w.ZP,{id:"txtDiscountPercent",parent:this,simple:!0,maxLength:32,onValueChanged:(0,c.Z)(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a.txtDiscountPercent.value>100)){t.next=7;break}return e={id:"msgDiscountPercent",showTitle:!0,title:a.t("msgDiscountPercent.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgDiscountPercent.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgDiscountPercent.msg"))},t.next=4,(0,L.W)(e);case 4:return a.txtDiscountPercent.value=0,a.txtDiscountPrice.value=0,t.abrupt("return");case 7:a.txtDiscountPrice.value=parseFloat((a.docObj.dt()[0].AMOUNT*a.txtDiscountPercent.value/100).toFixed(3));case 8:case"end":return t.stop()}}),t)}))).bind(this)})),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("popDiscount.Price"),alignment:"right"}),O.createElement(w.ZP,{id:"txtDiscountPrice",parent:this,simple:!0,maxLength:32,onValueChanged:(0,c.Z)(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a.txtDiscountPrice.value>a.docObj.dt()[0].AMOUNT)){t.next=7;break}return e={id:"msgDiscountPrice",showTitle:!0,title:a.t("msgDiscountPrice.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgDiscountPrice.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgDiscountPrice.msg"))},t.next=4,(0,L.W)(e);case 4:return a.txtDiscountPercent.value=0,a.txtDiscountPrice.value=0,t.abrupt("return");case 7:a.txtDiscountPercent.value=parseFloat((100-(a.docObj.dt()[0].AMOUNT-a.txtDiscountPrice.value)/a.docObj.dt()[0].AMOUNT*100).toFixed(3));case 8:case"end":return t.stop()}}),t)}))).bind(this)})),O.createElement(g.Item,null,O.createElement("div",{className:"row"},O.createElement("div",{className:"col-6"},O.createElement(M.Z,{text:this.lang.t("btnSave"),type:"normal",stylingMode:"contained",width:"100%",onClick:(0,c.Z)(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=0;e<a.docObj.docItems.dt().length;e++)a.docObj.docItems.dt()[e].DISCOUNT_RATE=a.txtDiscountPercent.value,a.docObj.docItems.dt()[e].DISCOUNT=parseFloat((a.docObj.docItems.dt()[e].PRICE*a.docObj.docItems.dt()[e].QUANTITY*a.txtDiscountPercent.value/100).toFixed(3)),a.docObj.docItems.dt()[e].VAT>0&&(a.docObj.docItems.dt()[e].VAT=parseFloat((a.docObj.docItems.dt()[e].PRICE*a.docObj.docItems.dt()[e].QUANTITY*(a.docObj.docItems.dt()[e].VAT_RATE/100)).toFixed(3))),a.docObj.docItems.dt()[e].TOTAL=parseFloat((a.docObj.docItems.dt()[e].PRICE*a.docObj.docItems.dt()[e].QUANTITY+a.docObj.docItems.dt()[e].VAT-a.docObj.docItems.dt()[e].DISCOUNT).toFixed(3));a._calculateMargin(),a._calculateTotal(),a._calculateTotalMargin(),a.popDiscount.hide();case 5:case"end":return t.stop()}}),t)})))})),O.createElement("div",{className:"col-6"},O.createElement(M.Z,{text:this.lang.t("btnCancel"),type:"normal",stylingMode:"contained",width:"100%",onClick:function(){a.popDiscount.hide()}}))))))),O.createElement("div",null,O.createElement(j.ZP,{parent:this,id:"popPassword",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popPassword.title"),container:"#root",width:"500",height:"200",position:{of:"#root"}},O.createElement(x(),{colCount:1,height:"fit-content"},O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("popPassword.Password"),alignment:"right"}),O.createElement(y.ZP,{id:"txtPassword",mode:"password",parent:this,simple:!0,maxLength:32})),O.createElement(g.Item,null,O.createElement("div",{className:"row"},O.createElement("div",{className:"col-6"},O.createElement(M.Z,{text:this.t("popPassword.btnApprove"),type:"normal",stylingMode:"contained",width:"100%",onClick:(0,c.Z)(u().mark((function t(){var e,n,r,c;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=btoa(a.txtPassword.value),n={query:"SELECT TOP 1 * FROM USERS WHERE PWD = @PWD AND ROLE = 'Administrator' AND STATUS = 1",param:["PWD:string|50"],value:[e]},t.next=4,a.core.sql.execute(n);case 4:if(!(t.sent.result.recordset.length>0)){t.next=15;break}return a.docObj.dt()[0].LOCKED=0,a.frmDocItems.option("disabled",!1),a.docLocked=!1,r={id:"msgPasswordSucces",showTitle:!0,title:a.t("msgPasswordSucces.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgPasswordSucces.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgPasswordSucces.msg"))},t.next=12,(0,L.W)(r);case 12:a.popPassword.hide(),t.next=18;break;case 15:return c={id:"msgPasswordWrong",showTitle:!0,title:a.t("msgPasswordWrong.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:a.t("msgPasswordWrong.btn01"),location:"after"}],content:O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},a.t("msgPasswordWrong.msg"))},t.next=18,(0,L.W)(c);case 18:case"end":return t.stop()}}),t)})))})),O.createElement("div",{className:"col-6"},O.createElement(M.Z,{text:this.lang.t("btnCancel"),type:"normal",stylingMode:"contained",width:"100%",onClick:function(){a.popPassword.hide()}}))))))),O.createElement(S.Z,{id:"pg_contractGrid",parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,width:"90%",height:"90%",selection:{mode:"multiple"},title:this.t("pg_contractGrid.title")},O.createElement(k.sg,{dataField:"REFERANS",caption:this.t("pg_contractGrid.clmReferans"),width:200,defaultSortOrder:"asc"}),O.createElement(k.sg,{dataField:"TOTAL",caption:this.t("pg_contractGrid.clmTotal"),width:300}),O.createElement(k.sg,{dataField:"DOC_DATE_CONVERT",caption:this.t("pg_contractGrid.clmDocDate"),width:300})),O.createElement(S.Z,{id:"pg_txtItemsCode",parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,width:"90%",height:"90%",title:this.t("pg_txtItemsCode.title"),search:!0,data:{source:{select:{query:"SELECT GUID,CODE,NAME,VAT FROM ITEMS_VW_01 WHERE UPPER(CODE) LIKE UPPER(@VAL) OR UPPER(NAME) LIKE UPPER(@VAL)",param:["VAL:string|50"]},sql:this.core.sql}}},O.createElement(k.sg,{dataField:"CODE",caption:this.t("pg_txtItemsCode.clmCode"),width:150}),O.createElement(k.sg,{dataField:"NAME",caption:this.t("pg_txtItemsCode.clmName"),width:300,defaultSortOrder:"asc"})),O.createElement("div",null,O.createElement(j.ZP,{parent:this,id:"popPayment",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popPayment.title"),container:"#root",width:"800",height:"800",position:{of:"#root"}},O.createElement(x(),{colCount:3,height:"fit-content"},O.createElement(g.Item,{location:"after"},O.createElement(N.Button,{icon:"add",text:this.t("btnCash"),validationGroup:"frmPurcInv"+this.tabIndex,onClick:function(){var t=(0,c.Z)(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.popPayment.hide(),a.numCash.setState({value:0}),a.cashDescription.setState({value:""}),a.popCash.show();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}))),O.createElement(k.ZP,{parent:this,id:"grdInvoicePayment",showBorders:!0,columnsAutoWidth:!0,allowColumnReordering:!0,allowColumnResizing:!0,headerFilter:{visible:!0},height:"75%",width:"100%",dbApply:!1,onRowRemoved:function(){var t=(0,c.Z)(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.popPayment.hide(),a.paymentObj.dt()[0].AMOUNT=a.paymentObj.docCustomer.dt().sum("AMOUNT",2),a.paymentObj.dt()[0].TOTAL=a.paymentObj.docCustomer.dt().sum("AMOUNT",2),a.paymentObj.save(),t.next=6,a._getPayment();case 6:a.popPayment.show();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},O.createElement(k.m_,{editOnKeyPress:!0,enterKeyAction:"moveFocus",enterKeyDirection:"column"}),O.createElement(k.PY,{mode:"standart"}),O.createElement(k.LO,{mode:"cell",allowUpdating:!1,allowDeleting:!0}),O.createElement(k.sg,{dataField:"CDATE_FORMAT",caption:this.t("grdInvoicePayment.clmCreateDate"),width:150,allowEditing:!1,headerFilter:{visible:!0}}),O.createElement(k.sg,{dataField:"AMOUNT",caption:this.t("grdInvoicePayment.clmPrice"),width:150,headerFilter:{visible:!0}}),O.createElement(k.sg,{dataField:"INPUT_NAME",caption:this.t("grdInvoicePayment.clmInputName"),width:150,headerFilter:{visible:!0}}),O.createElement(k.sg,{dataField:"PAY_TYPE_NAME",caption:this.t("grdInvoicePayment.clmTypeName"),width:150,headerFilter:{visible:!0}})),O.createElement("div",{className:"row px-2 pt-2"},O.createElement("div",{className:"col-12"},O.createElement(x(),{colCount:2,parent:this},O.createElement(g.EmptyItem,null),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("txtPayInvoıceTotal"),alignment:"right"}),O.createElement(y.ZP,{id:"txtPayInvoıceTotal",parent:this,simple:!0,readOnly:!0,dt:{data:this.docObj.dt("DOC"),field:"TOTAL"},upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,maxLength:32})),O.createElement(g.EmptyItem,null),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("txtPayTotal"),alignment:"right"}),O.createElement(y.ZP,{id:"txtPayTotal",parent:this,simple:!0,readOnly:!0,dt:{data:this.paymentObj.dt("DOC"),field:"TOTAL"},upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,maxLength:32})),O.createElement(g.EmptyItem,null),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("txtRemainder"),alignment:"right"}),O.createElement(y.ZP,{id:"txtMainRemainder",parent:this,simple:!0,readOnly:!0,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,maxLength:32}))))))),O.createElement("div",null,O.createElement(j.ZP,{parent:this,id:"popCash",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popCash.title"),container:"#root",width:"500",height:"400",position:{of:"#root"}},O.createElement(x(),{colCount:1,height:"fit-content"},O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("cmbPayType.title"),alignment:"right"}),O.createElement(A.ZP,{simple:!0,parent:this,id:"cmbPayType",displayExpr:"VALUE",valueExpr:"ID",value:"",searchEnabled:!0,notRefresh:!0,onValueChanged:function(){var t=(0,c.Z)(u().mark((function t(e){var n,r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.cmbCashSafe.value="",0==e.value?n={query:"SELECT * FROM SAFE_VW_01 WHERE TYPE = 0"}:1==e.value?n={query:"SELECT * FROM SAFE_VW_01 WHERE TYPE = 1"}:2==e.value||3==e.value?n={query:"SELECT * FROM BANK_VW_01 WHERE TYPE = 0"}:(4==e.value||5==e.value)&&(n={query:"SELECT * FROM SAFE_VW_01 WHERE TYPE = 0"}),t.next=4,a.core.sql.execute(n);case 4:(r=t.sent).result.recordset.length>0?a.cmbCashSafe.setData(r.result.recordset):a.cmbCashSafe.setData([]);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}().bind(this),data:{source:[{ID:0,VALUE:this.t("cmbPayType.cash")},{ID:1,VALUE:this.t("cmbPayType.check")},{ID:2,VALUE:this.t("cmbPayType.bankTransfer")},{ID:3,VALUE:this.t("cmbPayType.otoTransfer")},{ID:4,VALUE:this.t("cmbPayType.foodTicket")},{ID:5,VALUE:this.t("cmbPayType.bill")}]},param:this.param.filter({ELEMENT:"cmbCashSafe",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"cmbCashSafe",USERS:this.user.CODE})},O.createElement(y.cX,{validationGroup:"frmPayCash"+this.tabIndex},O.createElement(y.n2,{message:this.t("ValidCash")})))),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("cmbCashSafe"),alignment:"right"}),O.createElement(A.ZP,{simple:!0,parent:this,id:"cmbCashSafe",displayExpr:"NAME",valueExpr:"GUID",value:"",searchEnabled:!0,notRefresh:!0,onValueChanged:(0,c.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))).bind(this),param:this.param.filter({ELEMENT:"cmbCashSafe",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"cmbCashSafe",USERS:this.user.CODE})},O.createElement(y.cX,{validationGroup:"frmPayCash"+this.tabIndex},O.createElement(y.n2,{message:this.t("ValidCash")})))),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("cash"),alignment:"right"}),O.createElement("div",{className:"row"},O.createElement("div",{className:"col-4 pe-0"},O.createElement(w.ZP,{id:"numCash",parent:this,simple:!0,maxLength:32,param:this.param.filter({ELEMENT:"numCash",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"numCash",USERS:this.user.CODE})},O.createElement(y.cX,{validationGroup:"frmPayCash"+this.tabIndex},O.createElement(y.n2,{message:this.t("ValidCash")})))),O.createElement("div",{className:"col-6 pe-0"},O.createElement(N.Button,{icon:"revert",text:this.t("getRemainder"),onClick:function(){var t=(0,c.Z)(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.numCash.value=a.txtRemainder.value;case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})))),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("description"),alignment:"right"}),O.createElement("div",{className:"col-12 pe-0"},O.createElement(y.ZP,{id:"cashDescription",parent:this,simple:!0,width:500,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,maxLength:32,param:this.param.filter({ELEMENT:"cashDescription",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"cashDescription",USERS:this.user.CODE})}))),O.createElement(g.Item,null,O.createElement("div",{className:"row"},O.createElement("div",{className:"col-6"},O.createElement(M.Z,{text:this.t("popCash.btnApprove"),type:"normal",stylingMode:"contained",width:"100%",validationGroup:"frmPayCash"+this.tabIndex,onClick:function(){var t=(0,c.Z)(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"valid"==e.validationGroup.validate().status&&(1==a.cmbPayType.value?a.popCheck.show():(a._addPayment(a.cmbPayType.value,a.numCash.value),a.popCash.hide()));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),O.createElement("div",{className:"col-6"},O.createElement(M.Z,{text:this.lang.t("btnCancel"),type:"normal",stylingMode:"contained",width:"100%",onClick:function(){a.popCash.hide()}}))))))),O.createElement("div",null,O.createElement(j.ZP,{parent:this,id:"popCheck",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popCheck.title"),container:"#root",width:"500",height:"500",position:{of:"#root"}},O.createElement(x(),{colCount:1,height:"fit-content"},O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("checkReference"),alignment:"right"}),O.createElement("div",{className:"col-12 pe-0"},O.createElement(y.ZP,{id:"checkReference",parent:this,simple:!0,width:500,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,maxLength:32,param:this.param.filter({ELEMENT:"checkReference",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"checkReference",USERS:this.user.CODE})}))),O.createElement(g.Item,null,O.createElement("div",{className:"row"},O.createElement("div",{className:"col-6"},O.createElement(M.Z,{text:this.t("popCheck.btnApprove"),type:"normal",stylingMode:"contained",width:"100%",validationGroup:"frmCollCheck"+this.tabIndex,onClick:function(){var t=(0,c.Z)(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a._addPayment(1,a.numCash.value),a.popCheck.hide(),a.popCash.hide();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),O.createElement("div",{className:"col-6"},O.createElement(M.Z,{text:this.lang.t("btnCancel"),type:"normal",stylingMode:"contained",width:"100%",onClick:function(){a.popCheck.hide()}}))))))),O.createElement("div",null,O.createElement(j.ZP,{parent:this,id:"popDesign",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popDesign.title"),container:"#root",width:"500",height:"250",position:{of:"#root"}},O.createElement(x(),{colCount:1,height:"fit-content"},O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("popDesign.design"),alignment:"right"}),O.createElement(A.ZP,{simple:!0,parent:this,id:"cmbDesignList",notRefresh:!0,displayExpr:"DESIGN_NAME",valueExpr:"TAG",value:"",searchEnabled:!0,onValueChanged:(0,c.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))).bind(this),data:{source:{select:{query:"SELECT TAG,DESIGN_NAME FROM [dbo].[LABEL_DESIGN] WHERE PAGE = '17'"},sql:this.core.sql}},param:this.param.filter({ELEMENT:"cmbDesignList",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"cmbDesignList",USERS:this.user.CODE})},O.createElement(y.cX,{validationGroup:"frmPurcOrderPrint"+this.tabIndex},O.createElement(y.n2,{message:this.t("validDesign")})))),O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("popDesign.lang"),alignment:"right"}),O.createElement(A.ZP,{simple:!0,parent:this,id:"cmbDesignLang",notRefresh:!0,displayExpr:"VALUE",valueExpr:"ID",value:"",searchEnabled:!0,onValueChanged:(0,c.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))).bind(this),data:{source:[{ID:"FR",VALUE:"FR"},{ID:"TR",VALUE:"TR"}]}})),O.createElement(g.Item,null,O.createElement("div",{className:"row"},O.createElement("div",{className:"col-6"},O.createElement(M.Z,{text:this.lang.t("btnPrint"),type:"normal",stylingMode:"contained",width:"100%",onClick:(0,c.Z)(u().mark((function t(){var e,n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={query:"SELECT *,ISNULL((SELECT TOP 1 PATH FROM LABEL_DESIGN WHERE TAG = @DESIGN),'') AS PATH FROM  [dbo].[FN_DOC_ITEMS_FOR_PRINT](@DOC_GUID) ORDER BY LINE_NO ",param:["DOC_GUID:string|50","DESIGN:string|25"],value:[a.docObj.dt()[0].GUID,a.cmbDesignList.value]},t.next=3,a.core.sql.execute(e);case 3:n=t.sent,console.log(JSON.stringify(n.result.recordset[0])),a.core.socket.emit("devprint","{TYPE:'REVIEW',PATH:'"+n.result.recordset[0].PATH.replaceAll("\\","/")+"',DATA:"+JSON.stringify(n.result.recordset)+"}",(function(t){if("ERR"!=t.split("|")[0]){var e=window.open("printview.html","_blank","width=900,height=1000,left=500");e.onload=function(){e.document.getElementById("view").innerHTML="<iframe src='data:application/pdf;base64,"+t.split("|")[1]+"' type='application/pdf' width='100%' height='100%'></iframe>"}}})),a.popDesign.hide();case 7:case"end":return t.stop()}}),t)})))})),O.createElement("div",{className:"col-6"},O.createElement(M.Z,{text:this.lang.t("btnCancel"),type:"normal",stylingMode:"contained",width:"100%",onClick:function(){a.popDesign.hide()}}))))))),O.createElement(L.Z,{id:"msgCombineItem",container:"#root",parent:this,position:{of:"#root"},showTitle:!0,title:this.t("msgCombineItem.title"),showCloseButton:!1,width:"500px",height:"250px",button:[{id:"btn01",caption:this.t("msgCombineItem.btn01"),location:"before"},{id:"btn02",caption:this.t("msgCombineItem.btn02"),location:"after"}]},O.createElement("div",{className:"row"},O.createElement("div",{className:"col-12 py-2"},O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgCombineItem.msg"))),O.createElement("div",{className:"col-12 py-2"},O.createElement(x(),null,O.createElement(g.Item,null,O.createElement(g.Label,{text:this.lang.t("checkAll"),alignment:"right"}),O.createElement(U.ZP,{id:"checkCombine",parent:this,simple:!0,value:!1}))))),O.createElement("div",{className:"row"})),O.createElement(L.Z,{id:"msgQuantity",container:"#root",parent:this,position:{of:"#root"},showTitle:!0,title:this.t("msgQuantity.title"),showCloseButton:!1,width:"350px",height:"250px",button:[{id:"btn01",caption:this.t("msgQuantity.btn01"),location:"after"}]},O.createElement("div",{className:"row"},O.createElement("div",{className:"col-12 py-2"},O.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgQuantity.msg"))),O.createElement("div",{className:"col-12 py-2"},O.createElement(x(),null,O.createElement(g.Item,null,O.createElement(g.Label,{text:this.t("txtQuantity"),alignment:"right"}),O.createElement(w.ZP,{id:"txtPopQuantity",parent:this,simple:!0,onEnterKey:function(){var t=(0,c.Z)(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.msgQuantity._onClick();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}().bind(this)}))))),O.createElement("div",{className:"row"})),O.createElement(S.Z,{id:"pg_txtBarcode",parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,width:"90%",height:"90%",title:this.t("pg_txtBarcode.title"),search:!0},O.createElement(k.sg,{dataField:"BARCODE",caption:this.t("pg_txtBarcode.clmBarcode"),width:150}),O.createElement(k.sg,{dataField:"CODE",caption:this.t("pg_txtBarcode.clmCode"),width:150}),O.createElement(k.sg,{dataField:"NAME",caption:this.t("pg_txtBarcode.clmName"),width:300,defaultSortOrder:"asc"}),O.createElement(k.sg,{dataField:"MULTICODE",caption:this.t("pg_txtBarcode.clmMulticode"),width:200})),O.createElement(S.Z,{id:"pg_proformaGrid",parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,width:"90%",height:"90%",selection:{mode:"multiple"},title:this.t("pg_proformaGrid.title")},O.createElement(k.sg,{dataField:"REFERANS",caption:this.t("pg_proformaGrid.clmReferans"),width:200,defaultSortOrder:"asc"}),O.createElement(k.sg,{dataField:"ITEM_CODE",caption:this.t("pg_proformaGrid.clmCode"),width:200}),O.createElement(k.sg,{dataField:"ITEM_NAME",caption:this.t("pg_proformaGrid.clmName"),width:450}),O.createElement(k.sg,{dataField:"QUANTITY",caption:this.t("pg_proformaGrid.clmQuantity"),width:200}),O.createElement(k.sg,{dataField:"PRICE",caption:this.t("pg_proformaGrid.clmPrice"),width:200}),O.createElement(k.sg,{dataField:"TOTAL",caption:this.t("pg_proformaGrid.clmTotal"),width:200})),O.createElement(S.Z,{id:"pg_adress",parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,width:"90%",height:"90%",title:this.t("pg_adress.title")},O.createElement(k.sg,{dataField:"ADRESS",caption:this.t("pg_adress.clmAdress"),width:250}),O.createElement(k.sg,{dataField:"CITY",caption:this.t("pg_adress.clmCiyt"),width:150}),O.createElement(k.sg,{dataField:"ZIPCODE",caption:this.t("pg_adress.clmZipcode"),width:300,defaultSortOrder:"asc"}),O.createElement(k.sg,{dataField:"COUNTRY",caption:this.t("pg_adress.clmCountry"),width:200}))))}}]),X}(O.PureComponent)}}]);