"use strict";(self.webpackChunkwww=self.webpackChunkwww||[]).push([[4746],{44746:(t,e,n)=>{n.r(e),n.d(e,{default:()=>N});var a=n(4942),i=n(15861),r=n(15671),s=n(43144),l=n(60136),c=n(82963),o=n(61120),u=n(64687),E=n.n(u),d=n(67294),m=n(73364),p=n(5577),h=(n(30381),n(42866)),f=n.n(h),b=n(53221),x=n.n(b),S=n(25552),g=n.n(S),v=(n(91686),n(30886),n(99846)),C=n(5083),I=(n(99077),n(55585),n(417)),O=(n(32175),n(18405)),R=n(73682),y=(n(90428),n(57941),n(60547)),P=n(17276);function D(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?D(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n(51166);var N=function(t){(0,l.Z)(b,t);var e,n,a,u,h=(a=b,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=(0,o.Z)(a);if(u){var n=(0,o.Z)(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return(0,c.Z)(this,t)});function b(t){var e;return(0,r.Z)(this,b),(e=h.call(this,t)).core=m.Z.instance.core,e.prmObj=e.param.filter({TYPE:1,USERS:e.user.CODE}),e.acsobj=e.access.filter({TYPE:1,USERS:e.user.CODE}),e.prilabelCls=new p.Pb,e.labelMainObj=new p.f5,e.tabIndex=t.data.tabkey,e}return(0,s.Z)(b,[{key:"componentDidMount",value:(n=(0,i.Z)(E().mark((function t(){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.core.util.waitUntil(0);case 2:this.init();case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"init",value:(e=(0,i.Z)(E().mark((function t(){var e=this;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.prilabelCls.clearAll(),this.labelMainObj.clearAll(),this.txtRef.value="",this.txtItemName.value="",this.txtPrice.value=0,this.txtQuantity.value=1,this.txtDescription.value="",this.btnNew.setState({disabled:!1}),this.btnSave.setState({disabled:!1}),this.btnPrint.setState({disabled:!0}),this.prilabelCls.ds.on("onAddRow",(function(t,n){"new"==n.stat&&(e.btnNew.setState({disabled:!1}),e.btnSave.setState({disabled:!0}),e.btnPrint.setState({disabled:!0}))})),this.prilabelCls.ds.on("onEdit",(function(t,n){"edit"==n.rowData.stat&&(e.btnNew.setState({disabled:!0}),e.btnSave.setState({disabled:!1}),e.btnPrint.setState({disabled:!0}),n.rowData.CUSER=e.user.CODE)})),this.prilabelCls.ds.on("onRefresh",(function(t){e.btnNew.setState({disabled:!1}),e.btnSave.setState({disabled:!0}),e.btnPrint.setState({disabled:!0})})),this.txtBarkod.readOnly=!1,this.txtItemName.readOnly=!1,this.txtPrice.readOnly=!1,this.txtDescription.readOnly=!1,this.txtQuantity.readOnly=!1;case 18:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"render",value:function(){var t,e=this;return d.createElement("div",null,d.createElement(f(),null,d.createElement("div",{className:"row px-2 pt-2"},d.createElement("div",{className:"col-12"},d.createElement(x(),null,d.createElement(S.Item,{location:"after",locateInMenu:"auto"},d.createElement(R.Z,{id:"btnNew",parent:this,icon:"file",type:"default",onClick:function(){e.init()}})),d.createElement(S.Item,{location:"after",locateInMenu:"auto"},d.createElement(R.Z,{id:"btnSave",parent:this,icon:"floppy",type:"default",validationGroup:"frmPriLabel"+this.tabIndex,onClick:function(){var t=(0,i.Z)(E().mark((function t(n){var a,i,r,s,l,c,o,u,m,p,h,f,b,x,S,g,v,C,I;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("valid"!=n.validationGroup.validate().status){t.next=45;break}if(!(e.txtItemName.value.length>49)){t.next=6;break}return a={id:"msgItemName",showTitle:!0,title:e.t("msgItemName.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.t("msgItemName.btn01"),location:"after"}],content:d.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},e.t("msgItemName.msg"))},t.next=5,(0,y.W)(a);case 5:return t.abrupt("return");case 6:return i={id:"msgSave",showTitle:!0,title:e.t("msgSave.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.t("msgSave.btn01"),location:"before"},{id:"btn02",caption:e.t("msgSave.btn02"),location:"after"}],content:d.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},e.t("msgSave.msg"))},t.next=9,(0,y.W)(i);case 9:if("btn01"!=t.sent){t.next=43;break}return r={query:"SELECT ISNULL(REPLACE(STR(SUBSTRING(MAX(CODE),0,8) + 1, 7), SPACE(1), '0'),'2700001') AS CODE FROM ITEM_UNIQ WHERE CODE LIKE '27%' "},t.next=14,e.core.sql.execute(r);case 14:if((s=t.sent).result.recordset.length>0)for(l=s.result.recordset[0].CODE,c=0;c<e.txtQuantity.value;c++){for(l=l.toString(),u=[],m=0,p=l.length;m<p;m+=1)u.push(+l.charAt(m));h=3*(u[0]+u[2]+u[4]+u[6]),f=u[1]+u[3]+u[5],b=h+f,10==(x=10-(b%=10))&&(x=0),o=l+x.toString(),(S=w({},e.prilabelCls.empty)).CODE=o,S.ITEM=e.txtRef.GUID,S.NAME=e.txtItemName.value,S.PRICE=e.txtPrice.value,S.DESCRIPTION=e.txtDescription.value,e.prilabelCls.addEmpty(S),l=Number(l)+1}return g={id:"msgSaveResult",showTitle:!0,title:e.t("msgSave.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.t("msgSave.btn01"),location:"after"}]},t.next=19,e.prilabelCls.save();case 19:if(t.t0=t.sent,0!=t.t0){t.next=40;break}return v={data:e.prilabelCls.dt().toArray()},(C=w({},e.labelMainObj.empty)).REF="SPECIAL",C.DATA=JSON.stringify(v),e.labelMainObj.addEmpty(C),e.labelMainObj.save(),e.btnSave.setState({disabled:!0}),e.btnNew.setState({disabled:!1}),e.btnPrint.setState({disabled:!1}),g.content=d.createElement("div",{style:{textAlign:"center",fontSize:"20px",color:"green"}},e.t("msgSaveResult.msgSuccess")),t.next=33,(0,y.W)(g);case 33:e.txtBarkod.readOnly=!0,e.txtItemName.readOnly=!0,e.txtPrice.readOnly=!0,e.txtDescription.readOnly=!0,e.txtQuantity.readOnly=!0,t.next=43;break;case 40:return g.content=d.createElement("div",{style:{textAlign:"center",fontSize:"20px",color:"red"}},e.t("msgSaveResult.msgFailed")),t.next=43,(0,y.W)(g);case 43:t.next=48;break;case 45:return I={id:"msgSaveValid",showTitle:!0,title:e.t("msgSaveValid.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.t("msgSaveValid.btn01"),location:"after"}],content:d.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},e.t("msgSaveValid.msg"))},t.next=48,(0,y.W)(I);case 48:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),d.createElement(S.Item,{location:"after",locateInMenu:"auto"},d.createElement(R.Z,{id:"btnPrint",parent:this,icon:"print",type:"default",onClick:(0,i.Z)(E().mark((function t(){var n,a;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={query:"SELECT *, ISNULL((SELECT TOP 1 PATH FROM LABEL_DESIGN WHERE PAGE = @PAGE),'') AS PATH FROM  ITEM_LABEL_QUEUE_VW_01 WHERE GUID  = @GUID",param:["GUID:string|50","PAGE:string|25"],value:[e.labelMainObj.dt()[0].GUID,"02"]},m.Z.instance.setState({isExecute:!0}),t.next=4,e.core.sql.execute(n);case 4:a=t.sent,m.Z.instance.setState({isExecute:!1}),e.core.socket.emit("devprint","{TYPE:'REVIEW',PATH:'"+a.result.recordset[0].PATH.replaceAll("\\","/")+"',DATA:"+JSON.stringify(a.result.recordset)+"}",(function(t){if("ERR"!=t.split("|")[0]){var e=window.open("printview.html","_blank","width=900,height=1000,left=500");e.onload=function(){e.document.getElementById("view").innerHTML="<iframe src='data:application/pdf;base64,"+t.split("|")[1]+"' type='application/pdf' width='100%' height='100%'></iframe>"}}}));case 7:case"end":return t.stop()}}),t)})))})),d.createElement(S.Item,{location:"after",locateInMenu:"auto",widget:"dxButton",options:{type:"default",icon:"clear",onClick:(t=(0,i.Z)(E().mark((function t(){var n;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={id:"msgClose",showTitle:!0,title:e.lang.t("msgWarning"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.lang.t("btnYes"),location:"before"},{id:"btn02",caption:e.lang.t("btnNo"),location:"after"}],content:d.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},e.lang.t("msgClose"))},t.next=3,(0,y.W)(n);case 3:"btn01"==t.sent&&m.Z.instance.panel.closePage();case 5:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}})))),d.createElement("div",{className:"row px-2 pt-2"},d.createElement("div",{className:"col-9"},d.createElement(g(),{colCount:2,id:"frmPriLabel"+this.tabIndex},d.createElement(S.Item,null,d.createElement(S.Label,{text:this.t("txtBarkod"),alignment:"right"}),d.createElement(v.ZP,{id:"txtBarkod",parent:this,simple:!0,tabIndex:this.tabIndex,onChange:(0,i.Z)(E().mark((function t(){var n;return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=new P.$A).selectCmd={query:"SELECT ITEM_GUID AS GUID,ITEM_CODE AS CODE,ITEM_NAME AS NAME,[dbo].[FN_PRICE_SALE](ITEM_GUID,1,GETDATE(),'00000000-0000-0000-0000-000000000000') AS PRICE FROM [ITEM_BARCODE_VW_01] WHERE BARCODE = @BARCODE ",param:["BARCODE:string|50"],value:[e.txtBarkod.value]},t.next=4,n.refresh();case 4:n.length>0&&(e.txtRef.value=n[0].CODE,e.txtItemName.value=n[0].NAME,e.txtRef.GUID=n[0].GUID,e.txtPrice.value=n[0].PRICE,e.txtBarkod.value="");case 5:case"end":return t.stop()}}),t)}))).bind(this),param:this.param.filter({ELEMENT:"txtBarkod",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtBarkod",USERS:this.user.CODE}),selectAll:!0})),d.createElement(S.EmptyItem,null),d.createElement(S.Item,null,d.createElement(S.Label,{text:this.t("txtRef"),alignment:"right"}),d.createElement(v.ZP,{id:"txtRef",parent:this,simple:!0,tabIndex:this.tabIndex,readOnly:!0,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,button:[{id:"01",icon:"more",onClick:function(){e.pg_txtRef.show(),e.pg_txtRef.onClick=function(t){t.length>0&&(e.txtRef.value=t[0].CODE,e.txtItemName.value=t[0].NAME,e.txtRef.GUID=t[0].GUID,e.txtPrice.value=t[0].PRICE)}}}],onChange:(0,i.Z)(E().mark((function t(){return E().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))).bind(this),param:this.param.filter({ELEMENT:"txtRef",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtRef",USERS:this.user.CODE}),selectAll:!0},d.createElement(v.cX,{validationGroup:"frmPriLabel"+this.tabIndex},d.createElement(v.n2,{message:this.t("valCode")}))),d.createElement(I.Z,{id:"pg_txtRef",parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,width:"90%",height:"90%",title:this.t("pg_txtRef.title"),search:!0,data:{source:{select:{query:"SELECT GUID,CODE,NAME,[dbo].[FN_PRICE_SALE](GUID,1,GETDATE(),'00000000-0000-0000-0000-000000000000') AS PRICE FROM ITEMS_VW_01 WHERE UPPER(CODE) LIKE UPPER(@VAL) OR UPPER(NAME) LIKE UPPER(@VAL) AND STATUS = 1",param:["VAL:string|50"]},sql:this.core.sql}},button:[{id:"tst",icon:"more",onClick:function(){}}]},d.createElement(O.sg,{dataField:"CODE",caption:this.t("pg_txtRef.clmCode"),width:150}),d.createElement(O.sg,{dataField:"NAME",caption:this.t("pg_txtRef.clmName"),width:500,defaultSortOrder:"asc"}),d.createElement(O.sg,{dataField:"PRICE",caption:this.t("pg_txtRef.clmPrice"),width:150,type:"text"}))),d.createElement(S.Item,null,d.createElement(S.Label,{text:this.t("txtItemName"),alignment:"right"}),d.createElement(v.ZP,{id:"txtItemName",parent:this,simple:!0,param:this.param.filter({ELEMENT:"txtItemName",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtItemName",USERS:this.user.CODE}),upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,onValueChanged:function(t){}},d.createElement(v.cX,{validationGroup:"frmPriLabel"+this.tabIndex},d.createElement(v.n2,{message:this.t("valName")})))),d.createElement(S.Item,null,d.createElement(S.Label,{text:this.t("txtPrice"),alignment:"right"}),d.createElement(C.ZP,{id:"txtPrice",parent:this,simple:!0,dt:{data:this.prilabelCls.dt("ITEM_UNIQ"),field:"PRICE"},param:this.param.filter({ELEMENT:"txtPrice",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtPrice",USERS:this.user.CODE}),onValueChanged:function(t){}},d.createElement(v.cX,{validationGroup:"frmPriLabel"+this.tabIndex},d.createElement(v.Qh,{min:.001,message:this.t("valPrice")})))),d.createElement(S.Item,null,d.createElement(S.Label,{text:this.t("txtDescription"),alignment:"right"}),d.createElement(v.ZP,{id:"txtDescription",parent:this,simple:!0,dt:{data:this.prilabelCls.dt("ITEM_UNIQ"),field:"DESCRIPTION"},param:this.param.filter({ELEMENT:"txtDescription",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtDescription",USERS:this.user.CODE}),upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,onValueChanged:function(t){}})),d.createElement(S.Item,null,d.createElement(S.Label,{text:this.t("txtQuantity"),alignment:"right"}),d.createElement(v.ZP,{id:"txtQuantity",parent:this,simple:!0,param:this.param.filter({ELEMENT:"txtQuantity",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtQuantity",USERS:this.user.CODE}),upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,onValueChanged:function(t){}})))))))}}]),b}(d.PureComponent)}}]);