"use strict";(self.webpackChunkwww=self.webpackChunkwww||[]).push([[2555],{92555:(t,e,n)=>{n.r(e),n.d(e,{default:()=>D});var a=n(15861),i=n(15671),r=n(43144),s=n(60136),o=n(82963),c=n(61120),l=n(64687),d=n.n(l),u=n(67294),p=n(73364),f=n(9972),h=(n(30381),n(42866)),m=n.n(h),b=n(53221),E=n.n(b),g=n(25552),x=n.n(g),S=(n(91686),n(30886),n(99846)),v=(n(5083),n(99077)),C=(n(55585),n(417)),w=(n(32175),n(18405)),y=n(73682),k=(n(90428),n(57941),n(60547));n(17276);var D=function(t){(0,s.Z)(A,t);var e,n,l,h,b,D,O=(b=A,D=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=(0,c.Z)(b);if(D){var n=(0,c.Z)(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return(0,o.Z)(this,t)});function A(t){var e;return(0,i.Z)(this,A),(e=O.call(this,t)).core=p.Z.instance.core,e.prmObj=e.param.filter({TYPE:1,USERS:e.user.CODE}),e.safeObj=new f.B,e.prevCode="",e.tabIndex=t.data.tabkey,e}return(0,r.Z)(A,[{key:"componentDidMount",value:(h=(0,a.Z)(d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.core.util.waitUntil(0);case 2:this.init();case 3:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})},{key:"init",value:(l=(0,a.Z)(d().mark((function t(){var e=this;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.safeObj.clearAll(),this.safeObj.addEmpty(),this.safeObj.ds.on("onAddRow",(function(t,n){"new"==n.stat&&(""!=e.prevCode?(e.btnNew.setState({disabled:!0}),e.btnBack.setState({disabled:!1})):(e.btnNew.setState({disabled:!1}),e.btnBack.setState({disabled:!0})),e.btnSave.setState({disabled:!1}),e.btnDelete.setState({disabled:!1}),e.btnCopy.setState({disabled:!1}),e.btnPrint.setState({disabled:!1}))})),this.safeObj.ds.on("onEdit",(function(t,n){"edit"==n.rowData.stat&&(e.btnBack.setState({disabled:!1}),e.btnNew.setState({disabled:!0}),e.btnSave.setState({disabled:!1}),e.btnDelete.setState({disabled:!1}),e.btnCopy.setState({disabled:!1}),e.btnPrint.setState({disabled:!1}),n.rowData.CUSER=e.user.CODE)})),this.safeObj.ds.on("onRefresh",(function(t){e.prevCode=e.safeObj.dt("SAFE").length>0?e.safeObj.dt("SAFE")[0].CODE:"",e.btnBack.setState({disabled:!0}),e.btnNew.setState({disabled:!1}),e.btnSave.setState({disabled:!0}),e.btnDelete.setState({disabled:!1}),e.btnCopy.setState({disabled:!1}),e.btnPrint.setState({disabled:!1})})),this.safeObj.ds.on("onDelete",(function(t){e.btnBack.setState({disabled:!1}),e.btnNew.setState({disabled:!0}),e.btnSave.setState({disabled:!1}),e.btnDelete.setState({disabled:!1}),e.btnCopy.setState({disabled:!1}),e.btnPrint.setState({disabled:!1})}));case 6:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"getSafe",value:(n=(0,a.Z)(d().mark((function t(e){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.safeObj.clearAll(),t.next=3,this.safeObj.load({CODE:e});case 3:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"checkSafe",value:(e=(0,a.Z)(d().mark((function t(e){var n=this;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=(0,a.Z)(d().mark((function t(a){var i,r;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""===e){t.next=16;break}return i={query:"SELECT * FROM SAFE_VW_01 WHERE CODE = @CODE",param:["CODE:string|50"],value:[e]},t.next=4,n.core.sql.execute(i);case 4:if(!(t.sent.result.recordset.length>0)){t.next=13;break}return r={id:"msgCode",showTitle:!0,title:n.t("msgCode.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgCode.btn01"),location:"before"},{id:"btn02",caption:n.t("msgCode.btn02"),location:"after"}],content:u.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgCode.msg"))},t.next=9,(0,k.W)(r);case 9:"btn01"==t.sent?(n.getSafe(e),a(2)):a(3),t.next=14;break;case 13:a(1);case 14:t.next=17;break;case 16:a(0);case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})},{key:"render",value:function(){var t,e=this;return u.createElement("div",null,u.createElement(m(),null,u.createElement("div",{className:"row px-2 pt-2"},u.createElement("div",{className:"col-12"},u.createElement(E(),null,u.createElement(g.Item,{location:"after",locateInMenu:"auto"},u.createElement(y.Z,{id:"btnBack",parent:this,icon:"revert",type:"default",onClick:function(){""!=e.prevCode&&e.getSafe(e.prevCode)}})),u.createElement(g.Item,{location:"after",locateInMenu:"auto"},u.createElement(y.Z,{id:"btnNew",parent:this,icon:"file",type:"default",onClick:function(){console.log(132),e.init()}})),u.createElement(g.Item,{location:"after",locateInMenu:"auto"},u.createElement(y.Z,{id:"btnSave",parent:this,icon:"floppy",type:"default",validationGroup:"frmSafe"+this.tabIndex,onClick:function(){var t=(0,a.Z)(d().mark((function t(n){var a,i,r;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("valid"!=n.validationGroup.validate().status){t.next=22;break}return a={id:"msgSave",showTitle:!0,title:e.t("msgSave.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.t("msgSave.btn01"),location:"before"},{id:"btn02",caption:e.t("msgSave.btn02"),location:"after"}],content:u.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},e.t("msgSave.msg"))},t.next=4,(0,k.W)(a);case 4:if("btn01"!=t.sent){t.next=20;break}return i={id:"msgSaveResult",showTitle:!0,title:e.t("msgSave.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.t("msgSave.btn01"),location:"after"}]},t.next=9,e.safeObj.save();case 9:if(t.t0=t.sent,0!=t.t0){t.next=17;break}return i.content=u.createElement("div",{style:{textAlign:"center",fontSize:"20px",color:"green"}},e.t("msgSaveResult.msgSuccess")),t.next=14,(0,k.W)(i);case 14:e.init(),t.next=20;break;case 17:return i.content=u.createElement("div",{style:{textAlign:"center",fontSize:"20px",color:"red"}},e.t("msgSaveResult.msgFailed")),t.next=20,(0,k.W)(i);case 20:t.next=25;break;case 22:return r={id:"msgSaveValid",showTitle:!0,title:e.t("msgSaveValid.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.t("msgSaveValid.btn01"),location:"after"}],content:u.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},e.t("msgSaveValid.msg"))},t.next=25,(0,k.W)(r);case 25:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),u.createElement(g.Item,{location:"after",locateInMenu:"auto"},u.createElement(y.Z,{id:"btnDelete",parent:this,icon:"trash",type:"default",onClick:(0,a.Z)(d().mark((function t(){var n;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={id:"msgDelete",showTitle:!0,title:e.t("msgDelete.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.t("msgDelete.btn01"),location:"before"},{id:"btn02",caption:e.t("msgDelete.btn02"),location:"after"}],content:u.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},e.t("msgDelete.msg"))},t.next=3,(0,k.W)(n);case 3:if("btn01"!=t.sent){t.next=9;break}return e.safeObj.dt("SAFE").removeAt(0),t.next=8,e.safeObj.dt("SAFE").delete();case 8:e.init();case 9:case"end":return t.stop()}}),t)})))})),u.createElement(g.Item,{location:"after",locateInMenu:"auto"},u.createElement(y.Z,{id:"btnCopy",parent:this,icon:"copy",type:"default",onClick:function(){}})),u.createElement(g.Item,{location:"after",locateInMenu:"auto"},u.createElement(y.Z,{id:"btnPrint",parent:this,icon:"print",type:"default",onClick:function(){e.popDesign.show()}})),u.createElement(g.Item,{location:"after",locateInMenu:"auto",widget:"dxButton",options:{type:"default",icon:"clear",onClick:(t=(0,a.Z)(d().mark((function t(){var n;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={id:"msgClose",showTitle:!0,title:e.lang.t("msgWarning"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.lang.t("btnYes"),location:"before"},{id:"btn02",caption:e.lang.t("btnNo"),location:"after"}],content:u.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},e.lang.t("msgClose"))},t.next=3,(0,k.W)(n);case 3:"btn01"==t.sent&&p.Z.instance.panel.closePage();case 5:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}})))),u.createElement("div",{className:"row px-2 pt-2"},u.createElement("div",{className:"col-12"},u.createElement(x(),{colCount:3,id:"frmSafe"},u.createElement(g.Item,null,u.createElement(g.Label,{text:this.t("txtCode"),alignment:"right"}),u.createElement(S.ZP,{id:"txtCode",parent:this,simple:!0,dt:{data:this.safeObj.dt("SAFE"),field:"CODE"},upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,button:[{id:"01",icon:"more",onClick:function(){e.pg_txtCode.show(),e.pg_txtCode.onClick=function(t){t.length>0&&e.getSafe(t[0].CODE)}}},{id:"02",icon:"arrowdown",onClick:function(){e.txtCode.value=Math.floor(Date.now()/1e3)}}],onChange:(0,a.Z)(d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.checkSafe(e.txtCode.value);case 2:3==t.sent&&(e.txtCode.value="");case 4:case"end":return t.stop()}}),t)}))).bind(this),param:this.param.filter({ELEMENT:"txtCode",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtCode",USERS:this.user.CODE})},u.createElement(S.cX,{validationGroup:"frmSafe"+this.tabIndex},u.createElement(S.n2,{message:this.t("validCode")}))),u.createElement(C.Z,{id:"pg_txtCode",parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,width:"90%",height:"90%",title:this.t("pg_txtCode.title"),data:{source:{select:{query:"SELECT CODE,NAME,TYPE_NAME FROM SAFE_VW_01"},sql:this.core.sql}},button:{id:"01",icon:"more",onClick:function(){console.log(1111)}}},u.createElement(w.sg,{dataField:"CODE",caption:this.t("pg_txtCode.clmCode"),width:150}),u.createElement(w.sg,{dataField:"NAME",caption:this.t("pg_txtCode.clmName"),width:300,defaultSortOrder:"asc"}),u.createElement(w.sg,{dataField:"TYPE_NAME",caption:this.t("pg_txtCode.clmType"),width:300,defaultSortOrder:"asc"}))),u.createElement(g.Item,null,u.createElement(g.Label,{text:this.t("txtName"),alignment:"right"}),u.createElement(S.ZP,{id:"txtTitle",parent:this,simple:!0,dt:{data:this.safeObj.dt("SAFE"),field:"NAME"},upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,onChange:(0,a.Z)(d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))).bind(this),param:this.param.filter({ELEMENT:"txtName",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtName",USERS:this.user.CODE})})),u.createElement(g.EmptyItem,null),u.createElement(g.Item,null,u.createElement(g.Label,{text:this.t("cmbType"),alignment:"right"}),u.createElement(v.ZP,{simple:!0,parent:this,id:"cmbType",height:"fit-content",dt:{data:this.safeObj.dt("SAFE"),field:"TYPE"},displayExpr:"VALUE",valueExpr:"ID",data:{source:[{ID:0,VALUE:this.t("cmbTypeData.cash")},{ID:1,VALUE:this.t("cmbTypeData.check")},{ID:2,VALUE:this.t("cmbTypeData.pos")}]},onValueChanged:(0,a.Z)(d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))).bind(this)})))))))}}]),A}(u.PureComponent)}}]);