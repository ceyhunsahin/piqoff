"use strict";(self.webpackChunkwww=self.webpackChunkwww||[]).push([[3949],{51559:(t,e,n)=>{n.d(e,{ZP:()=>p});var a=n(15861),i=n(15671),r=n(43144),s=n(97326),o=n(60136),c=n(82963),l=n(61120),d=n(64687),m=n.n(d),u=n(67294),h=n(11694),E=n.n(h);var p=function(t){(0,o.Z)(p,t);var e,n,d,h=(n=p,d=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=(0,l.Z)(n);if(d){var a=(0,l.Z)(this).constructor;t=Reflect.construct(e,arguments,a)}else t=e.apply(this,arguments);return(0,c.Z)(this,t)});function p(t){var e;return(0,i.Z)(this,p),(e=h.call(this,t)).dev=null,e.state.value=void 0!==t.value?t.value:"",e.state.placeholder=void 0===t.placeholder?"":t.placeholder,e._onInitialized=e._onInitialized.bind((0,s.Z)(e)),e._onValueChanged=e._onValueChanged.bind((0,s.Z)(e)),e}return(0,r.Z)(p,[{key:"_onInitialized",value:function(t){this.dev=t.component}},{key:"_TagBoxView",value:function(){return u.createElement(E(),{id:this.props.id,items:[],acceptCustomValue:!0,onValueChanged:this._onValueChanged,placeholder:this.state.placeholder,openOnFieldClick:!1,showClearButton:!0,maxFilterQueryLength:1e4,noDataText:""},this.props.children,this.validationView())}},{key:"_onValueChanged",value:function(t){this.value=t.value,void 0!==this.props.onValueChanged&&this.props.onValueChanged(t)}},{key:"value",get:function(){return this.state.value},set:function(t){var e=this;if(void 0!==t){if(void 0!==this.props.dt&&void 0!==this.props.dt.data&&this.props.dt.data.length>0&&void 0!==this.props.dt.field)if(void 0===this.props.dt.filter)void 0!==this.props.dt.row&&void 0!==this.props.dt.data.find((function(t){return t===e.props.dt.row}))?(this.props.dt.data.find((function(t){return t===e.props.dt.row}))[this.props.dt.field]=t,void 0!==this.props.dt.display&&(this.props.dt.data.find((function(t){return t===e.props.dt.row}))[this.props.dt.display]=this.displayValue)):(this.props.dt.data[this.props.dt.data.length-1][this.props.dt.field]=t,void 0!==this.props.dt.display&&(this.props.dt.data[this.props.dt.data.length-1][this.props.dt.display]=this.displayValue));else{var n=this.props.dt.data.where(this.props.dt.filter);n.length>0&&(void 0!==this.props.dt.row&&void 0!==n.find((function(t){return t===e.props.dt.row}))?(n.find((function(t){return t===e.props.dt.row}))[this.props.dt.field]=t,void 0!==this.props.dt.display&&(n.find((function(t){return t===e.props.dt.row}))[this.props.dt.display]=this.displayValue)):(n[n.length-1][this.props.dt.field]=t,void 0!==this.props.dt.display&&(n[n.length-1][this.props.dt.display]=this.displayValue)))}this.setState({value:null==t?"":t})}}},{key:"displayValue",get:function(){return this.dev.option("displayValue")}},{key:"componentDidMount",value:(e=(0,a.Z)(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===this.state.data){t.next=3;break}return t.next=3,this.dataRefresh(this.state.data);case 3:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"render",value:function(){return void 0!==this.props.simple&&this.props.simple?this._TagBoxView():u.createElement("div",{className:"dx-field"},u.createElement("div",{className:"dx-field-label"},void 0===this.props.title?"":this.props.title),u.createElement("div",{className:"dx-field-value"},this._TagBoxView()))}}]),p}(n(20819).ZP)},93949:(t,e,n)=>{n.r(e),n.d(e,{default:()=>G});var a=n(71002),i=n(4942),r=n(15861),s=n(15671),o=n(43144),c=n(97326),l=n(60136),d=n(82963),m=n(61120),u=n(64687),h=n.n(u),E=n(30381),p=n.n(E),b=n(67294),O=n(73364),I=n(4598),T=n(42866),f=n.n(T),g=n(53221),C=n.n(g),x=n(25552),v=n.n(x),D=n(65580),w=n.n(D),N=(n(91686),n(30886)),y=n(99846),P=n(5083),S=n(99077),R=n(55585),U=n(417),A=n(32175),_=n(18405),j=n(73682),k=n(90428),M=(n(57941),n(51559)),L=n(60547),F=n(17276);function V(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function Z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?V(Object(n),!0).forEach((function(e){(0,i.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}n(51166);var G=function(t){(0,l.Z)(K,t);var e,n,i,u,E,T,g,D,V,G,B,Y,W,Q,q,H,z=(q=K,H=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=(0,m.Z)(q);if(H){var n=(0,m.Z)(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return(0,d.Z)(this,t)});function K(t){var e;return(0,s.Z)(this,K),(e=z.call(this,t)).core=O.Z.instance.core,e.prmObj=e.param.filter({TYPE:1,USERS:e.user.CODE}),e.acsobj=e.access.filter({TYPE:1,USERS:e.user.CODE}),e.docObj=new I.Ch,e.paymentObj=new I.Ch,e.tabIndex=t.data.tabkey,e.quantityControl=!1,e._cellRoleRender=e._cellRoleRender.bind((0,c.Z)(e)),e._calculateTotal=e._calculateTotal.bind((0,c.Z)(e)),e._getDispatch=e._getDispatch.bind((0,c.Z)(e)),e._getPayment=e._getPayment.bind((0,c.Z)(e)),e._calculateTotalMargin=e._calculateTotalMargin.bind((0,c.Z)(e)),e._calculateMargin=e._calculateMargin.bind((0,c.Z)(e)),e._addPayment=e._addPayment.bind((0,c.Z)(e)),e.frmSalesInv=void 0,e.docLocked=!1,e.combineControl=!0,e.combineNew=!1,e.rightItems=[{text:e.t("getDispatch")},{text:e.t("getPayment")}],e.multiItemData=new F.$A,e}return(0,o.Z)(K,[{key:"componentDidMount",value:(Q=(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.core.util.waitUntil(0);case 2:this.init(),void 0!==this.pagePrm&&this.getDoc(this.pagePrm.GUID,"",0);case 4:case"end":return t.stop()}}),t,this)}))),function(){return Q.apply(this,arguments)})},{key:"init",value:(W=(0,r.Z)(h().mark((function t(){var e,n,a=this;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.docObj.clearAll(),this.paymentObj.clearAll(),this.docObj.ds.on("onAddRow",(function(t,e){"new"==e.stat&&(a.btnNew.setState({disabled:!1}),a.btnBack.setState({disabled:!1}),a.btnNew.setState({disabled:!1}),a.btnBack.setState({disabled:!0}),a.btnSave.setState({disabled:!1}),a.btnDelete.setState({disabled:!1}),a.btnCopy.setState({disabled:!1}),a.btnPrint.setState({disabled:!1}))})),this.docObj.ds.on("onEdit",(function(t,e){"edit"==e.rowData.stat&&(a.btnBack.setState({disabled:!1}),a.btnNew.setState({disabled:!0}),a.btnSave.setState({disabled:!1}),a.btnDelete.setState({disabled:!1}),a.btnCopy.setState({disabled:!1}),a.btnPrint.setState({disabled:!1}),e.rowData.CUSER=a.user.CODE)})),this.docObj.ds.on("onRefresh",(function(t){a.btnBack.setState({disabled:!0}),a.btnNew.setState({disabled:!1}),a.btnSave.setState({disabled:!1}),a.btnDelete.setState({disabled:!1}),a.btnCopy.setState({disabled:!1}),a.btnPrint.setState({disabled:!1})})),this.docObj.ds.on("onDelete",(function(t){a.btnBack.setState({disabled:!1}),a.btnNew.setState({disabled:!1}),a.btnSave.setState({disabled:!1}),a.btnDelete.setState({disabled:!1}),a.btnCopy.setState({disabled:!1}),a.btnPrint.setState({disabled:!1})})),this.dtDocDate.value=p()(new Date),this.dtShipDate.value=p()(new Date),this.quantityControl=this.prmObj.filter({ID:"negativeQuantity",USERS:this.user.CODE}).getValue().value,(e=Z({},this.docObj.empty)).TYPE=1,e.DOC_TYPE=20,this.docObj.addEmpty(e),(n=Z({},this.docObj.docCustomer.empty)).DOC_GUID=this.docObj.dt()[0].GUID,n.TYPE=this.docObj.dt()[0].TYPE,n.DOC_TYPE=this.docObj.dt()[0].DOC_TYPE,n.REBATE=this.docObj.dt()[0].REBATE,n.DOC_DATE=this.docObj.dt()[0].DOC_DATE,this.docObj.docCustomer.addEmpty(n),this.txtRef.readOnly=!1,this.txtRefno.readOnly=!1,this.docLocked=!1,this.frmSalesInv.option("disabled",!1),t.next=26,this.grdSlsInv.dataRefresh({source:this.docObj.docItems.dt("DOC_ITEMS")});case 26:return t.next=28,this.grdInvoicePayment.dataRefresh({source:this.paymentObj.docCustomer.dt()});case 28:return t.next=30,this.grdMultiItem.dataRefresh({source:this.multiItemData});case 30:case"end":return t.stop()}}),t,this)}))),function(){return W.apply(this,arguments)})},{key:"getDoc",value:(Y=(0,r.Z)(h().mark((function t(e,n,a){var i;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.docObj.clearAll(),this.paymentObj.clearAll(),t.next=4,this.docObj.load({GUID:e,REF:n,REF_NO:a,TYPE:1,DOC_TYPE:20});case 4:if(this._calculateMargin(),this._calculateTotalMargin(),this.txtRef.readOnly=!0,this.txtRefno.readOnly=!0,0==this.docObj.dt()[0].LOCKED){t.next=16;break}return this.docLocked=!0,i={id:"msgGetLocked",showTitle:!0,title:this.t("msgGetLocked.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:this.t("msgGetLocked.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgGetLocked.msg"))},t.next=13,(0,L.W)(i);case 13:this.frmSalesInv.option("disabled",!0),t.next=18;break;case 16:this.docLocked=!1,this.frmSalesInv.option("disabled",!1);case 18:this._getPayment(this.docObj.dt()[0].GUID);case 19:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return Y.apply(this,arguments)})},{key:"checkDoc",value:(B=(0,r.Z)(h().mark((function t(e,n,a){var i=this;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=(0,r.Z)(h().mark((function t(r){var s;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""===n){t.next=15;break}return t.next=3,(new I.Ch).load({GUID:e,REF:n,REF_NO:a});case 3:if(!(t.sent.length>0)){t.next=12;break}return s={id:"msgCode",showTitle:!0,title:"Dikkat",showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:"Evrağa Git",location:"before"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},"Evrak Bulundu")},t.next=8,(0,L.W)(s);case 8:"btn01"==t.sent?(i.getDoc(e,n,a),r(2)):r(3),t.next=13;break;case 12:r(1);case 13:t.next=16;break;case 15:r(0);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)}))),function(t,e,n){return B.apply(this,arguments)})},{key:"_calculateTotal",value:(G=(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.docObj.dt()[0].AMOUNT=this.docObj.docItems.dt().sum("AMOUNT",2),this.docObj.dt()[0].DISCOUNT=this.docObj.docItems.dt().sum("DISCOUNT",2),this.docObj.dt()[0].VAT=this.docObj.docItems.dt().sum("VAT",2),this.docObj.dt()[0].TOTAL=this.docObj.docItems.dt().sum("TOTAL",2),this.docObj.docCustomer.dt()[0].AMOUNT=this.docObj.dt()[0].TOTAL;case 5:case"end":return t.stop()}}),t,this)}))),function(){return G.apply(this,arguments)})},{key:"_calculateTotalMargin",value:(V=(0,r.Z)(h().mark((function t(){var e,n,a,i;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=0,n=0;n<this.docObj.docItems.dt().length;n++)console.log(this.docObj.docItems.dt()[n]),e+=this.docObj.docItems.dt()[n].COST_PRICE*this.docObj.docItems.dt()[n].QUANTITY;a=this.docObj.dt()[0].TOTAL-this.docObj.dt()[0].VAT-e,i=a/(this.docObj.dt()[0].TOTAL-this.docObj.dt()[0].VAT)*100,this.docObj.dt()[0].MARGIN=a.toFixed(2)+"€ / %"+i.toFixed(2),this.txtMargin.setState({value:this.docObj.dt()[0].MARGIN});case 6:case"end":return t.stop()}}),t,this)}))),function(){return V.apply(this,arguments)})},{key:"_calculateMargin",value:(D=(0,r.Z)(h().mark((function t(){var e,n,a;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=0;e<this.docObj.docItems.dt().length;e++)n=this.docObj.docItems.dt()[e].TOTAL-this.docObj.docItems.dt()[e].VAT-this.docObj.docItems.dt()[e].COST_PRICE*this.docObj.docItems.dt()[e].QUANTITY,a=n/(this.docObj.docItems.dt()[e].TOTAL-this.docObj.docItems.dt()[e].VAT)*100,this.docObj.docItems.dt()[e].MARGIN=n.toFixed(2)+"€ / %"+a.toFixed(2);case 1:case"end":return t.stop()}}),t,this)}))),function(){return D.apply(this,arguments)})},{key:"_cellRoleRender",value:function(t){var e=this;if("ITEM_CODE"==t.column.dataField)return b.createElement(y.ZP,{id:"txtGrdItemsCode"+t.rowIndex,parent:this,simple:!0,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,value:t.value,onKeyDown:function(){var n=(0,r.Z)(h().mark((function n(a){return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("F10"!=a.event.key&&"ArrowRight"!=a.event.key){n.next=5;break}return n.next=3,e.pg_txtItemsCode.setVal(t.value);case 3:e.pg_txtItemsCode.show(),e.pg_txtItemsCode.onClick=function(){var n=(0,r.Z)(h().mark((function n(a){var i,r;return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.combineControl=!0,e.combineNew=!1,1!=a.length){n.next=7;break}return n.next=5,e.addItem(a[0],t.rowIndex);case 5:n.next=37;break;case 7:if(!(a.length>1)){n.next=37;break}i=0;case 9:if(!(i<a.length)){n.next=37;break}if(0!=i){n.next=15;break}return n.next=13,e.addItem(a[i],t.rowIndex);case 13:n.next=34;break;case 15:return(r=Z({},e.docObj.docItems.empty)).DOC_GUID=e.docObj.dt()[0].GUID,r.TYPE=e.docObj.dt()[0].TYPE,r.DOC_TYPE=e.docObj.dt()[0].DOC_TYPE,r.REBATE=e.docObj.dt()[0].REBATE,r.LINE_NO=e.docObj.docItems.dt().length,r.REF=e.docObj.dt()[0].REF,r.REF_NO=e.docObj.dt()[0].REF_NO,r.OUTPUT=e.docObj.dt()[0].OUTPUT,r.INPUT=e.docObj.dt()[0].INPUT,r.DOC_DATE=e.docObj.dt()[0].DOC_DATE,r.SHIPMENT_DATE=e.docObj.dt()[0].SHIPMENT_DATE,e.txtRef.readOnly=!0,e.txtRefno.readOnly=!0,e.docObj.docItems.addEmpty(r),n.next=32,e.core.util.waitUntil(100);case 32:return n.next=34,e.addItem(a[i],e.docObj.docItems.dt().length-1);case 34:i++,n.next=9;break;case 37:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}();case 5:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),onValueChanged:function(e){t.value=e.value},onChange:function(){var n=(0,r.Z)(h().mark((function n(a){var i,r,s;return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==a.event.isTrusted){n.next=15;break}return i={query:"SELECT ITEMS_VW_01.GUID,CODE,NAME,VAT,COST_PRICE FROM ITEMS_VW_01 INNER JOIN ITEM_BARCODE_VW_01 ON ITEMS_VW_01.GUID = ITEM_BARCODE_VW_01.ITEM_GUID WHERE CODE = @CODE OR ITEM_BARCODE_VW_01.BARCODE = @CODE",param:["CODE:string|50"],value:[a.component._changedValue]},n.next=4,e.core.sql.execute(i);case 4:if(!((r=n.sent).result.recordset.length>0)){n.next=12;break}return e.combineControl=!0,e.combineNew=!1,n.next=10,e.addItem(r.result.recordset[0],t.rowIndex);case 10:n.next=15;break;case 12:return s={id:"msgItemNotFound",showTitle:!0,title:e.t("msgItemNotFound.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:e.t("msgItemNotFound.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},e.t("msgItemNotFound.msg"))},n.next=15,(0,L.W)(s);case 15:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}().bind(this),button:[{id:"01",icon:"more",onClick:function(){e.pg_txtItemsCode.show(),e.pg_txtItemsCode.onClick=function(){var n=(0,r.Z)(h().mark((function n(a){var i,r;return h().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.combineControl=!0,e.combineNew=!1,1!=a.length){n.next=7;break}return n.next=5,e.addItem(a[0],t.rowIndex);case 5:n.next=37;break;case 7:if(!(a.length>1)){n.next=37;break}i=0;case 9:if(!(i<a.length)){n.next=37;break}if(0!=i){n.next=15;break}return n.next=13,e.addItem(a[i],t.rowIndex);case 13:n.next=34;break;case 15:return(r=Z({},e.docObj.docItems.empty)).DOC_GUID=e.docObj.dt()[0].GUID,r.TYPE=e.docObj.dt()[0].TYPE,r.DOC_TYPE=e.docObj.dt()[0].DOC_TYPE,r.REBATE=e.docObj.dt()[0].REBATE,r.LINE_NO=e.docObj.docItems.dt().length,r.REF=e.docObj.dt()[0].REF,r.REF_NO=e.docObj.dt()[0].REF_NO,r.OUTPUT=e.docObj.dt()[0].OUTPUT,r.INPUT=e.docObj.dt()[0].INPUT,r.DOC_DATE=e.docObj.dt()[0].DOC_DATE,r.SHIPMENT_DATE=e.docObj.dt()[0].SHIPMENT_DATE,e.txtRef.readOnly=!0,e.txtRefno.readOnly=!0,e.docObj.docItems.addEmpty(r),n.next=32,e.core.util.waitUntil(100);case 32:return n.next=34,e.addItem(a[i],e.docObj.docItems.dt().length-1);case 34:i++,n.next=9;break;case 37:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()}}]})}},{key:"addItem",value:(g=(0,r.Z)(h().mark((function t(e,n,i){var s,o,c,l,d,m,u,E,p=this;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===i&&(i=1),void 0===this.quantityControl||1!=this.quantityControl){t.next=17;break}return s={query:"SELECT [dbo].[FN_DEPOT_QUANTITY](@GUID,@DEPOT,GETDATE()) AS QUANTITY ",param:["GUID:string|50","DEPOT:string|50"],value:[e.GUID,this.docObj.dt()[0].OUTPUT]},t.next=5,this.core.sql.execute(s);case 5:if(!((o=t.sent).result.recordset.length>0)){t.next=17;break}if(!(o.result.recordset[0].QUANTITY<i)){t.next=16;break}return c={id:"msgNotQuantity",showTitle:!0,title:this.t("msgNotQuantity.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:this.t("msgNotQuantity.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgNotQuantity.msg")+o.result.recordset[0].QUANTITY)},t.next=11,(0,L.W)(c);case 11:return t.next=13,this.grdSlsInv.devGrid.deleteRow(n);case 13:return t.abrupt("return");case 16:this.docObj.docItems.dt()[n].DEPOT_QUANTITY=o.result.recordset[0].QUANTITY;case 17:l=h().mark((function t(a){var s;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(p.docObj.docItems.dt()[a].ITEM_CODE!=e.CODE){t.next=18;break}if(1!=p.combineControl){t.next=9;break}return s="",t.next=5,p.msgCombineItem.show().then(function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("btn01"!=e){t.next=13;break}return p.docObj.docItems.dt()[a].QUANTITY=p.docObj.docItems.dt()[a].QUANTITY+i,p.docObj.docItems.dt()[a].VAT=parseFloat((p.docObj.docItems.dt()[a].VAT+p.docObj.docItems.dt()[a].PRICE*(p.docObj.docItems.dt()[a].VAT_RATE/100)*i).toFixed(3)),p.docObj.docItems.dt()[a].AMOUNT=parseFloat((p.docObj.docItems.dt()[a].QUANTITY*p.docObj.docItems.dt()[a].PRICE).toFixed(3)),p.docObj.docItems.dt()[a].TOTAL=parseFloat((p.docObj.docItems.dt()[a].QUANTITY*p.docObj.docItems.dt()[a].PRICE-p.docObj.docItems.dt()[a].DISCOUNT+p.docObj.docItems.dt()[a].VAT).toFixed(3)),p._calculateTotal(),t.next=8,p.grdSlsInv.devGrid.deleteRow(n);case 8:return console.log(p.grdSlsInv),console.log(p.docObj.docItems.dt()),1==p.checkCombine.value&&(p.combineControl=!1),s=e,t.abrupt("return");case 13:if("btn02"!=e){t.next=16;break}return 1==p.checkCombine.value&&(p.combineControl=!1,p.combineNew=!0),t.abrupt("return");case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 5:if("btn01"!=s){t.next=7;break}return t.abrupt("return",{v:void 0});case 7:t.next=18;break;case 9:if(0!=p.combineNew){t.next=18;break}return p.docObj.docItems.dt()[a].QUANTITY=p.docObj.docItems.dt()[a].QUANTITY+i,p.docObj.docItems.dt()[a].VAT=parseFloat((p.docObj.docItems.dt()[a].VAT+p.docObj.docItems.dt()[a].PRICE*(p.docObj.docItems.dt()[a].VAT_RATE/100)*i).toFixed(3)),p.docObj.docItems.dt()[a].AMOUNT=parseFloat((p.docObj.docItems.dt()[a].QUANTITY*p.docObj.docItems.dt()[a].PRICE).toFixed(3)),p.docObj.docItems.dt()[a].TOTAL=parseFloat((p.docObj.docItems.dt()[a].QUANTITY*p.docObj.docItems.dt()[a].PRICE-p.docObj.docItems.dt()[a].DISCOUNT+p.docObj.docItems.dt()[a].VAT).toFixed(3)),p._calculateTotal(),t.next=17,p.grdSlsInv.devGrid.deleteRow(n);case 17:return t.abrupt("return",{v:void 0});case 18:case"end":return t.stop()}}),t)})),d=0;case 19:if(!(d<this.docObj.docItems.dt().length)){t.next=27;break}return t.delegateYield(l(d),"t0",21);case 21:if(m=t.t0,"object"!==(0,a.Z)(m)){t.next=24;break}return t.abrupt("return",m.v);case 24:d++,t.next=19;break;case 27:return this.docObj.docItems.dt()[n].ITEM_CODE=e.CODE,this.docObj.docItems.dt()[n].ITEM=e.GUID,this.docObj.docItems.dt()[n].VAT_RATE=e.VAT,this.docObj.docItems.dt()[n].ITEM_NAME=e.NAME,this.docObj.docItems.dt()[n].DISCOUNT=0,this.docObj.docItems.dt()[n].DISCOUNT_RATE=0,this.docObj.docItems.dt()[n].QUANTITY=i,u={query:"SELECT dbo.FN_PRICE_SALE_VAT_EXT(@GUID,@QUANTITY,GETDATE(),@CUSTOMER) AS PRICE",param:["GUID:string|50","QUANTITY:float","CUSTOMER:string|50"],value:[e.GUID,i,this.docObj.dt()[0].INPUT]},t.next=37,this.core.sql.execute(u);case 37:(E=t.sent).result.recordset.length>0&&(this.docObj.docItems.dt()[n].PRICE=parseFloat(E.result.recordset[0].PRICE.toFixed(3)),this.docObj.docItems.dt()[n].VAT=parseFloat((E.result.recordset[0].PRICE*(e.VAT/100)*i).toFixed(3)),this.docObj.docItems.dt()[n].AMOUNT=parseFloat((E.result.recordset[0].PRICE*i).toFixed(3)),this.docObj.docItems.dt()[n].TOTAL=parseFloat((E.result.recordset[0].PRICE*i+this.docObj.docItems.dt()[n].VAT).toFixed(2)),this._calculateTotal());case 39:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return g.apply(this,arguments)})},{key:"_getDispatch",value:(T=(0,r.Z)(h().mark((function t(){var e,n,a,i=this;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!=this.docObj.dt()[0].INPUT&&"00000000-0000-0000-0000-000000000000"!=this.docObj.dt()[0].INPUT){t.next=7;break}return e={id:"msgCustomerSelect",showTitle:!0,title:this.t("msgCustomerSelect.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:this.t("msgCustomerSelect.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgCustomerSelect.msg"))},t.next=4,(0,L.W)(e);case 4:return t.abrupt("return");case 7:return n={query:"SELECT *,REF + '-' + CONVERT(VARCHAR,REF_NO) AS REFERANS FROM DOC_ITEMS_VW_01 WHERE INPUT = @INPUT AND INVOICE_GUID = '00000000-0000-0000-0000-000000000000' AND TYPE = 1 AND REBATE = 0 AND DOC_TYPE IN(40)",param:["INPUT:string|50"],value:[this.docObj.dt()[0].INPUT]},t.next=10,this.core.sql.execute(n);case 10:if(!((a=t.sent).result.recordset.length>0)){t.next=14;break}return t.next=14,this.pg_dispatchGrid.setData(a.result.recordset);case 14:this.pg_dispatchGrid.show(),this.pg_dispatchGrid.onClick=function(){var t=(0,r.Z)(h().mark((function t(e){var n,a;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<e.length)){t.next=40;break}return(a=Z({},i.docObj.docItems.empty)).GUID=e[n].GUID,a.DOC_GUID=e[n].DOC_GUID,a.TYPE=e[n].TYPE,a.DOC_TYPE=e[n].DOC_TYPE,a.REBATE=e[n].REBATE,a.LINE_NO=e[n].LINE_NO,a.REF=e[n].REF,a.REF_NO=e[n].REF_NO,a.DOC_DATE=e[n].DOC_DATE,a.SHIPMENT_DATE=e[n].SHIPMENT_DATE,a.INPUT=e[n].INPUT,a.INPUT_CODE=e[n].INPUT_CODE,a.INPUT_NAME=e[n].INPUT_NAME,a.OUTPUT=e[n].OUTPUT,a.OUTPUT_CODE=e[n].OUTPUT_CODE,a.OUTPUT_NAME=e[n].OUTPUT_NAME,a.ITEM=e[n].ITEM,a.ITEM_CODE=e[n].ITEM_CODE,a.ITEM_NAME=e[n].ITEM_NAME,a.PRICE=e[n].PRICE,a.QUANTITY=e[n].QUANTITY,a.VAT=e[n].VAT,a.AMOUNT=e[n].AMOUNT,a.TOTAL=e[n].TOTAL,a.DESCRIPTION=e[n].DESCRIPTION,a.INVOICE_GUID=i.docObj.dt()[0].GUID,a.VAT_RATE=e[n].VAT_RATE,a.DISCOUNT_RATE=e[n].DISCOUNT_RATE,a.CONNECT_REF=e[n].CONNECT_REF,t.next=34,i.docObj.docItems.addEmpty(a,!1);case 34:return t.next=36,i.core.util.waitUntil(100);case 36:i.docObj.docItems.dt()[i.docObj.docItems.dt().length-1].stat="edit";case 37:n++,t.next=1;break;case 40:i.docObj.docItems.dt().emit("onRefresh"),i._calculateTotal();case 42:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();case 16:case"end":return t.stop()}}),t,this)}))),function(){return T.apply(this,arguments)})},{key:"_getPayment",value:(E=(0,r.Z)(h().mark((function t(){var e;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.paymentObj.load({PAYMENT_DOC_GUID:this.docObj.dt()[0].GUID});case 2:this.paymentObj.dt().length>0?(e=(this.docObj.dt()[0].TOTAL-this.paymentObj.dt()[0].TOTAL).toFixed(2),this.txtRemainder.setState({value:e}),this.txtMainRemainder.setState({value:e})):(this.txtRemainder.setState({value:this.docObj.dt()[0].TOTAL}),this.txtMainRemainder.setState({value:this.docObj.dt()[0].TOTAL}));case 3:case"end":return t.stop()}}),t,this)}))),function(){return E.apply(this,arguments)})},{key:"_addPayment",value:(u=(0,r.Z)(h().mark((function t(e,n){var a,i,r,s,o,c;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n>this.txtRemainder.value)){t.next=5;break}return a={id:"msgMoreAmount",showTitle:!0,title:this.t("msgMoreAmount.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:this.t("msgMoreAmount.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgMoreAmount.msg"))},t.next=4,(0,L.W)(a);case 4:return t.abrupt("return");case 5:if(0!=this.paymentObj.dt().length){t.next=17;break}return i=Z({},this.paymentObj.empty),r={query:"SELECT ISNULL(MAX(REF_NO) + 1,1) AS REF_NO FROM DOC WHERE TYPE = 0 AND DOC_TYPE = 200 AND REF = @REF ",param:["REF:string|25"],value:[this.txtRef.value]},t.next=10,this.core.sql.execute(r);case 10:(s=t.sent).result.recordset.length>0&&(i.REF=this.txtRef.value,i.REF_NO=s.result.recordset[0].REF_NO),i.TYPE=0,i.DOC_TYPE=200,i.INPUT="00000000-0000-0000-0000-000000000000",i.OUTPUT=this.docObj.dt()[0].INPUT,this.paymentObj.addEmpty(i);case 17:return(o=Z({},this.paymentObj.docCustomer.empty)).DOC_GUID=this.paymentObj.dt()[0].GUID,o.TYPE=this.paymentObj.dt()[0].TYPE,o.REF=this.paymentObj.dt()[0].REF,o.REF_NO=this.paymentObj.dt()[0].REF_NO,o.DOC_TYPE=this.paymentObj.dt()[0].DOC_TYPE,o.DOC_DATE=this.paymentObj.dt()[0].DOC_DATE,o.OUTPUT=this.paymentObj.dt()[0].OUTPUT,o.INVOICE_GUID=this.docObj.dt()[0].GUID,0==e?(o.INPUT=this.cmbCashSafe.value,o.INPUT_NAME=this.cmbCashSafe.displayValue,o.PAY_TYPE=0,o.AMOUNT=this.numCash.value,o.DESCRIPTION=this.cashDescription.value):1==e?(o.INPUT=this.cmbCheckSafe.value,o.INPUT_NAME=this.cmbCheckSafe.displayValue,o.PAY_TYPE=1,o.AMOUNT=this.numcheck.value,o.DESCRIPTION=this.checkDescription.value,(c=Z({},this.paymentObj.checkCls.empty)).DOC_GUID=this.paymentObj.dt()[0].GUID,c.REF=checkReference.value,c.DOC_DATE=this.paymentObj.dt()[0].DOC_DATE,c.CHECK_DATE=this.paymentObj.dt()[0].DOC_DATE,c.CUSTOMER=this.paymentObj.dt()[0].OUTPUT,c.AMOUNT=this.numcheck.value,c.SAFE=this.cmbCheckSafe.value,this.paymentObj.checkCls.addEmpty(c)):1==e&&(o.INPUT=this.cmbBank.value,o.INPUT_NAME=this.cmbBank.displayValue,o.PAY_TYPE=2,o.AMOUNT=this.numBank.value,o.DESCRIPTION=this.bankDescription.value),t.next=29,this.paymentObj.docCustomer.addEmpty(o);case 29:return this.paymentObj.dt()[0].AMOUNT=this.paymentObj.docCustomer.dt().sum("AMOUNT",2),this.paymentObj.dt()[0].TOTAL=this.paymentObj.docCustomer.dt().sum("AMOUNT",2),t.next=33,this.paymentObj.save();case 33:if(t.t0=t.sent,0!=t.t0){t.next=35;break}case 35:return t.next=37,this._getPayment();case 37:this.popPayment.show();case 38:case"end":return t.stop()}}),t,this)}))),function(t,e){return u.apply(this,arguments)})},{key:"multiItemAdd",value:(i=(0,r.Z)(h().mark((function t(){var e,n,a,i,r,s,o,c,l,d;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=[],n=0,!(this.multiItemData.length>0)){t.next=8;break}return a={id:"msgMultiData",showTitle:!0,title:this.t("msgMultiData.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:this.t("msgMultiData.btn01"),location:"before"},{id:"btn02",caption:this.t("msgMultiData.btn02"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgMultiData.msg"))},t.next=6,(0,L.W)(a);case 6:"btn01"==t.sent&&this.multiItemData.clear();case 8:i=0;case 9:if(!(i<this.tagItemCode.value.length)){t.next=27;break}if(0!=this.cmbMultiItemType.value){t.next=18;break}return r={query:"SELECT GUID,CODE,NAME,VAT,1 AS QUANTITY,ISNULL((SELECT TOP 1 MULTICODE FROM ITEM_MULTICODE_VW_01 WHERE ITEM_GUID = ITEMS_VW_01.GUID AND CUSTOMER_GUID = '"+this.docObj.dt()[0].INPUT+"'),'') AS MULTICODE FROM ITEMS_VW_01 WHERE ISNULL((SELECT TOP 1 MULTICODE FROM ITEM_MULTICODE_VW_01 WHERE ITEM_GUID = ITEMS_VW_01.GUID AND CUSTOMER_GUID = '"+this.docObj.dt()[0].INPUT+"'),'') = @VALUE ",param:["VALUE:string|50"],value:[this.tagItemCode.value[i]]},t.next=14,this.core.sql.execute(r);case 14:(s=t.sent).result.recordset.length>0?void 0===this.multiItemData.where({CODE:s.result.recordset[0].CODE})[0]&&(this.multiItemData.push(s.result.recordset[0]),n+=1):e.push("'"+this.tagItemCode.value[i]+"'"),t.next=24;break;case 18:if(1!=this.cmbMultiItemType.value){t.next=24;break}return o={query:"SELECT GUID,CODE,NAME,VAT,1 AS QUANTITY,ISNULL((SELECT TOP 1 MULTICODE FROM ITEM_MULTICODE_VW_01 WHERE ITEM_GUID = ITEMS_VW_01.GUID AND CUSTOMER_GUID = '"+this.docObj.dt()[0].INPUT+"'),'') AS MULTICODE FROM ITEMS_VW_01 WHERE UPPER(CODE) LIKE UPPER(@VALUE) OR UPPER(NAME) LIKE UPPER(@VALUE) ",param:["VALUE:string|50"],value:[this.tagItemCode.value[i]]},t.next=22,this.core.sql.execute(o);case 22:(c=t.sent).result.recordset.length>0?void 0===this.multiItemData.where({CODE:c.result.recordset[0].CODE})[0]&&(this.multiItemData.push(c.result.recordset[0]),n+=1):e.push("'"+this.tagItemCode.value[i]+"'");case 24:i++,t.next=9;break;case 27:if(!(e.length>0)){t.next=31;break}return l={id:"msgMissItemCode",showTitle:!0,title:this.t("msgMissItemCode.title"),showCloseButton:!0,width:"500px",height:"auto",button:[{id:"btn01",caption:this.t("msgMissItemCode.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",wordWrap:"break-word",fontSize:"20px"}},this.t("msgMissItemCode.msg")+" "+e)},t.next=31,(0,L.W)(l);case 31:return d={id:"msgMultiCodeCount",showTitle:!0,title:this.t("msgMultiCodeCount.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:this.t("msgMultiCodeCount.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgMultiCodeCount.msg")+" "+n)},t.next=34,(0,L.W)(d);case 34:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"multiItemSave",value:(n=(0,r.Z)(h().mark((function t(){var e,n;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.combineControl=!0,this.combineNew=!1,e=0;case 3:if(!(e<this.multiItemData.length)){t.next=27;break}return(n=Z({},this.docObj.docItems.empty)).DOC_GUID=this.docObj.dt()[0].GUID,n.TYPE=this.docObj.dt()[0].TYPE,n.DOC_TYPE=this.docObj.dt()[0].DOC_TYPE,n.REBATE=this.docObj.dt()[0].REBATE,n.LINE_NO=this.docObj.docItems.dt().length,n.REF=this.docObj.dt()[0].REF,n.REF_NO=this.docObj.dt()[0].REF_NO,n.OUTPUT=this.docObj.dt()[0].OUTPUT,n.INPUT=this.docObj.dt()[0].INPUT,n.DOC_DATE=this.docObj.dt()[0].DOC_DATE,n.SHIPMENT_DATE=this.docObj.dt()[0].SHIPMENT_DATE,this.txtRef.readOnly=!0,this.txtRefno.readOnly=!0,this.docObj.docItems.addEmpty(n),t.next=21,this.core.util.waitUntil(100);case 21:return t.next=23,this.addItem(this.multiItemData[e],this.docObj.docItems.dt().length-1,this.multiItemData[e].QUANTITY);case 23:this.popMultiItem.hide();case 24:e++,t.next=3;break;case 27:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"checkRow",value:(e=(0,r.Z)(h().mark((function t(){var e;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=0;e<this.docObj.docItems.dt().length;e++)this.docObj.docItems.dt()[e].INPUT=this.docObj.dt()[0].INPUT,this.docObj.docItems.dt()[e].OUTPUT=this.docObj.dt()[0].OUTPUT,this.docObj.docItems.dt()[e].DOC_DATE=this.docObj.dt()[0].DOC_DATE,this.docObj.docItems.dt()[e].SHIPMENT_DATE=this.docObj.dt()[0].SHIPMENT_DATE;case 1:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"render",value:function(){var t,e,n=this;return b.createElement("div",null,b.createElement(f(),null,b.createElement("div",{className:"row px-2 pt-2"},b.createElement("div",{className:"col-12"},b.createElement(C(),null,b.createElement(x.Item,{location:"after",locateInMenu:"auto"},b.createElement(j.Z,{id:"btnBack",parent:this,icon:"revert",type:"default",onClick:function(){n.getDoc(n.docObj.dt()[0].GUID,n.docObj.dt()[0].REF,n.docObj.dt()[0].REF_NO)}})),b.createElement(x.Item,{location:"after",locateInMenu:"auto"},b.createElement(j.Z,{id:"btnNew",parent:this,icon:"file",type:"default",onClick:function(){n.init()}})),b.createElement(x.Item,{location:"after",locateInMenu:"auto"},b.createElement(j.Z,{id:"btnSave",parent:this,icon:"floppy",type:"default",validationGroup:"frmSalesInv"+this.tabIndex,onClick:function(){var t=(0,r.Z)(h().mark((function t(e){var a,i,r,s;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1!=n.docLocked){t.next=5;break}return a={id:"msgDocLocked",showTitle:!0,title:n.t("msgDocLocked.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgDocLocked.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgDocLocked.msg"))},t.next=4,(0,L.W)(a);case 4:return t.abrupt("return");case 5:if(""!=n.docObj.docItems.dt()[n.docObj.docItems.dt().length-1].ITEM_CODE){t.next=8;break}return t.next=8,n.grdSlsInv.devGrid.deleteRow(n.docObj.docItems.dt().length-1);case 8:if("valid"!=e.validationGroup.validate().status){t.next=32;break}return i={id:"msgSave",showTitle:!0,title:n.t("msgSave.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgSave.btn01"),location:"before"},{id:"btn02",caption:n.t("msgSave.btn02"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgSave.msg"))},t.next=12,(0,L.W)(i);case 12:if("btn01"!=t.sent){t.next=30;break}return r={id:"msgSaveResult",showTitle:!0,title:n.t("msgSave.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgSave.btn01"),location:"after"}]},t.next=17,n.docObj.save();case 17:if(t.t0=t.sent,0!=t.t0){t.next=27;break}return n._getPayment(),r.content=b.createElement("div",{style:{textAlign:"center",fontSize:"20px",color:"green"}},n.t("msgSaveResult.msgSuccess")),t.next=23,(0,L.W)(r);case 23:n.btnSave.setState({disabled:!0}),n.btnNew.setState({disabled:!1}),t.next=30;break;case 27:return r.content=b.createElement("div",{style:{textAlign:"center",fontSize:"20px",color:"red"}},n.t("msgSaveResult.msgFailed")),t.next=30,(0,L.W)(r);case 30:t.next=35;break;case 32:return s={id:"msgSaveValid",showTitle:!0,title:n.t("msgSaveValid.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgSaveValid.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgSaveValid.msg"))},t.next=35,(0,L.W)(s);case 35:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),b.createElement(x.Item,{location:"after",locateInMenu:"auto"},b.createElement(j.Z,{id:"btnDelete",parent:this,icon:"trash",type:"default",onClick:(0,r.Z)(h().mark((function t(){var e;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={id:"msgDelete",showTitle:!0,title:n.t("msgDelete.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgDelete.btn01"),location:"before"},{id:"btn02",caption:n.t("msgDelete.btn02"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgDelete.msg"))},t.next=3,(0,L.W)(e);case 3:if("btn01"!=t.sent){t.next=9;break}return n.docObj.dt("DOC").removeAt(0),t.next=8,n.docObj.dt("DOC").delete();case 8:n.init();case 9:case"end":return t.stop()}}),t)})))})),b.createElement(x.Item,{location:"after",locateInMenu:"auto"},b.createElement(j.Z,{id:"btnLock",parent:this,icon:"key",type:"default",onClick:(0,r.Z)(h().mark((function t(){var e;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=n.docObj.dt()[0].LOCKED){t.next=19;break}if(n.docObj.dt()[0].LOCKED=1,""!=n.docObj.docItems.dt()[n.docObj.docItems.dt().length-1].ITEM_CODE){t.next=5;break}return t.next=5,n.grdSlsInv.devGrid.deleteRow(n.docObj.docItems.dt().length-1);case 5:return t.next=7,n.docObj.save();case 7:if(t.t0=t.sent,0!=t.t0){t.next=14;break}return e={id:"msgLocked",showTitle:!0,title:n.t("msgLocked.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgLocked.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgLocked.msg"))},t.next=12,(0,L.W)(e);case 12:t.next=17;break;case 14:return tmpConfObj1.content=b.createElement("div",{style:{textAlign:"center",fontSize:"20px",color:"red"}},n.t("msgSaveResult.msgFailed")),t.next=17,(0,L.W)(tmpConfObj1);case 17:t.next=20;break;case 19:n.popPassword.show();case 20:case"end":return t.stop()}}),t)})))})),b.createElement(x.Item,{location:"after",locateInMenu:"auto"},b.createElement(j.Z,{id:"btnCopy",parent:this,icon:"copy",type:"default",onClick:function(){}})),b.createElement(x.Item,{location:"after",locateInMenu:"auto"},b.createElement(j.Z,{id:"btnPrint",parent:this,icon:"print",type:"default",onClick:function(){n.popDesign.show()}})),b.createElement(x.Item,{location:"after",locateInMenu:"auto",widget:"dxButton",options:{type:"default",icon:"clear",onClick:(e=(0,r.Z)(h().mark((function t(){var e;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={id:"msgClose",showTitle:!0,title:n.lang.t("msgWarning"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.lang.t("btnYes"),location:"before"},{id:"btn02",caption:n.lang.t("btnNo"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.lang.t("msgClose"))},t.next=3,(0,L.W)(e);case 3:"btn01"==t.sent&&O.Z.instance.panel.closePage();case 5:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})}})))),b.createElement("div",{className:"row px-2 pt-2"},b.createElement("div",{className:"col-12"},b.createElement(v(),{colCount:3,id:"frmSalesInv"},b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("txtRefRefno"),alignment:"right"}),b.createElement("div",{className:"row"},b.createElement("div",{className:"col-4 pe-0"},b.createElement(y.ZP,{id:"txtRef",parent:this,simple:!0,dt:{data:this.docObj.dt("DOC"),field:"REF"},upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,readOnly:!0,maxLength:32,onValueChanged:function(){var t=(0,r.Z)(h().mark((function t(e){var a,i;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.docObj.docCustomer.dt()[0].REF=n.txtRef.value,a={query:"SELECT ISNULL(MAX(REF_NO) + 1,1) AS REF_NO FROM DOC WHERE TYPE = 1 AND DOC_TYPE = 20 AND REF = @REF ",param:["REF:string|25"],value:[n.txtRef.value]},t.next=4,n.core.sql.execute(a);case 4:(i=t.sent).result.recordset.length>0&&(n.txtRefno.value=i.result.recordset[0].REF_NO,n.docObj.docCustomer.dt()[0].REF_NO=i.result.recordset[0].REF_NO);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}().bind(this),param:this.param.filter({ELEMENT:"txtRef",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtRef",USERS:this.user.CODE})},b.createElement(y.cX,{validationGroup:"frmSalesInv"+this.tabIndex},b.createElement(y.n2,{message:this.t("validRef")})))),b.createElement("div",{className:"col-5 ps-0"},b.createElement(y.ZP,{id:"txtRefno",parent:this,simple:!0,dt:{data:this.docObj.dt("DOC"),field:"REF_NO"},upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,readOnly:!0,button:[{id:"01",icon:"more",onClick:function(){n.pg_Docs.show(),n.pg_Docs.onClick=function(t){t.length>0&&n.getDoc(t[0].GUID,t[0].REF,t[0].REF_NO)}}},{id:"02",icon:"arrowdown",onClick:function(){n.txtRefno.value=Math.floor(Date.now()/1e3)}}],onChange:(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.docObj.docCustomer.dt()[0].REF_NO=n.txtRefno.value,t.next=3,n.checkDoc("00000000-0000-0000-0000-000000000000",n.txtRef.value,n.txtRefno.value);case 3:3==t.sent&&(n.txtRefno.value="",n.docObj.docCustomer.dt()[0].REF_NO=n.txtRefno.value);case 5:case"end":return t.stop()}}),t)}))).bind(this),param:this.param.filter({ELEMENT:"txtRefno",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtRefno",USERS:this.user.CODE})},b.createElement(y.cX,{validationGroup:"frmSalesInv"+this.tabIndex},b.createElement(y.n2,{message:this.t("validRefNo")}))))),b.createElement(U.Z,{id:"pg_Docs",parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,width:"90%",height:"90%",title:this.t("pg_Docs.title"),data:{source:{select:{query:"SELECT GUID,REF,REF_NO,INPUT_CODE,INPUT_NAME FROM DOC_VW_01 WHERE TYPE = 1 AND DOC_TYPE = 20 AND REBATE = 0"},sql:this.core.sql}},button:[{id:"01",icon:"more",onClick:function(){}}]},b.createElement(_.sg,{dataField:"REF",caption:this.t("pg_Docs.clmRef"),width:150,defaultSortOrder:"asc"}),b.createElement(_.sg,{dataField:"REF_NO",caption:this.t("pg_Docs.clmRefNo"),width:300,defaultSortOrder:"asc"}),b.createElement(_.sg,{dataField:"INPUT_NAME",caption:this.t("pg_Docs.clmInputName"),width:300,defaultSortOrder:"asc"}),b.createElement(_.sg,{dataField:"INPUT_CODE",caption:this.t("pg_Docs.clmInputCode"),width:300,defaultSortOrder:"asc"}))),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("cmbDepot"),alignment:"right"}),b.createElement(S.ZP,{simple:!0,parent:this,id:"cmbDepot",notRefresh:!0,dt:{data:this.docObj.dt("DOC"),field:"OUTPUT"},displayExpr:"NAME",valueExpr:"GUID",value:"",searchEnabled:!0,onValueChanged:(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.checkRow(),n.docObj.docCustomer.dt()[0].OUTPUT=n.cmbDepot.value;case 2:case"end":return t.stop()}}),t)}))).bind(this),data:{source:{select:{query:"SELECT * FROM DEPOT_VW_01 WHERE TYPE IN(0,2)"},sql:this.core.sql}},param:this.param.filter({ELEMENT:"cmbDepot",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"cmbDepot",USERS:this.user.CODE})},b.createElement(y.cX,{validationGroup:"frmSalesInv"+this.tabIndex},b.createElement(y.n2,{message:this.t("validDepot")})))),b.createElement(x.EmptyItem,null),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("txtCustomerCode"),alignment:"right"}),b.createElement(y.ZP,{id:"txtCustomerCode",parent:this,simple:!0,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,dt:{data:this.docObj.dt("DOC"),field:"INPUT_CODE"},onEnterKey:(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.pg_txtCustomerCode.setVal(n.txtCustomerCode.value);case 2:n.pg_txtCustomerCode.show(),n.pg_txtCustomerCode.onClick=function(t){if(t.length>0&&t.length>0){n.docObj.dt()[0].INPUT=t[0].GUID,n.docObj.docCustomer.dt()[0].INPUT=t[0].GUID,n.docObj.dt()[0].INPUT_CODE=t[0].CODE,n.docObj.dt()[0].INPUT_NAME=t[0].TITLE;var e=n.sysParam.filter({ID:"refForCustomerCode",USERS:n.user.CODE}).getValue();void 0!==e&&1==e.value&&(n.txtRef.value=t[0].CODE,n.txtRef.props.onValueChanged())}};case 4:case"end":return t.stop()}}),t)}))).bind(this),button:[{id:"01",icon:"more",onClick:function(){n.pg_txtCustomerCode.show(),n.pg_txtCustomerCode.onClick=function(t){if(t.length>0){n.docObj.dt()[0].INPUT=t[0].GUID,n.docObj.docCustomer.dt()[0].INPUT=t[0].GUID,n.docObj.dt()[0].INPUT_CODE=t[0].CODE,n.docObj.dt()[0].INPUT_NAME=t[0].TITLE;var e=n.sysParam.filter({ID:"refForCustomerCode",USERS:n.user.CODE}).getValue();void 0!==e&&1==e.value&&(n.txtRef.value=t[0].CODE,n.txtRef.props.onValueChanged())}}}}],param:this.param.filter({ELEMENT:"txtCustomerCode",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtCustomerCode",USERS:this.user.CODE})},b.createElement(y.cX,{validationGroup:"frmSalesInv"+this.tabIndex},b.createElement(y.n2,{message:this.t("validCustomerCode")}))),b.createElement(U.Z,{id:"pg_txtCustomerCode",parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,width:"90%",height:"90%",title:this.t("pg_txtCustomerCode.title"),search:!0,data:{source:{select:{query:"SELECT GUID,CODE,TITLE,NAME,LAST_NAME,[TYPE_NAME],[GENUS_NAME] FROM CUSTOMER_VW_01 WHERE UPPER(CODE) LIKE UPPER(@VAL) OR UPPER(TITLE) LIKE UPPER(@VAL)",param:["VAL:string|50"]},sql:this.core.sql}},button:{id:"01",icon:"more",onClick:function(){}}},b.createElement(_.sg,{dataField:"CODE",caption:this.t("pg_txtCustomerCode.clmCode"),width:150}),b.createElement(_.sg,{dataField:"TITLE",caption:this.t("pg_txtCustomerCode.clmTitle"),width:500,defaultSortOrder:"asc"}),b.createElement(_.sg,{dataField:"TYPE_NAME",caption:this.t("pg_txtCustomerCode.clmTypeName"),width:150}),b.createElement(_.sg,{dataField:"GENUS_NAME",caption:this.t("pg_txtCustomerCode.clmGenusName"),width:150}))),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("txtCustomerName"),alignment:"right"}),b.createElement(y.ZP,{id:"txtCustomerName",parent:this,simple:!0,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,dt:{data:this.docObj.dt("DOC"),field:"INPUT_NAME"},readOnly:!0,param:this.param.filter({ELEMENT:"txtCustomerName",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtCustomerName",USERS:this.user.CODE})})),b.createElement(x.EmptyItem,null),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("dtDocDate"),alignment:"right"}),b.createElement(k.ZP,{simple:!0,parent:this,id:"dtDocDate",dt:{data:this.docObj.dt("DOC"),field:"DOC_DATE"},onValueChanged:(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.checkRow(),n.docObj.docCustomer.dt()[0].DOC_DATE=p()(n.dtDocDate.value).format("DD/MM/YYYY");case 2:case"end":return t.stop()}}),t)}))).bind(this)},b.createElement(y.cX,{validationGroup:"frmSalesInv"+this.tabIndex},b.createElement(y.n2,{message:this.t("validDocDate")})))),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("dtShipDate"),alignment:"right"}),b.createElement(k.ZP,{simple:!0,parent:this,id:"dtShipDate",dt:{data:this.docObj.dt("DOC"),field:"SHIPMENT_DATE"},onValueChanged:(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.checkRow();case 1:case"end":return t.stop()}}),t)}))).bind(this)},b.createElement(y.cX,{validationGroup:"frmSalesInv"+this.tabIndex},b.createElement(y.n2,{message:this.t("validDocDate")})))),b.createElement(x.EmptyItem,null),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("txtBarcode"),alignment:"right"}),b.createElement(y.ZP,{id:"txtBarcode",parent:this,simple:!0,placeholder:this.t("txtBarcodePlace"),upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,onEnterKey:function(){var t=(0,r.Z)(h().mark((function t(e){var a,i,r,s,o;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!=n.cmbDepot.value){t.next=6;break}return a={id:"msgDocValid",showTitle:!0,title:n.t("msgDocValid.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgDocValid.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgDocValid.msg"))},t.next=4,(0,L.W)(a);case 4:return n.txtBarcode.setState({value:""}),t.abrupt("return");case 6:return i={query:"SELECT ITEMS_VW_01.GUID,CODE,NAME,VAT,ISNULL((SELECT TOP 1 CODE FROM ITEM_MULTICODE WHERE ITEM_MULTICODE.ITEM = ITEMS_VW_01.GUID AND ITEM_MULTICODE.CUSTOMER = @CUSTOMER AND DELETED = 0 ORDER BY LDATE DESC),'') AS MULTICODE,  ISNULL((SELECT TOP 1 CUSTOMER_NAME FROM ITEM_MULTICODE_VW_01 WHERE ITEM_MULTICODE_VW_01.ITEM_GUID = ITEMS_VW_01.GUID ORDER BY LDATE DESC),'') AS CUSTOMER_NAME  FROM ITEMS_VW_01 INNER JOIN ITEM_BARCODE_VW_01 ON ITEMS_VW_01.GUID = ITEM_BARCODE_VW_01.ITEM_GUID WHERE CODE = @CODE OR ITEM_BARCODE_VW_01.BARCODE = @CODE",param:["CODE:string|50","CUSTOMER:string|50"],value:[n.txtBarcode.value,n.docObj.dt()[0].INPUT]},t.next=9,n.core.sql.execute(i);case 9:if(r=t.sent,n.txtBarcode.setState({value:""}),!(r.result.recordset.length>0)){t.next=32;break}return(s=Z({},n.docObj.docItems.empty)).DOC_GUID=n.docObj.dt()[0].GUID,s.TYPE=n.docObj.dt()[0].TYPE,s.DOC_TYPE=n.docObj.dt()[0].DOC_TYPE,s.REBATE=n.docObj.dt()[0].REBATE,s.LINE_NO=n.docObj.docItems.dt().length,s.REF=n.docObj.dt()[0].REF,s.REF_NO=n.docObj.dt()[0].REF_NO,s.OUTPUT=n.docObj.dt()[0].OUTPUT,s.INPUT=n.docObj.dt()[0].INPUT,s.DOC_DATE=n.docObj.dt()[0].DOC_DATE,s.SHIPMENT_DATE=n.docObj.dt()[0].SHIPMENT_DATE,n.txtRef.readOnly=!0,n.txtRefno.readOnly=!0,n.docObj.docItems.addEmpty(s),t.next=29,n.core.util.waitUntil(100);case 29:n.addItem(r.result.recordset[0],void 0===n.docObj.docItems.dt()[0]?0:n.docObj.docItems.dt().length-1),t.next=35;break;case 32:return o={id:"msgItemNotFound",showTitle:!0,title:n.t("msgItemNotFound.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgItemNotFound.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgItemNotFound.msg"))},t.next=35,(0,L.W)(o);case 35:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}().bind(this),param:this.param.filter({ELEMENT:"txtBarcode",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"txtBarcode",USERS:this.user.CODE})}))))),b.createElement("div",{className:"row px-2 pt-2"},b.createElement("div",{className:"col-12"},b.createElement(v(),{colCount:1,onInitialized:function(t){n.frmSalesInv=t.component}},b.createElement(x.Item,{location:"after"},b.createElement(N.Button,{icon:"add",validationGroup:"frmSalesInv"+this.tabIndex,onClick:function(){var t=(0,r.Z)(h().mark((function t(e){var a,i;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("valid"!=e.validationGroup.validate().status){t.next=27;break}if(void 0===n.docObj.docItems.dt()[0]){t.next=6;break}if(""!=n.docObj.docItems.dt()[n.docObj.docItems.dt().length-1].ITEM_CODE){t.next=6;break}return n.pg_txtItemsCode.show(),n.pg_txtItemsCode.onClick=function(){var t=(0,r.Z)(h().mark((function t(e){var a,i;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.combineControl=!0,n.combineNew=!1,1!=e.length){t.next=7;break}return t.next=5,n.addItem(e[0],n.docObj.docItems.dt().length-1);case 5:t.next=37;break;case 7:if(!(e.length>1)){t.next=37;break}a=0;case 9:if(!(a<e.length)){t.next=37;break}if(0!=a){t.next=15;break}return t.next=13,n.addItem(e[a],n.docObj.docItems.dt().length-1);case 13:t.next=34;break;case 15:return(i=Z({},n.docObj.docItems.empty)).DOC_GUID=n.docObj.dt()[0].GUID,i.TYPE=n.docObj.dt()[0].TYPE,i.DOC_TYPE=n.docObj.dt()[0].DOC_TYPE,i.REBATE=n.docObj.dt()[0].REBATE,i.LINE_NO=n.docObj.docItems.dt().length,i.REF=n.docObj.dt()[0].REF,i.REF_NO=n.docObj.dt()[0].REF_NO,i.OUTPUT=n.docObj.dt()[0].OUTPUT,i.INPUT=n.docObj.dt()[0].INPUT,i.DOC_DATE=n.docObj.dt()[0].DOC_DATE,i.SHIPMENT_DATE=n.docObj.dt()[0].SHIPMENT_DATE,n.txtRef.readOnly=!0,n.txtRefno.readOnly=!0,n.docObj.docItems.addEmpty(i),t.next=32,n.core.util.waitUntil(100);case 32:return t.next=34,n.addItem(e[a],n.docObj.docItems.dt().length-1);case 34:a++,t.next=9;break;case 37:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),t.abrupt("return");case 6:return(a=Z({},n.docObj.docItems.empty)).DOC_GUID=n.docObj.dt()[0].GUID,a.TYPE=n.docObj.dt()[0].TYPE,a.DOC_TYPE=n.docObj.dt()[0].DOC_TYPE,a.REBATE=n.docObj.dt()[0].REBATE,a.LINE_NO=n.docObj.docItems.dt().length,a.REF=n.docObj.dt()[0].REF,a.REF_NO=n.docObj.dt()[0].REF_NO,a.OUTPUT=n.docObj.dt()[0].OUTPUT,a.INPUT=n.docObj.dt()[0].INPUT,a.DOC_DATE=n.docObj.dt()[0].DOC_DATE,a.SHIPMENT_DATE=n.docObj.dt()[0].SHIPMENT_DATE,n.txtRef.readOnly=!0,n.txtRefno.readOnly=!0,n.docObj.docItems.addEmpty(a),t.next=23,n.core.util.waitUntil(100);case 23:n.pg_txtItemsCode.show(),n.pg_txtItemsCode.onClick=function(){var t=(0,r.Z)(h().mark((function t(e){var a,i;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.combineControl=!0,n.combineNew=!1,1!=e.length){t.next=7;break}return t.next=5,n.addItem(e[0],n.docObj.docItems.dt().length-1);case 5:t.next=37;break;case 7:if(!(e.length>1)){t.next=37;break}a=0;case 9:if(!(a<e.length)){t.next=37;break}if(0!=a){t.next=15;break}return t.next=13,n.addItem(e[a],n.docObj.docItems.dt().length-1);case 13:t.next=34;break;case 15:return(i=Z({},n.docObj.docItems.empty)).DOC_GUID=n.docObj.dt()[0].GUID,i.TYPE=n.docObj.dt()[0].TYPE,i.DOC_TYPE=n.docObj.dt()[0].DOC_TYPE,i.REBATE=n.docObj.dt()[0].REBATE,i.LINE_NO=n.docObj.docItems.dt().length,i.REF=n.docObj.dt()[0].REF,i.REF_NO=n.docObj.dt()[0].REF_NO,i.OUTPUT=n.docObj.dt()[0].OUTPUT,i.INPUT=n.docObj.dt()[0].INPUT,i.DOC_DATE=n.docObj.dt()[0].DOC_DATE,i.SHIPMENT_DATE=n.docObj.dt()[0].SHIPMENT_DATE,n.txtRef.readOnly=!0,n.txtRefno.readOnly=!0,n.docObj.docItems.addEmpty(i),t.next=32,n.core.util.waitUntil(100);case 32:return t.next=34,n.addItem(e[a],n.docObj.docItems.dt().length-1);case 34:a++,t.next=9;break;case 37:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),t.next=30;break;case 27:return i={id:"msgDocValid",showTitle:!0,title:n.t("msgDocValid.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgDocValid.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgDocValid.msg"))},t.next=30,(0,L.W)(i);case 30:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}),b.createElement(N.Button,{icon:"increaseindent",text:"Toplu Ürün Ekleme",validationGroup:"frmSalesInv"+this.tabIndex,onClick:function(){var t=(0,r.Z)(h().mark((function t(e){var a;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("valid"!=e.validationGroup.validate().status){t.next=8;break}if(n.multiItemData.clear,n.popMultiItem.show(),void 0===n.docObj.docItems.dt()[n.docObj.docItems.dt().length-1]||""!=n.docObj.docItems.dt()[n.docObj.docItems.dt().length-1].ITEM_CODE){t.next=6;break}return t.next=6,n.grdSlsInv.devGrid.deleteRow(n.docObj.docItems.dt().length-1);case 6:t.next=11;break;case 8:return a={id:"msgDocValid",showTitle:!0,title:n.t("msgDocValid.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgDocValid.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgDocValid.msg"))},t.next=11,(0,L.W)(a);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),b.createElement(x.Item,null,b.createElement(b.Fragment,null,b.createElement(_.ZP,{parent:this,id:"grdSlsInv",showBorders:!0,columnsAutoWidth:!0,allowColumnReordering:!0,allowColumnResizing:!0,headerFilter:{visible:!0},height:"400",width:"100%",dbApply:!1,onRowPrepared:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),onRowUpdating:function(){var t=(0,r.Z)(h().mark((function t(e){var a,i;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(1!=n.quantityControl){t.next=7;break}if(a=e.component.getRowIndexByKey(e.key),!(void 0!==e.newData.QUANTITY&&e.key.DEPOT_QUANTITY<e.newData.QUANTITY)){t.next=7;break}return i={id:"msgNotQuantity",showTitle:!0,title:n.t("msgNotQuantity.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgNotQuantity.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgNotQuantity.msg")+e.oldData.DEPOT_QUANTITY)},t.next=6,(0,L.W)(i);case 6:n.docObj.docItems.dt()[a].QUANTITY=e.oldData.DEPOT_QUANTITY;case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),onRowUpdated:function(){var t=(0,r.Z)(h().mark((function t(e){var a,i,r,s,o,c,l,d,m,u;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.component.getRowIndexByKey(e.key),console.log(a),void 0===e.data.QUANTITY){t.next=8;break}return i={query:"SELECT [dbo].[FN_PRICE_SALE_VAT_EXT](@ITEM_GUID,@QUANTITY,GETDATE(),@CUSTOMER_GUID) AS PRICE",param:["ITEM_GUID:string|50","CUSTOMER_GUID:string|50","QUANTITY:float"],value:[e.key.ITEM,n.docObj.dt()[0].INPUT,e.data.QUANTITY]},t.next=6,n.core.sql.execute(i);case 6:(r=t.sent).result.recordset.length>0&&(n.docObj.docItems.dt()[a].PRICE=parseFloat(r.result.recordset[0].PRICE.toFixed(3)),n._calculateTotal());case 8:if(void 0!==e.data.DISCOUNT_RATE&&(e.key.DISCOUNT=parseFloat((n.docObj.docItems.dt()[a].AMOUNT*e.data.DISCOUNT_RATE/100).toFixed(3))),!(e.key.COST_PRICE>e.key.PRICE)){t.next=27;break}if(void 0===(s=n.acsobj.filter({ID:"underMinCostPrice",USERS:n.user.CODE}).getValue())||1!=s){t.next=24;break}return o={id:"msgUnderPrice1",showTitle:!0,title:n.t("msgUnderPrice1.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgUnderPrice1.btn01"),location:"before"},{id:"btn02",caption:n.t("msgUnderPrice1.btn02"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgUnderPrice1.msg"))},t.next=15,(0,L.W)(o);case 15:if("btn01"!=(c=t.sent)){t.next=19;break}t.next=22;break;case 19:if("btn02"!=c){t.next=22;break}return e.component.cancelEditData(),t.abrupt("return");case 22:t.next=27;break;case 24:return l={id:"msgUnderPrice2",showTitle:!0,title:"Uyarı",showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgUnderPrice2.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},"msgUnderPrice2.msg")},(0,L.W)(l),t.abrupt("return");case 27:if(!(e.key.DISCOUNT>e.key.PRICE*e.key.QUANTITY)){t.next=32;break}return d={id:"msgDiscount",showTitle:!0,title:"Uyarı",showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgDiscount.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgDiscount.msg"))},(0,L.W)(d),n.docObj.docItems.dt()[a].DISCOUNT=0,t.abrupt("return");case 32:n.docObj.docItems.dt()[a].VAT=parseFloat(((e.key.PRICE*e.key.QUANTITY-e.key.DISCOUNT)*e.key.VAT_RATE/100).toFixed(3)),n.docObj.docItems.dt()[a].AMOUNT=parseFloat((e.key.PRICE*e.key.QUANTITY).toFixed(3)),n.docObj.docItems.dt()[a].TOTAL=parseFloat((e.key.PRICE*e.key.QUANTITY-e.key.DISCOUNT+n.docObj.docItems.dt()[a].VAT).toFixed(3)),m=n.docObj.docItems.dt()[a].TOTAL-n.docObj.docItems.dt()[a].VAT-n.docObj.docItems.dt()[a].COST_PRICE*n.docObj.docItems.dt()[a].QUANTITY,u=m/(n.docObj.docItems.dt()[a].TOTAL-n.docObj.docItems.dt()[a].VAT)*100,n.docObj.docItems.dt()[a].MARGIN=m.toFixed(2)+"€ / %"+u.toFixed(2),n.docObj.docItems.dt()[a].DISCOUNT>0&&(n.docObj.docItems.dt()[a].DISCOUNT_RATE=parseFloat(100-((e.key.PRICE*e.key.QUANTITY-e.key.DISCOUNT)/(e.key.PRICE*e.key.QUANTITY)*100).toFixed(3))),n._calculateTotal();case 40:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),onRowRemoved:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n._calculateTotal();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},b.createElement(_.m_,{editOnKeyPress:!0,enterKeyAction:"moveFocus",enterKeyDirection:"row"}),b.createElement(_.PY,{mode:"virtual"}),b.createElement(_.LO,{mode:"cell",allowUpdating:!0,allowDeleting:!0,confirmDelete:!1}),b.createElement(_.D7,{fileName:this.lang.t("menu.ftr_02_002"),enabled:!0,allowExportSelectedData:!0}),b.createElement(_.sg,{dataField:"CDATE_FORMAT",caption:this.t("grdSlsInv.clmCreateDate"),width:100,allowEditing:!1,headerFilter:{visible:!0}}),b.createElement(_.sg,{dataField:"CUSER_NAME",caption:this.t("grdSlsInv.clmCuser"),width:100,allowEditing:!1}),b.createElement(_.sg,{dataField:"ITEM_CODE",caption:this.t("grdSlsInv.clmItemCode"),width:80,editCellRender:this._cellRoleRender,headerFilter:{visible:!0}}),b.createElement(_.sg,{dataField:"ITEM_NAME",caption:this.t("grdSlsInv.clmItemName"),width:300,headerFilter:{visible:!0}}),b.createElement(_.sg,{dataField:"PRICE",caption:this.t("grdSlsInv.clmPrice"),dataType:"number",width:80,format:{style:"currency",currency:"EUR",precision:3},headerFilter:{visible:!0}}),b.createElement(_.sg,{dataField:"QUANTITY",caption:this.t("grdSlsInv.clmQuantity"),dataType:"number",width:80,headerFilter:{visible:!0}}),b.createElement(_.sg,{dataField:"AMOUNT",caption:this.t("grdSlsInv.clmAmount"),width:80,format:{style:"currency",currency:"EUR",precision:3},allowEditing:!1,headerFilter:{visible:!0}}),b.createElement(_.sg,{dataField:"DISCOUNT",caption:this.t("grdSlsInv.clmDiscount"),dataType:"number",width:90,format:{style:"currency",currency:"EUR",precision:3},headerFilter:{visible:!0}}),b.createElement(_.sg,{dataField:"DISCOUNT_RATE",caption:this.t("grdSlsInv.clmDiscountRate"),width:100,dataType:"number",headerFilter:{visible:!0}}),b.createElement(_.sg,{dataField:"MARGIN",caption:this.t("grdSlsInv.clmMargin"),width:100,allowEditing:!1,headerFilter:{visible:!0}}),b.createElement(_.sg,{dataField:"VAT",caption:this.t("grdSlsInv.clmVat"),width:80,format:{style:"currency",currency:"EUR",precision:3},allowEditing:!1,headerFilter:{visible:!0}}),b.createElement(_.sg,{dataField:"TOTAL",caption:this.t("grdSlsInv.clmTotal"),width:150,format:{style:"currency",currency:"EUR",precision:3},allowEditing:!1,headerFilter:{visible:!0}}),b.createElement(_.sg,{dataField:"DESCRIPTION",caption:this.t("grdSlsInv.clmDescription"),width:120,headerFilter:{visible:!0}}),b.createElement(_.sg,{dataField:"CONNECT_REF",caption:this.t("grdSlsInv.clmDispatch"),width:100,allowEditing:!1,headerFilter:{visible:!0}})),b.createElement(w(),{dataSource:this.rightItems,width:200,target:"#grdSlsInv",onItemClick:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.itemData.text!=n.t("getDispatch")){t.next=4;break}n._getDispatch(),t.next=8;break;case 4:if(e.itemData.text!=n.t("getPayment")){t.next=8;break}return t.next=7,n._getPayment();case 7:n.popPayment.show();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}().bind(this)})))))),b.createElement("div",{className:"row px-2 pt-2"},b.createElement("div",{className:"col-12"},b.createElement(v(),{colCount:4,parent:this,id:"frmSalesInv"},b.createElement(x.EmptyItem,{colSpan:3}),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("txtAmount"),alignment:"right"}),b.createElement(y.ZP,{id:"txtAmount",parent:this,simple:!0,readOnly:!0,dt:{data:this.docObj.dt("DOC"),field:"AMOUNT"},maxLength:32})),b.createElement(x.EmptyItem,{colSpan:3}),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("txtDiscount"),alignment:"right"}),b.createElement(y.ZP,{id:"txtDiscount",parent:this,simple:!0,readOnly:!0,dt:{data:this.docObj.dt("DOC"),field:"DISCOUNT"},maxLength:32,button:[{id:"01",icon:"more",onClick:function(){n.docObj.dt()[0].DISCOUNT>0&&(n.txtDiscountPercent.value=parseFloat((100-(n.docObj.dt()[0].AMOUNT-n.docObj.dt()[0].DISCOUNT)/n.docObj.dt()[0].AMOUNT*100).toFixed(3)),n.txtDiscountPrice.value=n.docObj.dt()[0].DISCOUNT),n.popDiscount.show()}}]})),b.createElement(x.EmptyItem,{colSpan:3}),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("txtMargin"),alignment:"right"}),b.createElement(y.ZP,{id:"txtMargin",parent:this,simple:!0,readOnly:!0,dt:{data:this.docObj.dt("DOC"),field:"MARGIN"},maxLength:32})),b.createElement(x.EmptyItem,{colSpan:3}),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("txtVat"),alignment:"right"}),b.createElement(y.ZP,{id:"txtVat",parent:this,simple:!0,readOnly:!0,dt:{data:this.docObj.dt("DOC"),field:"VAT"},maxLength:32,button:[{id:"01",icon:"clear",onClick:(t=(0,r.Z)(h().mark((function t(){var e,a;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={id:"msgVatDelete",showTitle:!0,title:n.t("msgVatDelete.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgVatDelete.btn01"),location:"before"},{id:"btn02",caption:n.t("msgSave.btn02"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgVatDelete.msg"))},t.next=3,(0,L.W)(e);case 3:if("btn01"==t.sent)for(a=0;a<n.docObj.docItems.dt().length;a++)n.docObj.docItems.dt()[a].VAT=0,n.docObj.docItems.dt()[a].VAT_RATE=0,n.docObj.docItems.dt()[a].TOTAL=n.docObj.docItems.dt()[a].PRICE*n.docObj.docItems.dt()[a].QUANTITY-n.docObj.docItems.dt()[a].DISCOUNT,n._calculateTotal();case 5:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})}]})),b.createElement(x.EmptyItem,{colSpan:3}),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("txtTotal"),alignment:"right"}),b.createElement(y.ZP,{id:"txtTotal",parent:this,simple:!0,readOnly:!0,dt:{data:this.docObj.dt("DOC"),field:"TOTAL"},maxLength:32})),b.createElement(x.EmptyItem,{colSpan:3}),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("txtPayTotal"),alignment:"right"}),b.createElement(y.ZP,{id:"txtPayTotal",parent:this,simple:!0,readOnly:!0,dt:{data:this.paymentObj.dt("DOC"),field:"TOTAL"},maxLength:32})),b.createElement(x.EmptyItem,{colSpan:3}),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("txtRemainder"),alignment:"right"}),b.createElement(y.ZP,{id:"txtMainRemainder",parent:this,simple:!0,readOnly:!0,maxLength:32}))))),b.createElement("div",null,b.createElement(A.ZP,{parent:this,id:"popDiscount",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popDiscount.title"),container:"#root",width:"500",height:"250",position:{of:"#root"}},b.createElement(v(),{colCount:1,height:"fit-content"},b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("popDiscount.Percent"),alignment:"right"}),b.createElement(P.ZP,{id:"txtDiscountPercent",parent:this,simple:!0,maxLength:32,onValueChanged:(0,r.Z)(h().mark((function t(){var e;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n.txtDiscountPercent.value>100)){t.next=7;break}return e={id:"msgDiscountPercent",showTitle:!0,title:n.t("msgDiscountPercent.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgDiscountPercent.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgDiscountPercent.msg"))},t.next=4,(0,L.W)(e);case 4:return n.txtDiscountPercent.value=0,n.txtDiscountPrice.value=0,t.abrupt("return");case 7:n.txtDiscountPrice.value=parseFloat((n.docObj.dt()[0].AMOUNT*n.txtDiscountPercent.value/100).toFixed(3));case 8:case"end":return t.stop()}}),t)}))).bind(this)})),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("popDiscount.Price"),alignment:"right"}),b.createElement(P.ZP,{id:"txtDiscountPrice",parent:this,simple:!0,maxLength:32,onValueChanged:(0,r.Z)(h().mark((function t(){var e;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n.txtDiscountPrice.value>n.docObj.dt()[0].AMOUNT)){t.next=7;break}return e={id:"msgDiscountPrice",showTitle:!0,title:n.t("msgDiscountPrice.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgDiscountPrice.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgDiscountPrice.msg"))},t.next=4,(0,L.W)(e);case 4:return n.txtDiscountPercent.value=0,n.txtDiscountPrice.value=0,t.abrupt("return");case 7:n.txtDiscountPercent.value=parseFloat((100-(n.docObj.dt()[0].AMOUNT-n.txtDiscountPrice.value)/n.docObj.dt()[0].AMOUNT*100).toFixed(3));case 8:case"end":return t.stop()}}),t)}))).bind(this)})),b.createElement(x.Item,null,b.createElement("div",{className:"row"},b.createElement("div",{className:"col-6"},b.createElement(j.Z,{text:this.lang.t("btnSave"),type:"normal",stylingMode:"contained",width:"100%",onClick:(0,r.Z)(h().mark((function t(){var e;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=0;e<n.docObj.docItems.dt().length;e++)n.docObj.docItems.dt()[e].DISCOUNT_RATE=n.txtDiscountPercent.value,n.docObj.docItems.dt()[e].DISCOUNT=parseFloat((n.docObj.docItems.dt()[e].PRICE*n.docObj.docItems.dt()[e].QUANTITY*n.txtDiscountPercent.value/100).toFixed(3)),n.docObj.docItems.dt()[e].VAT>0&&(n.docObj.docItems.dt()[e].VAT=parseFloat((n.docObj.docItems.dt()[e].PRICE*n.docObj.docItems.dt()[e].QUANTITY*(n.docObj.docItems.dt()[e].VAT_RATE/100)).toFixed(3))),n.docObj.docItems.dt()[e].TOTAL=parseFloat((n.docObj.docItems.dt()[e].PRICE*n.docObj.docItems.dt()[e].QUANTITY+n.docObj.docItems.dt()[e].VAT-n.docObj.docItems.dt()[e].DISCOUNT).toFixed(3));n._calculateMargin(),n._calculateTotal(),n._calculateTotalMargin(),n.popDiscount.hide();case 5:case"end":return t.stop()}}),t)})))})),b.createElement("div",{className:"col-6"},b.createElement(j.Z,{text:this.lang.t("btnCancel"),type:"normal",stylingMode:"contained",width:"100%",onClick:function(){n.popDiscount.hide()}}))))))),b.createElement("div",null,b.createElement(A.ZP,{parent:this,id:"popPassword",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popPassword.title"),container:"#root",width:"500",height:"200",position:{of:"#root"}},b.createElement(v(),{colCount:1,height:"fit-content"},b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("popPassword.Password"),alignment:"right"}),b.createElement(y.ZP,{id:"txtPassword",parent:this,simple:!0,maxLength:32})),b.createElement(x.Item,null,b.createElement("div",{className:"row"},b.createElement("div",{className:"col-6"},b.createElement(j.Z,{text:this.t("popPassword.btnApprove"),type:"normal",stylingMode:"contained",width:"100%",onClick:(0,r.Z)(h().mark((function t(){var e,a;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("1234"!=n.txtPassword.value){t.next=10;break}return n.docObj.dt()[0].LOCKED=0,n.frmSalesInv.option("disabled",!1),n.docLocked=!1,e={id:"msgPasswordSucces",showTitle:!0,title:n.t("msgPasswordSucces.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgPasswordSucces.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgPasswordSucces.msg"))},t.next=7,(0,L.W)(e);case 7:n.popPassword.hide(),t.next=13;break;case 10:return a={id:"msgPasswordWrong",showTitle:!0,title:n.t("msgPasswordWrong.title"),showCloseButton:!0,width:"500px",height:"200px",button:[{id:"btn01",caption:n.t("msgPasswordWrong.btn01"),location:"after"}],content:b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},n.t("msgPasswordWrong.msg"))},t.next=13,(0,L.W)(a);case 13:case"end":return t.stop()}}),t)})))})),b.createElement("div",{className:"col-6"},b.createElement(j.Z,{text:this.lang.t("btnCancel"),type:"normal",stylingMode:"contained",width:"100%",onClick:function(){n.popPassword.hide()}}))))))),b.createElement(U.Z,{id:"pg_dispatchGrid",parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,width:"90%",height:"90%",selection:{mode:"multiple"},title:this.t("pg_dispatchGrid.title")},b.createElement(_.sg,{dataField:"REFERANS",caption:this.t("pg_dispatchGrid.clmReferans"),width:200,defaultSortOrder:"asc"}),b.createElement(_.sg,{dataField:"ITEM_CODE",caption:this.t("pg_dispatchGrid.clmCode"),width:200}),b.createElement(_.sg,{dataField:"ITEM_NAME",caption:this.t("pg_dispatchGrid.clmName"),width:300}),b.createElement(_.sg,{dataField:"QUANTITY",caption:this.t("pg_dispatchGrid.clmQuantity"),width:300}),b.createElement(_.sg,{dataField:"PRICE",caption:this.t("pg_dispatchGrid.clmPrice"),width:300}),b.createElement(_.sg,{dataField:"TOTAL",caption:this.t("pg_dispatchGrid.clmTotal"),width:300})),b.createElement(U.Z,{id:"pg_txtItemsCode",parent:this,container:"#root",visible:!1,position:{of:"#root"},showTitle:!0,showBorders:!0,width:"90%",height:"90%",title:this.t("pg_txtItemsCode.title"),search:!0,data:{source:{select:{query:"SELECT GUID,CODE,NAME,VAT FROM ITEMS_VW_01 WHERE UPPER(CODE) LIKE UPPER(@VAL) OR UPPER(NAME) LIKE UPPER(@VAL)",param:["VAL:string|50"]},sql:this.core.sql}}},b.createElement(_.sg,{dataField:"CODE",caption:this.t("pg_txtItemsCode.clmCode"),width:150}),b.createElement(_.sg,{dataField:"NAME",caption:this.t("pg_txtItemsCode.clmName"),width:300,defaultSortOrder:"asc"})),b.createElement("div",null,b.createElement(A.ZP,{parent:this,id:"popPayment",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popPayment.title"),container:"#root",width:"800",height:"800",position:{of:"#root"}},b.createElement(v(),{colCount:3,height:"fit-content"},b.createElement(x.Item,{location:"after"},b.createElement(N.Button,{icon:"add",text:this.t("btnCash"),validationGroup:"frmPurcInv"+this.tabIndex,onClick:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.popPayment.hide(),n.numCash.setState({value:0}),n.cashDescription.setState({value:""}),n.popCash.show();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),b.createElement(x.Item,{location:"after"},b.createElement(N.Button,{icon:"add",text:this.t("btnCheck"),validationGroup:"frmPurcInv"+this.tabIndex,onClick:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.popPayment.hide(),n.checkReference.setState({value:""}),n.numcheck.setState({value:0}),n.checkDescription.setState({value:""}),n.popCheck.show();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),b.createElement(x.Item,{location:"after"},b.createElement(N.Button,{icon:"add",text:this.t("btnBank"),width:200,validationGroup:"frmPurcInv"+this.tabIndex,onClick:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.popPayment.hide(),n.numBank.setState({value:0}),n.bankDescription.setState({value:""}),n.popBank.show();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}))),b.createElement(_.ZP,{parent:this,id:"grdInvoicePayment",showBorders:!0,columnsAutoWidth:!0,allowColumnReordering:!0,allowColumnResizing:!0,headerFilter:{visible:!0},height:"75%",width:"100%",dbApply:!1,onRowRemoved:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.popPayment.hide(),n.paymentObj.dt()[0].AMOUNT=n.paymentObj.docCustomer.dt().sum("AMOUNT",2),n.paymentObj.dt()[0].TOTAL=n.paymentObj.docCustomer.dt().sum("AMOUNT",2),n.paymentObj.save(),t.next=6,n._getPayment();case 6:n.popPayment.show();case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},b.createElement(_.m_,{editOnKeyPress:!0,enterKeyAction:"moveFocus",enterKeyDirection:"column"}),b.createElement(_.PY,{mode:"virtual"}),b.createElement(_.LO,{mode:"cell",allowUpdating:!1,allowDeleting:!0}),b.createElement(_.sg,{dataField:"CDATE_FORMAT",caption:this.t("grdInvoicePayment.clmCreateDate"),width:150,allowEditing:!1,headerFilter:{visible:!0}}),b.createElement(_.sg,{dataField:"AMOUNT",caption:this.t("grdInvoicePayment.clmPrice"),width:150,headerFilter:{visible:!0}}),b.createElement(_.sg,{dataField:"INPUT_NAME",caption:this.t("grdInvoicePayment.clmInputName"),width:150,headerFilter:{visible:!0}}),b.createElement(_.sg,{dataField:"PAY_TYPE_NAME",caption:this.t("grdInvoicePayment.clmTypeName"),width:150,headerFilter:{visible:!0}})),b.createElement("div",{className:"row px-2 pt-2"},b.createElement("div",{className:"col-12"},b.createElement(v(),{colCount:2,parent:this,id:"frmSalesInv"},b.createElement(x.EmptyItem,null),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("txtPayInvoıceTotal"),alignment:"right"}),b.createElement(y.ZP,{id:"txtPayInvoıceTotal",parent:this,simple:!0,readOnly:!0,dt:{data:this.docObj.dt("DOC"),field:"TOTAL"},maxLength:32})),b.createElement(x.EmptyItem,null),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("txtPayTotal"),alignment:"right"}),b.createElement(y.ZP,{id:"txtPayTotal",parent:this,simple:!0,readOnly:!0,dt:{data:this.paymentObj.dt("DOC"),field:"TOTAL"},maxLength:32})),b.createElement(x.EmptyItem,null),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("txtRemainder"),alignment:"right"}),b.createElement(y.ZP,{id:"txtRemainder",parent:this,simple:!0,readOnly:!0,maxLength:32}))))))),b.createElement("div",null,b.createElement(A.ZP,{parent:this,id:"popCash",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popCash.title"),container:"#root",width:"500",height:"300",position:{of:"#root"}},b.createElement(v(),{colCount:1,height:"fit-content"},b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("cmbCashSafe"),alignment:"right"}),b.createElement(S.ZP,{simple:!0,parent:this,id:"cmbCashSafe",displayExpr:"NAME",valueExpr:"GUID",value:"",searchEnabled:!0,onValueChanged:(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))).bind(this),data:{source:{select:{query:"SELECT * FROM SAFE_VW_01 WHERE TYPE = 0"},sql:this.core.sql}},param:this.param.filter({ELEMENT:"cmbCashSafe",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"cmbCashSafe",USERS:this.user.CODE})},b.createElement(y.cX,{validationGroup:"frmSlsInvCash"+this.tabIndex},b.createElement(y.n2,{message:this.t("ValidCash")})))),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("cash"),alignment:"right"}),b.createElement("div",{className:"col-4 pe-0"},b.createElement(P.ZP,{id:"numCash",parent:this,simple:!0,maxLength:32,param:this.param.filter({ELEMENT:"numCash",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"numCash",USERS:this.user.CODE})},b.createElement(y.cX,{validationGroup:"frmSlsInvCash"+this.tabIndex},b.createElement(y.n2,{message:this.t("ValidCash")}))))),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("description"),alignment:"right"}),b.createElement("div",{className:"col-12 pe-0"},b.createElement(y.ZP,{id:"cashDescription",parent:this,simple:!0,width:500,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,maxLength:32,param:this.param.filter({ELEMENT:"cashDescription",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"cashDescription",USERS:this.user.CODE})}))),b.createElement(x.Item,null,b.createElement("div",{className:"row"},b.createElement("div",{className:"col-6"},b.createElement(j.Z,{text:this.t("popCash.btnApprove"),type:"normal",stylingMode:"contained",width:"100%",validationGroup:"frmSlsInvCash"+this.tabIndex,onClick:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"valid"==e.validationGroup.validate().status&&(n._addPayment(0,n.numCash.value),n.popCash.hide());case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),b.createElement("div",{className:"col-6"},b.createElement(j.Z,{text:this.lang.t("btnCancel"),type:"normal",stylingMode:"contained",width:"100%",onClick:function(){n.popCash.hide()}}))))))),b.createElement("div",null,b.createElement(A.ZP,{parent:this,id:"popCheck",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popCheck.title"),container:"#root",width:"500",height:"300",position:{of:"#root"}},b.createElement(v(),{colCount:1,height:"fit-content"},b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("cmbCheckSafe"),alignment:"right"}),b.createElement(S.ZP,{simple:!0,parent:this,id:"cmbCheckSafe",displayExpr:"NAME",valueExpr:"GUID",value:"",searchEnabled:!0,onValueChanged:(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))).bind(this),data:{source:{select:{query:"SELECT * FROM SAFE_VW_01 WHERE TYPE = 1"},sql:this.core.sql}},param:this.param.filter({ELEMENT:"cmbCheckSafe",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"cmbCheckSafe",USERS:this.user.CODE})},b.createElement(y.cX,{validationGroup:"frmSlsInvCheck"+this.tabIndex},b.createElement(y.n2,{message:this.t("ValidCash")})))),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("checkReference"),alignment:"right"}),b.createElement("div",{className:"col-12 pe-0"},b.createElement(y.ZP,{id:"checkReference",parent:this,simple:!0,width:500,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,maxLength:32,param:this.param.filter({ELEMENT:"checkReference",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"checkReference",USERS:this.user.CODE})}))),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("cash"),alignment:"right"}),b.createElement("div",{className:"col-4 pe-0"},b.createElement(P.ZP,{id:"numcheck",parent:this,simple:!0,maxLength:32,param:this.param.filter({ELEMENT:"numcheck",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"numcheck",USERS:this.user.CODE})},b.createElement(y.cX,{validationGroup:"frmSlsInvCheck"+this.tabIndex},b.createElement(y.n2,{message:this.t("ValidCash")}))))),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("description"),alignment:"right"}),b.createElement("div",{className:"col-12 pe-0"},b.createElement(y.ZP,{id:"checkDescription",parent:this,simple:!0,width:500,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,maxLength:32,param:this.param.filter({ELEMENT:"checkDescription",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"checkDescription",USERS:this.user.CODE})}))),b.createElement(x.Item,null,b.createElement("div",{className:"row"},b.createElement("div",{className:"col-6"},b.createElement(j.Z,{text:this.t("popCheck.btnApprove"),type:"normal",stylingMode:"contained",width:"100%",validationGroup:"frmSlsInvCheck"+this.tabIndex,onClick:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"valid"==e.validationGroup.validate().status&&(n._addPayment(1,n.numcheck.value),n.popCheck.hide());case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),b.createElement("div",{className:"col-6"},b.createElement(j.Z,{text:this.lang.t("btnCancel"),type:"normal",stylingMode:"contained",width:"100%",onClick:function(){n.popCheck.hide()}}))))))),b.createElement("div",null,b.createElement(A.ZP,{parent:this,id:"popBank",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popBank.title"),container:"#root",width:"500",height:"300",position:{of:"#root"}},b.createElement(v(),{colCount:1,height:"fit-content"},b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("cmbBank"),alignment:"right"}),b.createElement(S.ZP,{simple:!0,parent:this,id:"cmbBank",displayExpr:"NAME",valueExpr:"GUID",value:"",searchEnabled:!0,onValueChanged:(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))).bind(this),data:{source:{select:{query:"SELECT * FROM BANK_VW_01 WHERE TYPE = 1"},sql:this.core.sql}},param:this.param.filter({ELEMENT:"cmbBank",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"cmbBank",USERS:this.user.CODE})},b.createElement(y.cX,{validationGroup:"frmslsInvBank"+this.tabIndex},b.createElement(y.n2,{message:this.t("validBank")})))),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("cash"),alignment:"right"}),b.createElement("div",{className:"col-4 pe-0"},b.createElement(P.ZP,{id:"numBank",parent:this,simple:!0,maxLength:32,param:this.param.filter({ELEMENT:"numBank",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"numBank",USERS:this.user.CODE})},b.createElement(y.cX,{validationGroup:"frmslsInvBank"+this.tabIndex},b.createElement(y.n2,{message:this.t("ValidCash")}))))),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("description"),alignment:"right"}),b.createElement("div",{className:"col-12 pe-0"},b.createElement(y.ZP,{id:"bankDescription",parent:this,simple:!0,width:500,upper:this.sysParam.filter({ID:"onlyBigChar",USERS:this.user.CODE}).getValue().value,maxLength:32,param:this.param.filter({ELEMENT:"bankDescription",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"bankDescription",USERS:this.user.CODE})}))),b.createElement(x.Item,null,b.createElement("div",{className:"row"},b.createElement("div",{className:"col-6"},b.createElement(j.Z,{text:this.t("popBank.btnApprove"),type:"normal",stylingMode:"contained",width:"100%",validationGroup:"frmslsInvBank"+this.tabIndex,onClick:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"valid"==e.validationGroup.validate().status&&(n._addPayment(2,n.numBank.value),n.popBank.hide());case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),b.createElement("div",{className:"col-6"},b.createElement(j.Z,{text:this.lang.t("btnCancel"),type:"normal",stylingMode:"contained",width:"100%",onClick:function(){n.popBank.hide()}}))))))),b.createElement("div",null,b.createElement(A.ZP,{parent:this,id:"popDesign",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popDesign.title"),container:"#root",width:"500",height:"250",position:{of:"#root"}},b.createElement(v(),{colCount:1,height:"fit-content"},b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("popDesign.design"),alignment:"right"}),b.createElement(S.ZP,{simple:!0,parent:this,id:"cmbDesignList",notRefresh:!0,displayExpr:"DESIGN_NAME",valueExpr:"TAG",value:"",searchEnabled:!0,onValueChanged:(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))).bind(this),data:{source:{select:{query:"SELECT TAG,DESIGN_NAME FROM [dbo].[LABEL_DESIGN] WHERE PAGE = '15'"},sql:this.core.sql}},param:this.param.filter({ELEMENT:"cmbDesignList",USERS:this.user.CODE}),access:this.access.filter({ELEMENT:"cmbDesignList",USERS:this.user.CODE})},b.createElement(y.cX,{validationGroup:"frmPurcOrderPrint"+this.tabIndex},b.createElement(y.n2,{message:this.t("validDesign")})))),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("popDesign.lang"),alignment:"right"}),b.createElement(S.ZP,{simple:!0,parent:this,id:"cmbDesignLang",notRefresh:!0,displayExpr:"VALUE",valueExpr:"ID",value:"",searchEnabled:!0,onValueChanged:(0,r.Z)(h().mark((function t(){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))).bind(this),data:{source:[{ID:"FR",VALUE:"FR"},{ID:"TR",VALUE:"TR"}]}})),b.createElement(x.Item,null,b.createElement("div",{className:"row"},b.createElement("div",{className:"col-6"},b.createElement(j.Z,{text:this.lang.t("btnPrint"),type:"normal",stylingMode:"contained",width:"100%",onClick:(0,r.Z)(h().mark((function t(){var e,a;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={query:"SELECT *,ISNULL((SELECT TOP 1 PATH FROM LABEL_DESIGN WHERE TAG = @DESIGN),'') AS PATH FROM  [dbo].[FN_DOC_ITEMS_FOR_PRINT](@DOC_GUID) ORDER BY LINE_NO ",param:["DOC_GUID:string|50","DESIGN:string|25"],value:[n.docObj.dt()[0].GUID,n.cmbDesignList.value]},t.next=3,n.core.sql.execute(e);case 3:a=t.sent,console.log(JSON.stringify(a.result.recordset)),n.core.socket.emit("devprint","{TYPE:'REVIEW',PATH:'"+a.result.recordset[0].PATH.replaceAll("\\","/")+"',DATA:"+JSON.stringify(a.result.recordset)+"}",(function(t){if("ERR"!=t.split("|")[0]){var e=window.open("printview.html","_blank","width=900,height=1000,left=500");e.onload=function(){e.document.getElementById("view").innerHTML="<iframe src='data:application/pdf;base64,"+t.split("|")[1]+"' type='application/pdf' width='100%' height='100%'></iframe>"}}})),n.popDesign.hide();case 7:case"end":return t.stop()}}),t)})))})),b.createElement("div",{className:"col-6"},b.createElement(j.Z,{text:this.lang.t("btnCancel"),type:"normal",stylingMode:"contained",width:"100%",onClick:function(){n.popDesign.hide()}}))))))),b.createElement("div",null,b.createElement(A.ZP,{parent:this,id:"popMultiItem",visible:!1,showCloseButton:!0,showTitle:!0,title:this.t("popMultiItem.title"),container:"#root",width:"900",height:"700",position:{of:"#root"}},b.createElement(v(),{colCount:2,height:"fit-content"},b.createElement(x.Item,{colSpan:2},b.createElement(x.Label,{alignment:"right"}),b.createElement(M.ZP,{id:"tagItemCode",parent:this,simple:!0,value:[],placeholder:this.t("tagItemCodePlaceholder")})),b.createElement(x.EmptyItem,null),b.createElement(x.Item,null,b.createElement(x.Label,{text:this.t("cmbMultiItemType.title"),alignment:"right"}),b.createElement(S.ZP,{simple:!0,parent:this,id:"cmbMultiItemType",height:"fit-content",displayExpr:"VALUE",valueExpr:"ID",value:0,data:{source:[{ID:0,VALUE:this.t("cmbMultiItemType.customerCode")},{ID:1,VALUE:this.t("cmbMultiItemType.ItemCode")}]}})),b.createElement(x.EmptyItem,null),b.createElement(x.Item,null,b.createElement("div",{className:"row"},b.createElement("div",{className:"col-6"},b.createElement(j.Z,{text:this.t("popMultiItem.btnApprove"),type:"normal",stylingMode:"contained",width:"100%",onClick:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.multiItemAdd();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})),b.createElement("div",{className:"col-6"},b.createElement(j.Z,{text:this.t("popMultiItem.btnClear"),type:"normal",stylingMode:"contained",width:"100%",onClick:function(){n.multiItemData.clear()}})))),b.createElement(x.Item,{colSpan:2},b.createElement(_.ZP,{parent:this,id:"grdMultiItem",showBorders:!0,columnsAutoWidth:!0,allowColumnReordering:!0,allowColumnResizing:!0,headerFilter:{visible:!0},filterRow:{visible:!0},height:400,width:"100%",dbApply:!1,onRowRemoved:function(){var t=(0,r.Z)(h().mark((function t(e){return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},b.createElement(_.m_,{editOnKeyPress:!0,enterKeyAction:"moveFocus",enterKeyDirection:"column"}),b.createElement(_.PY,{mode:"virtual"}),b.createElement(_.LO,{mode:"cell",allowUpdating:!0,allowDeleting:!0}),b.createElement(_.sg,{dataField:"CODE",caption:this.t("grdMultiItem.clmCode"),width:150,allowEditing:!1}),b.createElement(_.sg,{dataField:"MULTICODE",caption:this.t("grdMultiItem.clmMulticode"),width:150,allowEditing:!1}),b.createElement(_.sg,{dataField:"NAME",caption:this.t("grdMultiItem.clmName"),width:300,headerFilter:{visible:!0},allowEditing:!1}),b.createElement(_.sg,{dataField:"QUANTITY",caption:this.t("grdMultiItem.clmQuantity"),dataType:"number",width:100,headerFilter:{visible:!0}}))),b.createElement(x.EmptyItem,null),b.createElement(x.Item,null,b.createElement("div",{className:"row"},b.createElement("div",{className:"col-6"}),b.createElement("div",{className:"col-6"},b.createElement(j.Z,{text:this.t("popMultiItem.btnSave"),type:"normal",stylingMode:"contained",width:"100%",onClick:function(){n.multiItemSave()}}))))))),b.createElement(L.Z,{id:"msgCombineItem",container:"#root",parent:this,position:{of:"#root"},showTitle:!0,title:this.t("msgCombineItem.title"),showCloseButton:!1,width:"500px",height:"250px",button:[{id:"btn01",caption:this.t("msgCombineItem.btn01"),location:"before"},{id:"btn02",caption:this.t("msgCombineItem.btn02"),location:"after"}]},b.createElement("div",{className:"row"},b.createElement("div",{className:"col-12 py-2"},b.createElement("div",{style:{textAlign:"center",fontSize:"20px"}},this.t("msgCombineItem.msg"))),b.createElement("div",{className:"col-12 py-2"},b.createElement(v(),null,b.createElement(x.Item,null,b.createElement(x.Label,{text:this.lang.t("checkAll"),alignment:"right"}),b.createElement(R.ZP,{id:"checkCombine",parent:this,simple:!0,value:!1}))))),b.createElement("div",{className:"row"}))))}}]),K}(b.PureComponent)}}]);